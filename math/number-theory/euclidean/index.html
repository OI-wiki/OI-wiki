<!doctype html><html class=no-js lang=zh-Hans><meta charset=utf-8><meta content=on http-equiv=x-dns-prefetch-control><link href=//oi-wiki.org rel=dns-prefetch><link href=//search.oi-wiki.org rel=dns-prefetch><link href=//api.github.com rel=dns-prefetch><link href=//www.google-analytics.com rel=dns-prefetch><meta content="width=device-width,initial-scale=1" name=viewport><meta content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛" name=description><meta content="sshwy, FFjet, qz-cqy" name=author><link href=https://oi-wiki.org/math/number-theory/euclidean/ rel=canonical><link href=../zhou/ rel=prev><link href=../meissel-lehmer/ rel=next><link href=../../../favicon.ico rel=icon><meta content="mkdocs-1.5.3, mkdocs-material-9.6.15" name=generator><title>类欧几里德算法 - OI Wiki</title><link href=../../../assets/stylesheets/main.bd3167ff.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}@font-face{font-family:Fira Sans;font-style:normal;font-weight:300;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:italic;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot);src:local(Fira Sans),local(FiraSans-Italic),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:normal;font-weight:700;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans)format("svg")}@font-face{font-family:Fira Mono;font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot);src:local(Fira Mono),local(FiraMono-Normal),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono)format("svg")}</style><link href="../../../_static/css/extra.css?v=16" rel=stylesheet><link href="../../../assets/stylesheets/oiwiki-feedback-sys-frontend.css?v=202763fcae134a48bc639c9f3cde9d46" rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-124485594-1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-124485594-1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-124485594-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><script src=../../../assets/javascripts/toggle-sidebar.js></script><link href="../../../assets/stylesheets/mathjax.css?hash=3b97f50827c49ac9c18bf068907fb9c8f7c03fea7566ddb8026d26336f0ef684" rel=stylesheet></head><body data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#引入> 跳转至 </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=页眉><a aria-label="OI Wiki" class="md-header__button md-logo" title="OI Wiki" data-md-component=logo href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"></path></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OI Wiki </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> 类欧几里德算法 </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" data-md-color-media="(prefers-color-scheme: light)" class=md-option data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg></label><input aria-label="Switch to light mode" data-md-color-media="(prefers-color-scheme: dark)" class=md-option data-md-color-accent=blue data-md-color-primary=blue data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=搜索 autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=搜索 required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg></label><nav aria-label=查找 class=md-search__options><button class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1 title=清空当前内容 type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>正在初始化搜索引擎</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a class=md-source data-md-component=source href=https://github.com/OI-wiki/OI-wiki target=_blank title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg></div> <div class=md-source__repository>OI-wiki/OI-wiki</div> </a></div></nav></header><div class=md-container data-md-component=container><nav aria-label=标签 class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../../..> 简介 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../contest/> 比赛相关 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../tools/> 工具软件 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../lang/> 语言基础 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../basic/> 算法基础 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../search/> 搜索 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../dp/> 动态规划 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../string/> 字符串 </a></li><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../../> 数学 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../ds/> 数据结构 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../graph/> 图论 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../geometry/> 计算几何 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../misc/> 杂项 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../topic/rmq/> 专题 </a></li></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OI Wiki" class="md-nav__button md-logo" title="OI Wiki" data-md-component=logo href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"></path></svg> </a> OI Wiki</label><div class=md-nav__source><a class=md-source data-md-component=source href=https://github.com/OI-wiki/OI-wiki target=_blank title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg></div> <div class=md-source__repository>OI-wiki/OI-wiki</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_1 type=checkbox> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0><span class=md-ellipsis> 简介 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_1_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_1><span class="md-nav__icon md-icon"></span> 简介</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../..> <span class=md-ellipsis> Getting Started </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/about/> <span class=md-ellipsis> 关于本项目 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/htc/> <span class=md-ellipsis> 如何参与 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/what-oi-wiki-is-not/> <span class=md-ellipsis> OI Wiki 不是什么 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/format/> <span class=md-ellipsis> 格式手册 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/symbol/> <span class=md-ellipsis> 数学符号表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/faq/> <span class=md-ellipsis> F.A.Q. </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/mirrors/> <span class=md-ellipsis> 镜像站列表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/thanks/> <span class=md-ellipsis> 致谢 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0><span class=md-ellipsis> 比赛相关 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_2><span class="md-nav__icon md-icon"></span> 比赛相关</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/> <span class=md-ellipsis> 比赛相关简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_2 type=checkbox> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0><span class=md-ellipsis> 赛事 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_2><span class="md-nav__icon md-icon"></span> 赛事</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/oi/> <span class=md-ellipsis> OI 赛事与赛制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/icpc/> <span class=md-ellipsis> ICPC/CCPC 赛事与赛制 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_3 type=checkbox> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0><span class=md-ellipsis> 题型 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_3><span class="md-nav__icon md-icon"></span> 题型</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/problems/> <span class=md-ellipsis> 题型概述 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/interaction/> <span class=md-ellipsis> 交互题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/roadmap/> <span class=md-ellipsis> 学习路线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/resources/> <span class=md-ellipsis> 学习资源 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_6 type=checkbox> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0><span class=md-ellipsis> 技巧 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_6><span class="md-nav__icon md-icon"></span> 技巧</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/io/> <span class=md-ellipsis> 读入、输出优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/dictionary/> <span class=md-ellipsis> 分段打表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/common-mistakes/> <span class=md-ellipsis> 常见错误 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/common-tricks/> <span class=md-ellipsis> 常见技巧 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/problemsetting/> <span class=md-ellipsis> 出题 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0><span class=md-ellipsis> 工具软件 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> 工具软件</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/> <span class=md-ellipsis> 工具软件简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_2 type=checkbox> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0><span class=md-ellipsis> 代码编辑工具 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_2><span class="md-nav__icon md-icon"></span> 代码编辑工具</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/vim/> <span class=md-ellipsis> Vim </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/emacs/> <span class=md-ellipsis> Emacs </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/vscode/> <span class=md-ellipsis> VS Code </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/atom/> <span class=md-ellipsis> Atom </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/eclipse/> <span class=md-ellipsis> Eclipse </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/npp/> <span class=md-ellipsis> Notepad++ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/kate/> <span class=md-ellipsis> Kate </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/devcpp/> <span class=md-ellipsis> Dev-C++ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/clion/> <span class=md-ellipsis> CLion </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/geany/> <span class=md-ellipsis> Geany </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/xcode/> <span class=md-ellipsis> Xcode </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/guide/> <span class=md-ellipsis> GUIDE </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/sublime/> <span class=md-ellipsis> Sublime Text </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/cpeditor/> <span class=md-ellipsis> CP Editor </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/codeblocks/> <span class=md-ellipsis> Code::Blocks </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_3 type=checkbox> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0><span class=md-ellipsis> 评测工具 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_3><span class="md-nav__icon md-icon"></span> 评测工具</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/> <span class=md-ellipsis> 评测工具简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/arbiter/> <span class=md-ellipsis> Arbiter </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/cena/> <span class=md-ellipsis> Cena </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/ccr-plus/> <span class=md-ellipsis> CCR Plus </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/lemon/> <span class=md-ellipsis> Lemon </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/cmd/> <span class=md-ellipsis> 命令行 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/compile-debug/> <span class=md-ellipsis> 命令行编译与调试 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/compiler/> <span class=md-ellipsis> 编译器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/wsl/> <span class=md-ellipsis> WSL (Windows 10) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/special-judge/> <span class=md-ellipsis> Special Judge </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_9 type=checkbox> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex=0><span class=md-ellipsis> Testlib </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_9_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_9><span class="md-nav__icon md-icon"></span> Testlib</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/> <span class=md-ellipsis> Testlib 简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/general/> <span class=md-ellipsis> 通用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/generator/> <span class=md-ellipsis> Generator </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/validator/> <span class=md-ellipsis> Validator </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/interactor/> <span class=md-ellipsis> Interactor </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/checker/> <span class=md-ellipsis> Checker </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/polygon/> <span class=md-ellipsis> Polygon </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/oj-tool/> <span class=md-ellipsis> OJ 工具 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/latex/> <span class=md-ellipsis> LaTeX 入门 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/git/> <span class=md-ellipsis> Git </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0><span class=md-ellipsis> 语言基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_4><span class="md-nav__icon md-icon"></span> 语言基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/> <span class=md-ellipsis> 语言基础简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2 type=checkbox> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0><span class=md-ellipsis> C++ 基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_2><span class="md-nav__icon md-icon"></span> C++ 基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/helloworld/> <span class=md-ellipsis> Hello, World! </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/basic/> <span class=md-ellipsis> C++ 语法基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/var/> <span class=md-ellipsis> 变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/op/> <span class=md-ellipsis> 运算 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2_5 type=checkbox> <label class=md-nav__link for=__nav_4_2_5 id=__nav_4_2_5_label tabindex=0><span class=md-ellipsis> 流程控制语句 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_5_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_2_5><span class="md-nav__icon md-icon"></span> 流程控制语句</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/branch/> <span class=md-ellipsis> 分支 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/loop/> <span class=md-ellipsis> 循环 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2_6 type=checkbox> <label class=md-nav__link for=__nav_4_2_6 id=__nav_4_2_6_label tabindex=0><span class=md-ellipsis> 高级数据类型 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_6_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_2_6><span class="md-nav__icon md-icon"></span> 高级数据类型</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/array/> <span class=md-ellipsis> 数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/struct/> <span class=md-ellipsis> 结构体 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/union/> <span class=md-ellipsis> 联合体 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pointer/> <span class=md-ellipsis> 指针 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/func/> <span class=md-ellipsis> 函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/file-op/> <span class=md-ellipsis> 文件操作 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_3 type=checkbox> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0><span class=md-ellipsis> C++ 标准库 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_3><span class="md-nav__icon md-icon"></span> C++ 标准库</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/> <span class=md-ellipsis> C++ 标准库简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_3_2 type=checkbox> <label class=md-nav__link for=__nav_4_3_2 id=__nav_4_3_2_label tabindex=0><span class=md-ellipsis> STL 容器 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_3_2_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_3_2><span class="md-nav__icon md-icon"></span> STL 容器</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/container/> <span class=md-ellipsis> STL 容器简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/iterator/> <span class=md-ellipsis> 迭代器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/sequence-container/> <span class=md-ellipsis> 序列式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/associative-container/> <span class=md-ellipsis> 关联式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/unordered-container/> <span class=md-ellipsis> 无序关联式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/container-adapter/> <span class=md-ellipsis> 容器适配器 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/algorithm/> <span class=md-ellipsis> STL 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/bitset/> <span class=md-ellipsis> bitset </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/string/> <span class=md-ellipsis> string </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/pair/> <span class=md-ellipsis> pair </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_4 type=checkbox> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0><span class=md-ellipsis> C++ 进阶 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_4_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_4><span class="md-nav__icon md-icon"></span> C++ 进阶</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/class/> <span class=md-ellipsis> 类 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/namespace/> <span class=md-ellipsis> 命名空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/value-category/> <span class=md-ellipsis> 值类别 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/op-overload/> <span class=md-ellipsis> 重载运算符 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/reference/> <span class=md-ellipsis> 引用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/const/> <span class=md-ellipsis> 常量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/new/> <span class=md-ellipsis> 新版 C++ 特性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/lambda/> <span class=md-ellipsis> Lambda 表达式 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_4_9 type=checkbox> <label class=md-nav__link for=__nav_4_4_9 id=__nav_4_4_9_label tabindex=0><span class=md-ellipsis> pb_ds </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_4_9_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_4_9><span class="md-nav__icon md-icon"></span> pb_ds</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/> <span class=md-ellipsis> pb_ds 简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/pq/> <span class=md-ellipsis> 堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/tree/> <span class=md-ellipsis> 平衡树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/optimizations/> <span class=md-ellipsis> 编译优化 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/cpp-other-langs/> <span class=md-ellipsis> C++ 与其他常用语言的区别 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pas-cpp/> <span class=md-ellipsis> Pascal 转 C++ 急救 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/python/> <span class=md-ellipsis> Python 速成 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/java/> <span class=md-ellipsis> Java 速成 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/java-pro/> <span class=md-ellipsis> Java 进阶 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5 type=checkbox> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0><span class=md-ellipsis> 算法基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> 算法基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/> <span class=md-ellipsis> 算法基础简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5_2 type=checkbox> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0><span class=md-ellipsis> 复杂度 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_5_2><span class="md-nav__icon md-icon"></span> 复杂度</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/complexity/> <span class=md-ellipsis> 复杂度简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/amortized-analysis/> <span class=md-ellipsis> 均摊复杂度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/enumerate/> <span class=md-ellipsis> 枚举 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/simulate/> <span class=md-ellipsis> 模拟 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/divide-and-conquer/> <span class=md-ellipsis> 递归 & 分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/greedy/> <span class=md-ellipsis> 贪心 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5_7 type=checkbox> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0><span class=md-ellipsis> 排序 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_7_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_5_7><span class="md-nav__icon md-icon"></span> 排序</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/sort-intro/> <span class=md-ellipsis> 排序简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/selection-sort/> <span class=md-ellipsis> 选择排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/bubble-sort/> <span class=md-ellipsis> 冒泡排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/insertion-sort/> <span class=md-ellipsis> 插入排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/counting-sort/> <span class=md-ellipsis> 计数排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/radix-sort/> <span class=md-ellipsis> 基数排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/quick-sort/> <span class=md-ellipsis> 快速排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/merge-sort/> <span class=md-ellipsis> 归并排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/heap-sort/> <span class=md-ellipsis> 堆排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/bucket-sort/> <span class=md-ellipsis> 桶排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/shell-sort/> <span class=md-ellipsis> 希尔排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/tournament-sort/> <span class=md-ellipsis> 锦标赛排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/tim-sort/> <span class=md-ellipsis> Tim 排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/stl-sort/> <span class=md-ellipsis> 排序相关 STL </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/use-of-sort/> <span class=md-ellipsis> 排序应用 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/prefix-sum/> <span class=md-ellipsis> 前缀和 & 差分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/binary/> <span class=md-ellipsis> 二分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/binary-lifting/> <span class=md-ellipsis> 倍增 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/construction/> <span class=md-ellipsis> 构造 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_6 type=checkbox> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0><span class=md-ellipsis> 搜索 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> 搜索</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../search/> <span class=md-ellipsis> 搜索部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/dfs/> <span class=md-ellipsis> DFS（搜索） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/bfs/> <span class=md-ellipsis> BFS（搜索） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/bidirectional/> <span class=md-ellipsis> 双向搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/heuristic/> <span class=md-ellipsis> 启发式搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/astar/> <span class=md-ellipsis> A* </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/iterative/> <span class=md-ellipsis> 迭代加深搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/idastar/> <span class=md-ellipsis> IDA* </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/backtracking/> <span class=md-ellipsis> 回溯法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/dlx/> <span class=md-ellipsis> Dancing Links </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/alpha-beta/> <span class=md-ellipsis> Alpha–Beta 剪枝 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/opt/> <span class=md-ellipsis> 优化 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_7 type=checkbox> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0><span class=md-ellipsis> 动态规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_7_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_7><span class="md-nav__icon md-icon"></span> 动态规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../dp/> <span class=md-ellipsis> 动态规划部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/basic/> <span class=md-ellipsis> 动态规划基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/memo/> <span class=md-ellipsis> 记忆化搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/knapsack/> <span class=md-ellipsis> 背包 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/interval/> <span class=md-ellipsis> 区间 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/dag/> <span class=md-ellipsis> DAG 上的 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/tree/> <span class=md-ellipsis> 树形 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/state/> <span class=md-ellipsis> 状压 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/number/> <span class=md-ellipsis> 数位 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/plug/> <span class=md-ellipsis> 插头 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/count/> <span class=md-ellipsis> 计数 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/dynamic/> <span class=md-ellipsis> 动态 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/probability/> <span class=md-ellipsis> 概率 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/dp-of-dp/> <span class=md-ellipsis> DP 套 DP </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_7_15 type=checkbox> <label class=md-nav__link for=__nav_7_15 id=__nav_7_15_label tabindex=0><span class=md-ellipsis> DP 优化 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_7_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_7_15><span class="md-nav__icon md-icon"></span> DP 优化</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/dp-opt/> <span class=md-ellipsis> DP 优化简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/monotonous-queue-stack/> <span class=md-ellipsis> 单调队列/单调栈优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/slope/> <span class=md-ellipsis> 斜率优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/quadrangle/> <span class=md-ellipsis> 四边形不等式优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/slope-trick/> <span class=md-ellipsis> Slope Trick 优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/wqs-binary-search/> <span class=md-ellipsis> WQS 二分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/state/> <span class=md-ellipsis> 状态设计优化 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/misc/> <span class=md-ellipsis> 其它 DP 方法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_8 type=checkbox> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0><span class=md-ellipsis> 字符串 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_8_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_8><span class="md-nav__icon md-icon"></span> 字符串</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../string/> <span class=md-ellipsis> 字符串部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/basic/> <span class=md-ellipsis> 字符串基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/lib-func/> <span class=md-ellipsis> 标准库 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/match/> <span class=md-ellipsis> 字符串匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/hash/> <span class=md-ellipsis> 字符串哈希 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/trie/> <span class=md-ellipsis> 字典树 (Trie) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/kmp/> <span class=md-ellipsis> 前缀函数与 KMP 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/bm/> <span class=md-ellipsis> Boyer–Moore 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/z-func/> <span class=md-ellipsis> Z 函数（扩展 KMP） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/ac-automaton/> <span class=md-ellipsis> AC 自动机 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_8_11 type=checkbox> <label class=md-nav__link for=__nav_8_11 id=__nav_8_11_label tabindex=0><span class=md-ellipsis> 后缀数组 (SA) </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_8_11_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_8_11><span class="md-nav__icon md-icon"></span> 后缀数组 (SA)</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../string/sa/> <span class=md-ellipsis> 后缀数组简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/sa-optimal-inplace/> <span class=md-ellipsis> 最优原地后缀排序算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../string/sam/> <span class=md-ellipsis> 后缀自动机 (SAM) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/suffix-bst/> <span class=md-ellipsis> 后缀平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/general-sam/> <span class=md-ellipsis> 广义后缀自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/suffix-tree/> <span class=md-ellipsis> 后缀树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/manacher/> <span class=md-ellipsis> Manacher </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/pam/> <span class=md-ellipsis> 回文树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/seq-automaton/> <span class=md-ellipsis> 序列自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/minimal-string/> <span class=md-ellipsis> 最小表示法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/lyndon/> <span class=md-ellipsis> Lyndon 分解 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/main-lorentz/> <span class=md-ellipsis> Main–Lorentz 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_9 type=checkbox> <label class=md-nav__link for=__nav_9 id=__nav_9_label><span class=md-ellipsis> 数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_9_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_9><span class="md-nav__icon md-icon"></span> 数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../> <span class=md-ellipsis> 数学部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../boolean-algebra/> <span class=md-ellipsis> 布尔代数 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_3 type=checkbox> <label class=md-nav__link for=__nav_9_3 id=__nav_9_3_label tabindex=0><span class=md-ellipsis> 数字系统 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_3><span class="md-nav__icon md-icon"></span> 数字系统</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/intro/> <span class=md-ellipsis> 数字系统简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/base/> <span class=md-ellipsis> 进位制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/balanced-ternary/> <span class=md-ellipsis> 平衡三进制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/gray-code/> <span class=md-ellipsis> 格雷码 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../bit/> <span class=md-ellipsis> 位操作 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../binary-set/> <span class=md-ellipsis> 二进制集合操作 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../bignum/> <span class=md-ellipsis> 高精度计算 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../binary-exponentiation/> <span class=md-ellipsis> 快速幂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../permutation/> <span class=md-ellipsis> 置换和排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../coordinate/> <span class=md-ellipsis> 弧度制与坐标系 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../complex/> <span class=md-ellipsis> 复数 </span> </a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_9_11 type=checkbox> <label class=md-nav__link for=__nav_9_11 id=__nav_9_11_label tabindex=0><span class=md-ellipsis> 数论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_9_11_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_11><span class="md-nav__icon md-icon"></span> 数论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../basic/> <span class=md-ellipsis> 数论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../mod-arithmetic/> <span class=md-ellipsis> 模算术简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../prime/> <span class=md-ellipsis> 素数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../gcd/> <span class=md-ellipsis> 最大公约数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../euler-totient/> <span class=md-ellipsis> 欧拉函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../sieve/> <span class=md-ellipsis> 筛法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../pollard-rho/> <span class=md-ellipsis> 分解质因数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../bezouts/> <span class=md-ellipsis> 裴蜀定理 & 一次不定方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../fermat/> <span class=md-ellipsis> 费马小定理 & 欧拉定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../inverse/> <span class=md-ellipsis> 模逆元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-equation/> <span class=md-ellipsis> 线性同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../crt/> <span class=md-ellipsis> 中国剩余定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../lift-the-exponent/> <span class=md-ellipsis> 升幂引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../factorial/> <span class=md-ellipsis> 阶乘取模 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../lucas/> <span class=md-ellipsis> 卢卡斯定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../congruence-equation/> <span class=md-ellipsis> 同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../quad-residue/> <span class=md-ellipsis> 二次剩余 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../primitive-root/> <span class=md-ellipsis> 阶 & 原根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../discrete-logarithm/> <span class=md-ellipsis> 离散对数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../residue/> <span class=md-ellipsis> 高次剩余 & 单位根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../sqrt-decomposition/> <span class=md-ellipsis> 数论分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../dirichlet/> <span class=md-ellipsis> 狄利克雷卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../mobius/> <span class=md-ellipsis> 莫比乌斯反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../du/> <span class=md-ellipsis> 杜教筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../powerful-number/> <span class=md-ellipsis> Powerful Number 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../min-25/> <span class=md-ellipsis> Min_25 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../zhou/> <span class=md-ellipsis> 洲阁筛 </span> </a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> 类欧几里德算法 </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./> <span class=md-ellipsis> 类欧几里德算法 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#引入> <span class=md-ellipsis> 引入 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#类欧几里得算法> <span class=md-ellipsis> 类欧几里得算法 </span> </a> <nav aria-label=类欧几里得算法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#代数解法> <span class=md-ellipsis> 代数解法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#几何直观> <span class=md-ellipsis> 几何直观 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#例题> <span class=md-ellipsis> 例题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#万能欧几里得算法> <span class=md-ellipsis> 万能欧几里得算法 </span> </a> <nav aria-label=万能欧几里得算法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#问题转化> <span class=md-ellipsis> 问题转化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#算法过程> <span class=md-ellipsis> 算法过程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#例题_1> <span class=md-ellipsis> 例题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#习题> <span class=md-ellipsis> 习题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料与注释> <span class=md-ellipsis> 参考资料与注释 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../meissel-lehmer/> <span class=md-ellipsis> Meissel–Lehmer 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../continued-fraction/> <span class=md-ellipsis> 连分数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../stern-brocot/> <span class=md-ellipsis> Stern–Brocot 树与 Farey 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../quadratic/> <span class=md-ellipsis> 二次域 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../pell-equation/> <span class=md-ellipsis> Pell 方程 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_12 type=checkbox> <label class=md-nav__link for=__nav_9_12 id=__nav_9_12_label tabindex=0><span class=md-ellipsis> 多项式与生成函数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_12_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_12><span class="md-nav__icon md-icon"></span> 多项式与生成函数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../poly/intro/> <span class=md-ellipsis> 多项式与生成函数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/fundamental/> <span class=md-ellipsis> 代数基本定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/fft/> <span class=md-ellipsis> 快速傅里叶变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/ntt/> <span class=md-ellipsis> 快速数论变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/fwt/> <span class=md-ellipsis> 快速沃尔什变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/czt/> <span class=md-ellipsis> Chirp Z 变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/newton/> <span class=md-ellipsis> 多项式牛顿迭代 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/multipoint-eval-interpolation/> <span class=md-ellipsis> 多项式多点求值|快速插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/elementary-func/> <span class=md-ellipsis> 多项式初等函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/linear-recurrence/> <span class=md-ellipsis> 常系数齐次线性递推 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/shift/> <span class=md-ellipsis> 多项式平移|连续点值平移 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/symbolic-method/> <span class=md-ellipsis> 符号化方法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/lagrange-inversion/> <span class=md-ellipsis> Lagrange 反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/comp-rev/> <span class=md-ellipsis> 形式幂级数复合|复合逆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/ogf/> <span class=md-ellipsis> 普通生成函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/egf/> <span class=md-ellipsis> 指数生成函数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_13 type=checkbox> <label class=md-nav__link for=__nav_9_13 id=__nav_9_13_label tabindex=0><span class=md-ellipsis> 组合数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_13><span class="md-nav__icon md-icon"></span> 组合数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/combination/> <span class=md-ellipsis> 排列组合 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/drawer-principle/> <span class=md-ellipsis> 抽屉原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/inclusion-exclusion-principle/> <span class=md-ellipsis> 容斥原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/fibonacci/> <span class=md-ellipsis> 斐波那契数列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/derangement/> <span class=md-ellipsis> 错位排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/catalan/> <span class=md-ellipsis> 卡特兰数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/stirling/> <span class=md-ellipsis> 斯特林数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/bell/> <span class=md-ellipsis> 贝尔数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/bernoulli/> <span class=md-ellipsis> 伯努利数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/entringer/> <span class=md-ellipsis> Entringer Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/eulerian/> <span class=md-ellipsis> Eulerian Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/partition/> <span class=md-ellipsis> 分拆数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/vandermonde-convolution/> <span class=md-ellipsis> 范德蒙德卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/polya/> <span class=md-ellipsis> Pólya 计数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/graph-enumeration/> <span class=md-ellipsis> 图论计数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_14 type=checkbox> <label class=md-nav__link for=__nav_9_14 id=__nav_9_14_label tabindex=0><span class=md-ellipsis> 线性代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_14_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_14><span class="md-nav__icon md-icon"></span> 线性代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/> <span class=md-ellipsis> 线性代数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/vector/> <span class=md-ellipsis> 向量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/product/> <span class=md-ellipsis> 内积和外积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/matrix/> <span class=md-ellipsis> 矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/elementary-operations/> <span class=md-ellipsis> 初等变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/determinant/> <span class=md-ellipsis> 行列式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/vector-space/> <span class=md-ellipsis> 线性空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/basis/> <span class=md-ellipsis> 线性基 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/linear-mapping/> <span class=md-ellipsis> 线性映射 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/char-poly/> <span class=md-ellipsis> 特征多项式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/diagonalization/> <span class=md-ellipsis> 对角化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/jordan/> <span class=md-ellipsis> Jordan标准型 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_15 type=checkbox> <label class=md-nav__link for=__nav_9_15 id=__nav_9_15_label tabindex=0><span class=md-ellipsis> 线性规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_15><span class="md-nav__icon md-icon"></span> 线性规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../linear-programming/> <span class=md-ellipsis> 线性规划基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../simplex/> <span class=md-ellipsis> 单纯形法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_16 type=checkbox> <label class=md-nav__link for=__nav_9_16 id=__nav_9_16_label tabindex=0><span class=md-ellipsis> 抽象代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_16_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_16><span class="md-nav__icon md-icon"></span> 抽象代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../algebra/basic/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/group-theory/> <span class=md-ellipsis> 群论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/ring-theory/> <span class=md-ellipsis> 环论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/field-theory/> <span class=md-ellipsis> 域论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/schreier-sims/> <span class=md-ellipsis> Schreier–Sims 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_17 type=checkbox> <label class=md-nav__link for=__nav_9_17 id=__nav_9_17_label tabindex=0><span class=md-ellipsis> 概率论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_17><span class="md-nav__icon md-icon"></span> 概率论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../probability/basic-conception/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/conditional-probability/> <span class=md-ellipsis> 条件概率与独立性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/random-variable/> <span class=md-ellipsis> 随机变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/exp-var/> <span class=md-ellipsis> 随机变量的数字特征 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/concentration-inequality/> <span class=md-ellipsis> 概率不等式 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_18 type=checkbox> <label class=md-nav__link for=__nav_9_18 id=__nav_9_18_label tabindex=0><span class=md-ellipsis> 博弈论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_18><span class="md-nav__icon md-icon"></span> 博弈论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../game-theory/intro/> <span class=md-ellipsis> 博弈论简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../game-theory/impartial-game/> <span class=md-ellipsis> 公平组合游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../game-theory/zero-sum-game/> <span class=md-ellipsis> 零和游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../game-theory/partizan-game/> <span class=md-ellipsis> 非公平组合游戏 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_19 type=checkbox> <label class=md-nav__link for=__nav_9_19 id=__nav_9_19_label tabindex=0><span class=md-ellipsis> 数值算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_19_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_19><span class="md-nav__icon md-icon"></span> 数值算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../numerical/interp/> <span class=md-ellipsis> 插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numerical/integral/> <span class=md-ellipsis> 数值积分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numerical/gauss/> <span class=md-ellipsis> 高斯消元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numerical/newton/> <span class=md-ellipsis> 牛顿迭代法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../order-theory/> <span class=md-ellipsis> 序理论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../young-tableau/> <span class=md-ellipsis> 杨氏矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../matroid/> <span class=md-ellipsis> 拟阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../berlekamp-massey/> <span class=md-ellipsis> Berlekamp–Massey 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10 type=checkbox> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0><span class=md-ellipsis> 数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_10><span class="md-nav__icon md-icon"></span> 数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/> <span class=md-ellipsis> 数据结构部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/stack/> <span class=md-ellipsis> 栈 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/queue/> <span class=md-ellipsis> 队列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/linked-list/> <span class=md-ellipsis> 链表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/hash/> <span class=md-ellipsis> 哈希表 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_6 type=checkbox> <label class=md-nav__link for=__nav_10_6 id=__nav_10_6_label tabindex=0><span class=md-ellipsis> 并查集 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_6><span class="md-nav__icon md-icon"></span> 并查集</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/dsu/> <span class=md-ellipsis> 并查集 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/dsu-complexity/> <span class=md-ellipsis> 并查集复杂度 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_7 type=checkbox> <label class=md-nav__link for=__nav_10_7 id=__nav_10_7_label tabindex=0><span class=md-ellipsis> 堆 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_7_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_7><span class="md-nav__icon md-icon"></span> 堆</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/heap/> <span class=md-ellipsis> 堆简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/binary-heap/> <span class=md-ellipsis> 二叉堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/pairing-heap/> <span class=md-ellipsis> 配对堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/leftist-tree/> <span class=md-ellipsis> 左偏树 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_8 type=checkbox> <label class=md-nav__link for=__nav_10_8 id=__nav_10_8_label tabindex=0><span class=md-ellipsis> 块状数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_8_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_8><span class="md-nav__icon md-icon"></span> 块状数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/decompose/> <span class=md-ellipsis> 分块思想 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/block-array/> <span class=md-ellipsis> 块状数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/block-list/> <span class=md-ellipsis> 块状链表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/tree-decompose/> <span class=md-ellipsis> 树分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sqrt-tree/> <span class=md-ellipsis> Sqrt Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/monotonous-stack/> <span class=md-ellipsis> 单调栈 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/monotonous-queue/> <span class=md-ellipsis> 单调队列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sparse-table/> <span class=md-ellipsis> ST 表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/fenwick/> <span class=md-ellipsis> 树状数组 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_13 type=checkbox> <label class=md-nav__link for=__nav_10_13 id=__nav_10_13_label tabindex=0><span class=md-ellipsis> 线段树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_13><span class="md-nav__icon md-icon"></span> 线段树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg/> <span class=md-ellipsis> 线段树基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-merge-split/> <span class=md-ellipsis> 线段树合并 & 分裂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/li-chao-tree/> <span class=md-ellipsis> 李超线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/cat-tree/> <span class=md-ellipsis> 猫树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-beats/> <span class=md-ellipsis> 区间最值操作 & 区间历史最值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/kinetic-tournament-tree/> <span class=md-ellipsis> Kinetic Tournament Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/dividing/> <span class=md-ellipsis> 划分树 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_15 type=checkbox> <label class=md-nav__link for=__nav_10_15 id=__nav_10_15_label tabindex=0><span class=md-ellipsis> 二叉搜索树 & 平衡树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_15><span class="md-nav__icon md-icon"></span> 二叉搜索树 & 平衡树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/bst/> <span class=md-ellipsis> 二叉搜索树 & 平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/treap/> <span class=md-ellipsis> Treap </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/splay/> <span class=md-ellipsis> Splay 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/wblt/> <span class=md-ellipsis> WBLT </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sgt/> <span class=md-ellipsis> 替罪羊树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/cartesian-tree/> <span class=md-ellipsis> 笛卡尔树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sbt/> <span class=md-ellipsis> Size Balanced Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/avl/> <span class=md-ellipsis> AVL 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/rbtree/> <span class=md-ellipsis> 红黑树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/llrbt/> <span class=md-ellipsis> 左偏红黑树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/aa-tree/> <span class=md-ellipsis> AA 树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/skiplist/> <span class=md-ellipsis> 跳表 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_17 type=checkbox> <label class=md-nav__link for=__nav_10_17 id=__nav_10_17_label tabindex=0><span class=md-ellipsis> 可持久化数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_17><span class="md-nav__icon md-icon"></span> 可持久化数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent/> <span class=md-ellipsis> 可持久化数据结构简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-seg/> <span class=md-ellipsis> 可持久化线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-block-array/> <span class=md-ellipsis> 可持久化块状数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-balanced/> <span class=md-ellipsis> 可持久化平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-trie/> <span class=md-ellipsis> 可持久化字典树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-heap/> <span class=md-ellipsis> 可持久化可并堆 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_18 type=checkbox> <label class=md-nav__link for=__nav_10_18 id=__nav_10_18_label tabindex=0><span class=md-ellipsis> 树套树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_18><span class="md-nav__icon md-icon"></span> 树套树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-seg/> <span class=md-ellipsis> 线段树套线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-balanced/> <span class=md-ellipsis> 平衡树套线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/balanced-in-seg/> <span class=md-ellipsis> 线段树套平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-bit/> <span class=md-ellipsis> 树状数组套权值线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/bit-in-block-array/> <span class=md-ellipsis> 分块套树状数组 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/kdt/> <span class=md-ellipsis> K-D Tree </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_20 type=checkbox> <label class=md-nav__link for=__nav_10_20 id=__nav_10_20_label tabindex=0><span class=md-ellipsis> 动态树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_20_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_20><span class="md-nav__icon md-icon"></span> 动态树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/lct/> <span class=md-ellipsis> Link Cut Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/global-bst/> <span class=md-ellipsis> 全局平衡二叉树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/ett/> <span class=md-ellipsis> Euler Tour Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/top-tree/> <span class=md-ellipsis> Top Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/divide-combine/> <span class=md-ellipsis> 析合树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/pq-tree/> <span class=md-ellipsis> PQ 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/finger-tree/> <span class=md-ellipsis> 手指树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/huffman-tree/> <span class=md-ellipsis> 霍夫曼树 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11 type=checkbox> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0><span class=md-ellipsis> 图论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_11><span class="md-nav__icon md-icon"></span> 图论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/> <span class=md-ellipsis> 图论部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/concept/> <span class=md-ellipsis> 图论相关概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/save/> <span class=md-ellipsis> 图的存储 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dfs/> <span class=md-ellipsis> DFS（图论） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bfs/> <span class=md-ellipsis> BFS（图论） </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_6 type=checkbox> <label class=md-nav__link for=__nav_11_6 id=__nav_11_6_label tabindex=0><span class=md-ellipsis> 树上问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_6><span class="md-nav__icon md-icon"></span> 树上问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-basic/> <span class=md-ellipsis> 树基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-diameter/> <span class=md-ellipsis> 树的直径 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-center/> <span class=md-ellipsis> 树的中心 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-centroid/> <span class=md-ellipsis> 树的重心 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/lca/> <span class=md-ellipsis> 最近公共祖先 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/hld/> <span class=md-ellipsis> 树链剖分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dsu-on-tree/> <span class=md-ellipsis> 树上启发式合并 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/virtual-tree/> <span class=md-ellipsis> 虚树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-divide/> <span class=md-ellipsis> 树分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dynamic-tree-divide/> <span class=md-ellipsis> 动态树分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-ahu/> <span class=md-ellipsis> AHU 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-hash/> <span class=md-ellipsis> 树哈希 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-random-walk/> <span class=md-ellipsis> 树上随机游走 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dag/> <span class=md-ellipsis> 有向无环图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/topo/> <span class=md-ellipsis> 拓扑排序 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_9 type=checkbox> <label class=md-nav__link for=__nav_11_9 id=__nav_11_9_label tabindex=0><span class=md-ellipsis> 最短路问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_9_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_9><span class="md-nav__icon md-icon"></span> 最短路问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/shortest-path/> <span class=md-ellipsis> 最短路 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/diff-constraints/> <span class=md-ellipsis> 差分约束 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/kth-path/> <span class=md-ellipsis> k 短路 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/mod-shortest-path/> <span class=md-ellipsis> 同余最短路 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_10 type=checkbox> <label class=md-nav__link for=__nav_11_10 id=__nav_11_10_label tabindex=0><span class=md-ellipsis> 生成树问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_10_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_10><span class="md-nav__icon md-icon"></span> 生成树问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/mst/> <span class=md-ellipsis> 最小生成树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dmst/> <span class=md-ellipsis> 最小树形图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/mdst/> <span class=md-ellipsis> 最小直径生成树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/steiner-tree/> <span class=md-ellipsis> 斯坦纳树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/node/> <span class=md-ellipsis> 拆点 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_13 type=checkbox> <label class=md-nav__link for=__nav_11_13 id=__nav_11_13_label tabindex=0><span class=md-ellipsis> 连通性相关 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_13><span class="md-nav__icon md-icon"></span> 连通性相关</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/scc/> <span class=md-ellipsis> 强连通分量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bcc/> <span class=md-ellipsis> 双连通分量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/cut/> <span class=md-ellipsis> 割点和桥 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/block-forest/> <span class=md-ellipsis> 圆方树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/connectivity/> <span class=md-ellipsis> 点/边连通度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/rings-count/> <span class=md-ellipsis> 环计数问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/min-cycle/> <span class=md-ellipsis> 最小环 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/2-sat/> <span class=md-ellipsis> 2-SAT </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/euler/> <span class=md-ellipsis> 欧拉图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/hamilton/> <span class=md-ellipsis> 哈密顿图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bi-graph/> <span class=md-ellipsis> 二分图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/planar/> <span class=md-ellipsis> 平面图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/chord/> <span class=md-ellipsis> 弦图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/color/> <span class=md-ellipsis> 图的着色 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_23 type=checkbox> <label class=md-nav__link for=__nav_11_23 id=__nav_11_23_label tabindex=0><span class=md-ellipsis> 网络流 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_23_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_23><span class="md-nav__icon md-icon"></span> 网络流</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/> <span class=md-ellipsis> 网络流简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/max-flow/> <span class=md-ellipsis> 最大流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/min-cut/> <span class=md-ellipsis> 最小割 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/min-cost/> <span class=md-ellipsis> 费用流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/bound/> <span class=md-ellipsis> 上下界网络流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/stoer-wagner/> <span class=md-ellipsis> Stoer–Wagner 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_24 type=checkbox> <label class=md-nav__link for=__nav_11_24 id=__nav_11_24_label tabindex=0><span class=md-ellipsis> 图的匹配 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_24_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_24><span class="md-nav__icon md-icon"></span> 图的匹配</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/graph-match/> <span class=md-ellipsis> 图匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/bigraph-match/> <span class=md-ellipsis> 二分图最大匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/bigraph-weight-match/> <span class=md-ellipsis> 二分图最大权匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/general-match/> <span class=md-ellipsis> 一般图最大匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/general-weight-match/> <span class=md-ellipsis> 一般图最大权匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/stable-match/> <span class=md-ellipsis> 稳定匹配 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/prufer/> <span class=md-ellipsis> Prüfer 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/matrix-tree/> <span class=md-ellipsis> 矩阵树定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/lgv/> <span class=md-ellipsis> LGV 引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/max-clique/> <span class=md-ellipsis> 最大团搜索算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dominator-tree/> <span class=md-ellipsis> 支配树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-random-walk/> <span class=md-ellipsis> 图上随机游走 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_12 type=checkbox> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0><span class=md-ellipsis> 计算几何 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_12_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_12><span class="md-nav__icon md-icon"></span> 计算几何</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../geometry/> <span class=md-ellipsis> 计算几何部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/2d/> <span class=md-ellipsis> 二维计算几何基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/3d/> <span class=md-ellipsis> 三维计算几何基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/distance/> <span class=md-ellipsis> 距离 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/pick/> <span class=md-ellipsis> Pick 定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/triangulation/> <span class=md-ellipsis> 三角剖分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/convex-hull/> <span class=md-ellipsis> 凸包 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/scanning/> <span class=md-ellipsis> 扫描线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/rotating-calipers/> <span class=md-ellipsis> 旋转卡壳 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/half-plane/> <span class=md-ellipsis> 半平面交 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/nearest-points/> <span class=md-ellipsis> 平面最近点对 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/random-incremental/> <span class=md-ellipsis> 随机增量法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/inverse/> <span class=md-ellipsis> 反演变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/misc/> <span class=md-ellipsis> 计算几何杂项 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13 type=checkbox> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0><span class=md-ellipsis> 杂项 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_13><span class="md-nav__icon md-icon"></span> 杂项</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/> <span class=md-ellipsis> 杂项简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/discrete/> <span class=md-ellipsis> 离散化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/two-pointer/> <span class=md-ellipsis> 双指针 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_4 type=checkbox> <label class=md-nav__link for=__nav_13_4 id=__nav_13_4_label tabindex=0><span class=md-ellipsis> 离线算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_4_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_13_4><span class="md-nav__icon md-icon"></span> 离线算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/offline/> <span class=md-ellipsis> 离线算法简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/cdq-divide/> <span class=md-ellipsis> CDQ 分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/parallel-binsearch/> <span class=md-ellipsis> 整体二分 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_4_4 type=checkbox> <label class=md-nav__link for=__nav_13_4_4 id=__nav_13_4_4_label tabindex=0><span class=md-ellipsis> 莫队算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_4_4_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_13_4_4><span class="md-nav__icon md-icon"></span> 莫队算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-intro/> <span class=md-ellipsis> 莫队算法简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo/> <span class=md-ellipsis> 普通莫队算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/modifiable-mo-algo/> <span class=md-ellipsis> 带修改莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-on-tree/> <span class=md-ellipsis> 树上莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/rollback-mo-algo/> <span class=md-ellipsis> 回滚莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-2dimen/> <span class=md-ellipsis> 二维莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-secondary-offline/> <span class=md-ellipsis> 莫队二次离线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-with-bitset/> <span class=md-ellipsis> 莫队配合 bitset </span> </a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/frac-programming/> <span class=md-ellipsis> 分数规划 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_6 type=checkbox> <label class=md-nav__link for=__nav_13_6 id=__nav_13_6_label tabindex=0><span class=md-ellipsis> 随机化 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_13_6><span class="md-nav__icon md-icon"></span> 随机化</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/random/> <span class=md-ellipsis> 随机函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/rand-technique/> <span class=md-ellipsis> 随机化技巧 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/hill-climbing/> <span class=md-ellipsis> 爬山算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/simulated-annealing/> <span class=md-ellipsis> 模拟退火 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/hoverline/> <span class=md-ellipsis> 悬线法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/fsm/> <span class=md-ellipsis> 有限状态自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/cc-basic/> <span class=md-ellipsis> 计算理论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/endianness/> <span class=md-ellipsis> 字节顺序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/josephus/> <span class=md-ellipsis> 约瑟夫问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/expression/> <span class=md-ellipsis> 表达式求值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/job-order/> <span class=md-ellipsis> 在一台机器上规划任务 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/main-element/> <span class=md-ellipsis> 主元素问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/garsia-wachs/> <span class=md-ellipsis> Garsia–Wachs 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/15-puzzle/> <span class=md-ellipsis> 15-puzzle </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/kahan-summation/> <span class=md-ellipsis> Kahan 求和 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/odt/> <span class=md-ellipsis> 珂朵莉树/颜色段均摊 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/space-optimization/> <span class=md-ellipsis> 空间优化简介 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_14 type=checkbox> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex=0><span class=md-ellipsis> 专题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_14_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_14><span class="md-nav__icon md-icon"></span> 专题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../topic/rmq/> <span class=md-ellipsis> RMQ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/dsu-app/> <span class=md-ellipsis> 并查集应用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/bracket/> <span class=md-ellipsis> 括号序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/segment-tree-offline/> <span class=md-ellipsis> 线段树与离线询问 </span> </a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#引入> <span class=md-ellipsis> 引入 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#类欧几里得算法> <span class=md-ellipsis> 类欧几里得算法 </span> </a> <nav aria-label=类欧几里得算法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#代数解法> <span class=md-ellipsis> 代数解法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#几何直观> <span class=md-ellipsis> 几何直观 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#例题> <span class=md-ellipsis> 例题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#万能欧几里得算法> <span class=md-ellipsis> 万能欧几里得算法 </span> </a> <nav aria-label=万能欧几里得算法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#问题转化> <span class=md-ellipsis> 问题转化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#算法过程> <span class=md-ellipsis> 算法过程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#例题_1> <span class=md-ellipsis> 例题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#习题> <span class=md-ellipsis> 习题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料与注释> <span class=md-ellipsis> 参考资料与注释 </span> </a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://oi-wiki.org/edit-landing/?ref=/math/number-theory/euclidean.md" rel=edit title=编辑此页> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a><h1>类欧几里德算法</h1><h2 data-original-document-end=5 data-original-document-start=0 id=引入>引入<a title="Permanent link" class=headerlink href=#引入></a></h2><p data-original-document-end=48 data-original-document-start=7>类欧几里德算法是洪华敦在 2016 年冬令营营员交流中提出的内容．它常用于解决形如</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left\lfloor\dfrac{ai+b}{c}\right\rfloor
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left\lfloor\dfrac{ai+b}{c}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=\left\lfloor\dfrac{ai+b}{c}\right\rfloor display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left\lfloor\dfrac{ai+b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow></math></mjx-assistive-mml><img title="
\left\lfloor\dfrac{ai+b}{c}\right\rfloor
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=259 data-original-document-start=98>结构的数列（下标为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container>）的求和问题．它的主要想法是，利用分数自身的递归结构，将问题转化为更小规模的问题，递归求解．因为分数的递归结构和 <a href=../gcd/#欧几里得算法>欧几里得算法</a> 存在直接的 <a href=../continued-fraction/#连分数表示的求法>联系</a>，因此，这一求和方法也称为类欧几里得算法．</p><p data-original-document-end=414 data-original-document-start=261>因为 <a href=../continued-fraction/>连分数</a> 和 <a href=../stern-brocot/>Stern–Brocot 树</a> 等方法同样刻画了分数的递归结构，所以利用类欧几里得算法可以解决的问题，通常也可以用这些方法解决．与这些方法相比，类欧几里得算法通常更容易理解，它的实现也更为简明．</p><h2 data-original-document-end=426 data-original-document-start=416 id=类欧几里得算法>类欧几里得算法<a title="Permanent link" class=headerlink href=#类欧几里得算法></a></h2><p data-original-document-end=442 data-original-document-start=428>最简单的例子，就是求和问题：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(a,b,c,n)=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(a,b,c,n)=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor," display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
f(a,b,c,n)=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=536 data-original-document-start=517>其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b,c,n><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b,c,n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b,c,n></mjx-container> 都是正整数．</p><h3 data-original-document-end=546 data-original-document-start=538 id=代数解法>代数解法<a title="Permanent link" class=headerlink href=#代数解法></a></h3><p data-original-document-end=599 data-original-document-start=548>首先，将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b></mjx-container> 对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=c><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=c xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=c>c</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=c></mjx-container> 取模，可以简化问题，将问题转化为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="0\le a,b<c" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="0\le a,b<c" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn><mo data-latex=\le>≤</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="0\le a,b<c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor\\
&=\sum_{i=0}^n\left\lfloor
\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}\right\rfloor\\
&=\sum_{i=0}^n\left(\left\lfloor\frac{a}{c}\right\rfloor i+\left\lfloor\frac{b}{c}\right\rfloor+\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}
\right\rfloor\right)\\
&=\frac{n(n+1)}{2}\left\lfloor\frac{a}{c}\right\rfloor
+(n+1)\left\lfloor\frac{b}{c}\right\rfloor+f(a\bmod c,b\bmod c,c,n).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c,c,n).
\end{aligned}' style=min-width:30.538em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor
\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}\right\rfloor" space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S7">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)\right)'><mjx-mrow data-latex='\leftoken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)\right)'><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-SO">(</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{a}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-SO">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi data-latex=a size=s><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi data-latex=c size=s><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-SO">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-SO">)</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left space=3><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{b}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-LO">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi data-latex=b size=s><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi data-latex=c size=s><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-LO">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S7">⌋</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left(\left\lfloor\frac{a}{c}\right\rfloor i+\left\lfloor\frac{b}{c}\right\rfloor+\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}
\right\rfloor\right)" space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S6">(</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{a}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}
\right\rfloor" space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c\right)'><mjx-mrow data-latex='\leftoken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c\right)'><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left space=3><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S6">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.256em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{n(n+1)}{2} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=n(n+1)><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor\\&=\sum_{i=0}^n\left\lfloor\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}\right\rfloor\\&=\sum_{i=0}^n\left(\left\lfloor\frac{a}{c}\right\rfloor i+\left\lfloor\frac{b}{c}\right\rfloor+\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}\right\rfloor\right)\\&=\frac{n(n+1)}{2}\left\lfloor\frac{a}{c}\right\rfloor+(n+1)\left\lfloor\frac{b}{c}\right\rfloor+f(a\bmod c,b\bmod c,c,n).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c,c,n).\end{aligned}' columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}\right\rfloor" data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}"><mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)\right)'><mrow data-latex='\leftoken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)\right)' data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex="\left\lfloor\frac{a}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=c>c</mi><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mrow data-latex=\left data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex="\left\lfloor\frac{b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=c>c</mi><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left(\left\lfloor\frac{a}{c}\right\rfloor i+\left\lfloor\frac{b}{c}\right\rfloor+\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}\right\rfloor\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex="\left\lfloor\frac{a}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mrow data-latex="\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}\right\rfloor" data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}"><mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c\right)'><mrow data-latex='\leftoken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c\right)' data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mrow data-latex=\left data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mfrac data-latex=\frac{n(n+1)}{2}><mrow data-latex=n(n+1)><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow><mn data-latex=2>2</mn></mfrac><mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor\\
&=\sum_{i=0}^n\left\lfloor
\frac{\left(\left\lfloor\frac{a}{c}\right\rfloor c+(a\bmod c)\right)i+\left(\left\lfloor\frac{b}{c}\right\rfloor c+(b\bmod c)\right)}{c}\right\rfloor\\
&=\sum_{i=0}^n\left(\left\lfloor\frac{a}{c}\right\rfloor i+\left\lfloor\frac{b}{c}\right\rfloor+\left\lfloor\frac{\left(a\bmod c\right)i+\left(b\bmod c\right)}{c}
\right\rfloor\right)\\
&=\frac{n(n+1)}{2}\left\lfloor\frac{a}{c}\right\rfloor
+(n+1)\left\lfloor\frac{b}{c}\right\rfloor+f(a\bmod c,b\bmod c,c,n).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=1208 data-original-document-start=1195>现在，考虑转化后的问题．令</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
m = \left\lfloor \frac{an+b}{c} \right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor \frac{an+b}{c} \right\rfloor" space=4><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{an+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=an+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="m = \left\lfloor \frac{an+b}{c} \right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor \frac{an+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{an+b}{c}><mrow data-latex=an+b><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
m = \left\lfloor \frac{an+b}{c} \right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=1280 data-original-document-start=1264>那么，原问题可以写作二次求和式：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor
=\sum_{i=0}^n\sum_{j=0}^{m-1}\left[j<\left\lfloor \frac{ai+b}{c} \right\rfloor\right].
" aria-hidden=true class=NCM-N display=true><mjx-munderover data-latex="\sum_{i=0}^n"><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left[j<\left\lfloor \frac{ai+b}{c} \right\rfloor\right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=4><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor=\sum_{i=0}^n\sum_{j=0}^{m-1}\left[j<\left\lfloor \frac{ai+b}{c} \right\rfloor\right]." display=block xmlns=http://www.w3.org/1998/Math/MathML><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mrow data-latex="\left[j<\left\lfloor \frac{ai+b}{c} \right\rfloor\right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=j>j</mi><mo data-latex="<">&lt;</mo><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor
=\sum_{i=0}^n\sum_{j=0}^{m-1}\left[j<\left\lfloor \frac{ai+b}{c} \right\rfloor\right].
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=1474 data-original-document-start=1430>交换求和次序，这需要对于每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 计算满足条件的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 的范围．为此，将条件变形：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
&j<\left\lfloor \frac{ai+b}{c} \right\rfloor = \left\lceil \frac{ai+b+1}{c} \right\rceil-1\\
&\iff j + 1 < \left\lceil \frac{ai+b+1}{c} \right\rceil
\iff j+1< \frac{ai+b+1}{c} \\
&\iff \dfrac{cj+c-b-1}{a} < i
\iff \left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor < i.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\;\Longleftrightarrow\;\left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor < i.
\end{aligned}" style=min-width:22.435em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.17em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor " space=4><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lceil \frac{ai+b+1}{c} \right\rceil" space=4><mjx-mo data-latex="\left\lceil "><mjx-c class="mjx-c2308 NCM-S5">⌈</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b+1}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b+1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rceil><mjx-c class="mjx-c2309 NCM-S5">⌉</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.17em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mi data-latex=j space=4><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lceil \frac{ai+b+1}{c} \right\rceil" space=4><mjx-mo data-latex="\left\lceil "><mjx-c class="mjx-c2308 NCM-S5">⌈</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b+1}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b+1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rceil><mjx-c class="mjx-c2309 NCM-S5">⌉</mjx-c></mjx-mo></mjx-mrow><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow space=4><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mi data-latex=j space=4><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b+1}{c} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b+1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.17em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mfrac data-latex=\dfrac{cj+c-b-1}{a} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=i space=4><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow space=4><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mrow data-latex="\left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor " space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=i space=4><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}&j<\left\lfloor \frac{ai+b}{c} \right\rfloor = \left\lceil \frac{ai+b+1}{c} \right\rceil-1\\&\iff j + 1 < \left\lceil \frac{ai+b+1}{c} \right\rceil\iff j+1< \frac{ai+b+1}{c} \\&\iff \dfrac{cj+c-b-1}{a} < i\iff \left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor < i.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\;\Longleftrightarrow\;\left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor < i.\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi data-latex=j>j</mi><mo data-latex="<">&lt;</mo><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor " data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="=">=</mo><mrow data-latex="\left\lceil \frac{ai+b+1}{c} \right\rceil" data-mjx-texclass=INNER><mo data-latex="\left\lceil " data-mjx-texclass=OPEN>⌈</mo><mfrac data-latex=\frac{ai+b+1}{c}><mrow data-latex=ai+b+1><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rceil data-mjx-texclass=CLOSE>⌉</mo></mrow><mo data-latex=->−</mo><mn data-latex=1>1</mn></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex="<">&lt;</mo><mrow data-latex="\left\lceil \frac{ai+b+1}{c} \right\rceil" data-mjx-texclass=INNER><mo data-latex="\left\lceil " data-mjx-texclass=OPEN>⌈</mo><mfrac data-latex=\frac{ai+b+1}{c}><mrow data-latex=ai+b+1><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rceil data-mjx-texclass=CLOSE>⌉</mo></mrow><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex="<">&lt;</mo><mfrac data-latex=\frac{ai+b+1}{c}><mrow data-latex=ai+b+1><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><mi data-latex=c>c</mi></mfrac></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mfrac data-latex=\dfrac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="<">&lt;</mo><mi data-latex=i>i</mi><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mrow data-latex="\left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="<">&lt;</mo><mi data-latex=i>i</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
&j<\left\lfloor \frac{ai+b}{c} \right\rfloor = \left\lceil \frac{ai+b+1}{c} \right\rceil-1\\
&\iff j + 1 < \left\lceil \frac{ai+b+1}{c} \right\rceil
\iff j+1< \frac{ai+b+1}{c} \\
&\iff \dfrac{cj+c-b-1}{a} < i
\iff \left\lfloor\dfrac{cj+c-b-1}{a}\right\rfloor < i.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=1832 data-original-document-start=1777>变形过程中多次利用了 <a href=../basic/#取整函数>取整函数</a> 的性质．代入变形后的条件，原式可以写作：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,b,c,n)&=\sum_{j=0}^{m-1}
\sum_{i=0}^n\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=nm-f\left(c,c-b-1,a,m-1\right).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
f(a,b,c,n)&=\sum_{j=0}^{m-1}
\sum_{i=0}^n\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=nm-f\left(c,c-b-1,a,m-1\right).
\end{aligned}" style=min-width:19.391em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=4><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{i=0}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=">" space=4><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=4><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mrow data-latex=\left(c,c-b-1,a,m-1\right) space=2><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,b,c,n)&=\sum_{j=0}^{m-1}\sum_{i=0}^n\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\&=\sum_{j=0}^{m-1}\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\&=nm-f\left(c,c-b-1,a,m-1\right).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(a,b,c,n)&=\sum_{j=0}^{m-1}\sum_{i=0}^n\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\&=\sum_{j=0}^{m-1}\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\&=nm-f\left(c,c-b-1,a,m-1\right).\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=i>i</mi><mo data-latex=">">></mo><mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mrow data-latex=\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mrow data-latex=\left(c,c-b-1,a,m-1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,b,c,n)&=\sum_{j=0}^{m-1}
\sum_{i=0}^n\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=nm-f\left(c,c-b-1,a,m-1\right).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=2146 data-original-document-start=2087>令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a',b',c',n')=(c,c-b-1,a,m-1)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a',b',c',n')=(c,c-b-1,a,m-1)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=b>b</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=n>n</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a',b',c',n')=(c,c-b-1,a,m-1)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，这就又回到了前面讨论过的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a'>c'" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a'>c'" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=">">></mo><msup><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="a'>c'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形．</p><p data-original-document-end=2265 data-original-document-start=2148>将这两步转化结合在一起，可以发现在过程中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,c)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,c) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,c)></mjx-container> 不断地取模后交换位置，直到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="a=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．这就类似于对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,c)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,c) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,c)></mjx-container> 进行辗转相除，这也是类欧几里德算法的得名．它的时间复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c\})></mjx-container> 的．</p><p data-original-document-end=2384 data-original-document-start=2267>在计算过程中，可能会出现 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="m=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形，此时内层递归会出现 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="n=-1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="n=-1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mo data-latex="=">=</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="n=-1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．这并不影响最终的结果．但是，如果要求出现 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="m=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时，直接终止算法，那么算法的时间复杂度可以改良为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c,n\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c,n\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c,n\})></mjx-container> 的．</p><details class=note data-original-document-end=3347 data-original-document-start=2386><summary>对复杂度的解释</summary> <p>利用该算法和欧几里得算法的相似性，很容易说明它的时间复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c\})></mjx-container> 的．因此，只需要说明，如果在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="m=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时终止算法，那么它的时间复杂度也是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log n)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log n)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的．</p> <p>令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=\lfloor(an+b)/c\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=\lfloor(an+b)/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="m=\lfloor(an+b)/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，并记 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="S=mn" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="S=mn" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi><mo data-latex="=">=</mo><mi data-latex=m>m</mi><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="S=mn" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k=m/n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k=m/n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mi data-latex=m>m</mi><mo data-latex=/>/</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="k=m/n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，它们分别相当于几何直观（见下一节）中点阵图的面积和直线的斜率．对于充分大的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container>，近似有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k\doteq a/c" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\doteq><mjx-c class=mjx-c2250>≐</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k\doteq a/c" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex=\doteq>≐</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="k\doteq a/c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p> <p>考察 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 在算法过程中的变化．第一步取模时，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 保持不变，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 近似由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a/c><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a/c xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a/c></mjx-container> 变为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a\bmod c)/c" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a\bmod c)/c" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="(a\bmod c)/c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，相当于斜率由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 变为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k-\lfloor k\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k-\lfloor k\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="k-\lfloor k\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 也近似变为原来的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(k-\lfloor k\rfloor)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(k-\lfloor k\rfloor)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(k-\lfloor k\rfloor)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 倍．第二步交换横纵坐标时，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 近似保持不变，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 则变为它的倒数．因此，若设两步操作后，二元组 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(k,S)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=S space=2><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(k,S) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(k,S)></mjx-container> 变为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(k',S')" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.052em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(k',S')" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=S>S</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(k',S')" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k'=(k-\lfloor k\rfloor)^{-1}" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-msup data-latex=)^{-1}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k'=(k-\lfloor k\rfloor)^{-1}" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><msup data-latex=)^{-1}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup></math></mjx-assistive-mml><img title="k'=(k-\lfloor k\rfloor)^{-1}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="S'=(k-\lfloor k\rfloor)S" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.052em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="S'=(k-\lfloor k\rfloor)S" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=S>S</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=) stretchy=false>)</mo><mi data-latex=S>S</mi></math></mjx-assistive-mml><img title="S'=(k-\lfloor k\rfloor)S" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p> <p>因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="1\le\lfloor k'\rfloor\le k'<\lfloor k'\rfloor+1" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="1\le\lfloor k'\rfloor\le k'<\lfloor k'\rfloor+1" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn><mo data-latex=\le>≤</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=\le>≤</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="<">&lt;</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="1\le\lfloor k'\rfloor\le k'<\lfloor k'\rfloor+1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以，递归计算两轮后，乘积缩小的倍数最少为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
(k'-\lfloor k'\rfloor)(k-\lfloor k\rfloor) = 1-\dfrac{\lfloor k'\rfloor}{k'} < 1-\dfrac{\lfloor k'\rfloor}{\lfloor k'\rfloor+1} = \dfrac{1}{\lfloor k'\rfloor+1}\le \dfrac{1}{2}.
" aria-hidden=true class=NCM-N display=true><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{\lfloor k'\rfloor}{k'}" space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="\lfloor k'\rfloor"><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msup data-latex="k'"><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{\lfloor k'\rfloor}{\lfloor k'\rfloor+1}" space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="\lfloor k'\rfloor"><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="\lfloor k'\rfloor+1"><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{1}{\lfloor k'\rfloor+1}" space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="\lfloor k'\rfloor+1"><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="(k'-\lfloor k'\rfloor)(k-\lfloor k\rfloor) = 1-\dfrac{\lfloor k'\rfloor}{k'} < 1-\dfrac{\lfloor k'\rfloor}{\lfloor k'\rfloor+1} = \dfrac{1}{\lfloor k'\rfloor+1}\le \dfrac{1}{2}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mfrac data-latex="\dfrac{\lfloor k'\rfloor}{k'}"><mrow data-latex="\lfloor k'\rfloor"><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow><msup data-latex="k'"><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></mfrac><mo data-latex="<">&lt;</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mfrac data-latex="\dfrac{\lfloor k'\rfloor}{\lfloor k'\rfloor+1}"><mrow data-latex="\lfloor k'\rfloor"><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow><mrow data-latex="\lfloor k'\rfloor+1"><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></mfrac><mo data-latex="=">=</mo><mfrac data-latex="\dfrac{1}{\lfloor k'\rfloor+1}"><mn data-latex=1>1</mn><mrow data-latex="\lfloor k'\rfloor+1"><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup><mi data-latex=k>k</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></mfrac><mo data-latex=\le>≤</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
(k'-\lfloor k'\rfloor)(k-\lfloor k\rfloor) = 1-\dfrac{\lfloor k'\rfloor}{k'} < 1-\dfrac{\lfloor k'\rfloor}{\lfloor k'\rfloor+1} = \dfrac{1}{\lfloor k'\rfloor+1}\le \dfrac{1}{2}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，至多 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log S)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=S space=2><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log S)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log S)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 轮，算法必然终止．因为从第二轮开始，每轮开始时的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 总是不超过上一轮取模结束后的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container>，而后者大致为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=kn^2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-msup data-latex=n^2><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=kn^2 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><msup data-latex=n^2><mi data-latex=n>n</mi><mn data-latex=2>2</mn></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=kn^2></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k<1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k<1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex="<">&lt;</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="k<1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，因而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log S)\subseteq O(\log n)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=S space=2><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\subseteq><mjx-c class=mjx-c2286>⊆</mjx-c></mjx-mo><mjx-mi data-latex=O space=4><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log S)\subseteq O(\log n)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\subseteq>⊆</mo><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log S)\subseteq O(\log n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．这就得到了上述结论．</p></details><p data-original-document-end=3360 data-original-document-start=3349>模板题的参考实现如下：</p><details class=example data-original-document-end=3564 data-original-document-start=3362><summary>模板题实现（<a href=https://judge.yosupo.jp/problem/sum_of_floor_of_linear target=_blank>Library Checker - Sum of Floor of Linear</a>）</summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>b</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><h3 data-original-document-end=3574 data-original-document-start=3566 id=几何直观>几何直观<a title="Permanent link" class=headerlink href=#几何直观></a></h3><p data-original-document-end=3619 data-original-document-start=3576>这个算法还可以从几何的角度理解．类欧几里得算法可以解决的问题主要是直线下整点计数问题．</p><p data-original-document-end=3641 data-original-document-start=3621>如下图最左部分所示，该求和式相当于求直线</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
y = \dfrac{ax+b}{c}
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{ax+b}{c} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ax+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="y = \dfrac{ax+b}{c}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{ax+b}{c}><mrow data-latex=ax+b><mi data-latex=a>a</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac></math></mjx-assistive-mml><img title="
y = \dfrac{ax+b}{c}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=3715 data-original-document-start=3670>下方，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 轴上方（不包括 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 轴），且横坐标位于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=[0,n]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[0,n] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[0,n]></mjx-container> 之间的格点数目．</p><p data-original-document-end=3746 data-original-document-start=3717><img alt src=../images/euclidean-1.svg></p><p data-original-document-end=4012 data-original-document-start=3748>首先，移除斜率和截距中的整数部分．这一步相当于将上图中间部分的蓝点数量单独计算出来．当斜率和截距都是整数时，蓝点一定构成一个梯形阵列，也就是说，不同纵列的格点形成等差数列，因而这些点的数量是容易计算的．将这些点移除后，剩余的格点和上图最右部分的红点数量一致．问题就转化成了斜率和截距都小于一的情形．因为梯形的高为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=n+1><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n+1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n+1></mjx-container> 且两个底边长度分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor b/c\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor b/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor b/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(\lfloor a/c\rfloor n+\lfloor b/c\rfloor)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(\lfloor a/c\rfloor n+\lfloor b/c\rfloor)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(\lfloor a/c\rfloor n+\lfloor b/c\rfloor)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以，利用梯形面积公式，这一步骤可以归纳为算式</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(a,b,c,n) = f(a\bmod c,b\bmod c,c,n) + \dfrac{1}{2}(n+1)\left(\left\lfloor\dfrac{b}{c}\right\rfloor+\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)\right).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mrow data-latex="\left(\left\lfloor\dfrac{b}{c}\right\rfloor+\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)\right)" space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{b}{c}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex="\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)" space=3><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{a}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{b}{c}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(a,b,c,n) = f(a\bmod c,b\bmod c,c,n) + \dfrac{1}{2}(n+1)\left(\left\lfloor\dfrac{b}{c}\right\rfloor+\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)\right)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-latex="\left(\left\lfloor\dfrac{b}{c}\right\rfloor+\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex=\left\lfloor\dfrac{b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mrow data-latex="\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex="\left\lfloor\dfrac{a}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mrow data-latex=\left\lfloor\dfrac{b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(a,b,c,n) = f(a\bmod c,b\bmod c,c,n) + \dfrac{1}{2}(n+1)\left(\left\lfloor\dfrac{b}{c}\right\rfloor+\left(\left\lfloor\dfrac{a}{c}\right\rfloor n+\left\lfloor\dfrac{b}{c}\right\rfloor\right)\right).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=4403 data-original-document-start=4221>然后，翻转横纵坐标轴．如下图最左部分所示，图中的红点和蓝点构成了一个横向长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container>、纵向长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=\lfloor(an+b)/c\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=\lfloor(an+b)/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="m=\lfloor(an+b)/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的矩形点阵．要计算红点的数量，只需要计算蓝点的数量，再用矩形点阵的数量减去蓝点的数量即可．翻转后，上图左半部分中的蓝点点阵就变成了某条直线下的红色点阵．而且，翻转后，斜率大于一，就又回到了上文已经处理过的情形．</p><p data-original-document-end=4434 data-original-document-start=4405><img alt src=../images/euclidean-2.svg></p><p data-original-document-end=4731 data-original-document-start=4436>关键在于如何计算新的红色点阵上方的直线的方程．将上图最左部分的横纵坐标轴翻转，就得到上图中间部分．翻转后的红色点阵上方的直线（中间部分的实线），并非对应翻转前的直线（最左部分的实线），而是翻转前的直线向左上平移一点点的结果（最左部分的虚线）．这是因为，如果直接将直线（最左部分的实线）翻转，将得到中间部分的虚线，但是按照定义，它下方的格点包括恰好落在直线上的格点，这就会导致直线上的格点重复计数．为了避免这一点，需要将翻转直线 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y=(ax+b)/c" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y=(ax+b)/c" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="y=(ax+b)/c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 后得到的直线 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y=(cx-b)/a" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y=(cx-b)/a" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img title="y=(cx-b)/a" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 向下平移一点点，得到直线 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y=(cx-b-1)/a" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y=(cx-b-1)/a" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img title="y=(cx-b-1)/a" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，这样它下方的点阵才恰为翻转前的蓝色点阵．</p><p data-original-document-end=4930 data-original-document-start=4733>还有另一处细节需要处理．上图中间部分的直线的截距是负数，这意味着还没有回到之前的初始情形．要让截距恢复为非负数，只需要将直线（中间部分的实线）向左平移一个单位．这样做不会漏掉任何格点，因为翻转前的蓝色点阵中没有纵坐标为零的点，翻转后也就不存在横坐标为零的点．最后，直线方程就变为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y=(cx+c-b-1)/a" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y=(cx+c-b-1)/a" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img title="y=(cx+c-b-1)/a" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>；同时，点阵的横坐标的上界也从 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 变成了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m-1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m-1></mjx-container>．这一步骤可以归纳为算式</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(a,b,c,n) = mn - f(c,c-b-1,a,m-1).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(a,b,c,n) = mn - f(c,c-b-1,a,m-1)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=m>m</mi><mi data-latex=n>n</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(a,b,c,n) = mn - f(c,c-b-1,a,m-1).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=4994 data-original-document-start=4975>这种递归的算法行得通，主要有两个原因：</p><ul data-original-document-end=5304 data-original-document-start=4996><li>第一，直线的斜率不断地先取小数部分再取倒数，这等价于计算直线斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k=a/c" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k=a/c" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="k=a/c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的 <a href=../continued-fraction/#连分数表示的求法>连分数展开</a>．因为有理分数的连分数展开的长度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c\})></mjx-container> 的，所以这一过程一定在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c\})></mjx-container> 步后终止；</li><li>第二，因为每次翻转坐标轴的时候，直线斜率都是小于一的，因此，直觉上应该有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m<n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m<n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="<">&lt;</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="m<n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，也就是说，经过这样一轮迭代后，横坐标的范围一直是在缩小的．前文的复杂度计算中通过严格的分析说明，每两轮迭代后，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 至多为原来的一半，故而这一过程一定在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log n)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log n)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 步后终止．</li></ul><p data-original-document-end=5357 data-original-document-start=5306>这也是斜率为有理数时的类欧几里得算法的复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c,n\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c,n\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c,n\})></mjx-container> 的原因．</p><p data-original-document-end=5405 data-original-document-start=5359>利用类似的几何直观，可以将类欧几里得算法推广到斜率为无理数的情形，具体分析请参考后文的例题．</p><h3 data-original-document-end=5413 data-original-document-start=5407 id=例题>例题<a title="Permanent link" class=headerlink href=#例题></a></h3><details class=example data-original-document-end=5510 data-original-document-start=5415 open><summary><a href=https://www.luogu.com.cn/problem/P5170 target=_blank>【模板】类欧几里得算法</a></summary> <p>多组询问．给定正整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b,c,n><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b,c,n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b,c,n></mjx-container>，求</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2 .
\end{aligned}" style=min-width:12.655em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.771em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^2" space=2><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor"><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.097em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2 .\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mi data-latex=i>i</mi><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^2"><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note data-original-document-end=8450 data-original-document-start=5795><summary>解答一</summary> <p>类似于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 的推导，可以得到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g,h><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g,h xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=,>,</mo><mi data-latex=h>h</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g,h></mjx-container> 的递归表达式．</p> <p>首先，利用取模，将问题转化为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="0\le a,b<c" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="0\le a,b<c" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn><mo data-latex=\le>≤</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="0\le a,b<c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
g(a,b,c,n)
&=g(a\bmod c,b\bmod c,c,n)+\left\lfloor\frac{a}{c}\right\rfloor\frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor\frac{n(n+1)}{2}, \\
h(a,b,c,n)&=h(a\bmod c,b\bmod c,c,n)\\
&\quad+2\left\lfloor\frac{b}{c}\right\rfloor f(a\bmod c,b\bmod c,c,n)
+2\left\lfloor\frac{a}{c}\right\rfloor g(a\bmod c,b\bmod c,c,n)\\
&\quad+\left\lfloor\frac{a}{c}\right\rfloor^2\frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor^2(n+1)
+\left\lfloor\frac{a}{c}\right\rfloor\left\lfloor\frac{b}{c}\right\rfloor n(n+1).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c,c,n)\\
&\quad+\left\lfloor\frac{a}{c}\right\rfloor^2 \frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor^2 (n+1)
+\left\lfloor\frac{a}{c}\right\rfloor\left\lfloor\frac{b}{c}\right\rfloor n(n+1).
\end{aligned}' style=min-width:35.294em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.256em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=g space=4><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mfrac data-latex=\frac{n(n+1)(2n+1)}{6} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=n(n+1)(2n+1)><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=6><mjx-c class=mjx-c36>6</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mfrac data-latex=\frac{n(n+1)}{2} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=n(n+1)><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=h space=4><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.17em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\quad style=width:1em></mjx-mspace><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mrow data-latex="\left\lfloor\frac{b}{c}\right\rfloor " space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mrow data-latex="\left\lfloor\frac{a}{c}\right\rfloor " space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=g space=2><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.368em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\quad style=width:1em></mjx-mspace><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=\left\lfloor\frac{a}{c}\right\rfloor^2><mjx-mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.877em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mfrac data-latex=\frac{n(n+1)(2n+1)}{6}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=n(n+1)(2n+1)><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=6><mjx-c class=mjx-c36>6</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=\left\lfloor\frac{b}{c}\right\rfloor^2 space=3><mjx-mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.097em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex="\left\lfloor\frac{b}{c}\right\rfloor " space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}g(a,b,c,n)&=g(a\bmod c,b\bmod c,c,n)+\left\lfloor\frac{a}{c}\right\rfloor\frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor\frac{n(n+1)}{2}, \\h(a,b,c,n)&=h(a\bmod c,b\bmod c,c,n)\\&\quad+2\left\lfloor\frac{b}{c}\right\rfloor f(a\bmod c,b\bmod c,c,n)+2\left\lfloor\frac{a}{c}\right\rfloor g(a\bmod c,b\bmod c,c,n)\\&\quad+\left\lfloor\frac{a}{c}\right\rfloor^2\frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor^2(n+1)+\left\lfloor\frac{a}{c}\right\rfloor\left\lfloor\frac{b}{c}\right\rfloor n(n+1).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c,c,n)\\&\quad+\left\lfloor\frac{a}{c}\right\rfloor^2 \frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor^2 (n+1)+\left\lfloor\frac{a}{c}\right\rfloor\left\lfloor\frac{b}{c}\right\rfloor n(n+1).\end{aligned}' columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mfrac data-latex=\frac{n(n+1)(2n+1)}{6}><mrow data-latex=n(n+1)(2n+1)><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow><mn data-latex=6>6</mn></mfrac><mo data-latex=+>+</mo><mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mfrac data-latex=\frac{n(n+1)}{2}><mrow data-latex=n(n+1)><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\quad width=1em></mspace><mo data-latex=+>+</mo><mn data-latex=2>2</mn><mrow data-latex="\left\lfloor\frac{b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mn data-latex=2>2</mn><mrow data-latex="\left\lfloor\frac{a}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\quad width=1em></mspace><mo data-latex=+>+</mo><msup data-latex=\left\lfloor\frac{a}{c}\right\rfloor^2><mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup><mfrac data-latex=\frac{n(n+1)(2n+1)}{6}><mrow data-latex=n(n+1)(2n+1)><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow><mn data-latex=6>6</mn></mfrac><mo data-latex=+>+</mo><msup data-latex=\left\lfloor\frac{b}{c}\right\rfloor^2><mrow data-latex=\left\lfloor\frac{b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mrow data-latex=\left\lfloor\frac{a}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mrow data-latex="\left\lfloor\frac{b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
g(a,b,c,n)
&=g(a\bmod c,b\bmod c,c,n)+\left\lfloor\frac{a}{c}\right\rfloor\frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor\frac{n(n+1)}{2}, \\
h(a,b,c,n)&=h(a\bmod c,b\bmod c,c,n)\\
&\quad+2\left\lfloor\frac{b}{c}\right\rfloor f(a\bmod c,b\bmod c,c,n)
+2\left\lfloor\frac{a}{c}\right\rfloor g(a\bmod c,b\bmod c,c,n)\\
&\quad+\left\lfloor\frac{a}{c}\right\rfloor^2\frac{n(n+1)(2n+1)}{6}+\left\lfloor\frac{b}{c}\right\rfloor^2(n+1)
+\left\lfloor\frac{a}{c}\right\rfloor\left\lfloor\frac{b}{c}\right\rfloor n(n+1).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>然后，利用交换求和次序，可以进一步转化．同样地，令</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
m = \left\lfloor \frac{an+b}{c} \right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor \frac{an+b}{c} \right\rfloor" space=4><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{an+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=an+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="m = \left\lfloor \frac{an+b}{c} \right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor \frac{an+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{an+b}{c}><mrow data-latex=an+b><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
m = \left\lfloor \frac{an+b}{c} \right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>那么，对于和式 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g></mjx-container>，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
g(a,b,c,n)&=\sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor\\
&=\sum_{i=0}^n \sum_{j=0}^{m-1}i
\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right] \\
&=\sum_{j=0}^{m-1}\sum_{i=0}^n i\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}\dfrac{1}{2}\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2\\
&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}f(c,c-b-1,a,m-1) - \dfrac{1}{2}h(c,c-b-1,a,m-1).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
g(a,b,c,n)&=\sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor\\
&=\sum_{i=0}^n \sum_{j=0}^{m-1}i
\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right] \\
&=\sum_{j=0}^{m-1}\sum_{i=0}^n i\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}\dfrac{1}{2}\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2 \\
&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}f(c,c-b-1,a,m-1) - \dfrac{1}{2}h(c,c-b-1,a,m-1).
\end{aligned}" style=min-width:36.126em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mrow data-latex="\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{ai+b}{c}\right\rfloor space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=4><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{i=0}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mrow data-latex="\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=">" space=4><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=4><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mfrac data-latex=\dfrac{1}{2} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mrow data-latex=\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=n space=3><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2 space=2><mjx-mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.097em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.028em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}g(a,b,c,n)&=\sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor\\&=\sum_{i=0}^n \sum_{j=0}^{m-1}i\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right] \\&=\sum_{j=0}^{m-1}\sum_{i=0}^n i\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\&=\sum_{j=0}^{m-1}\dfrac{1}{2}\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2\\&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}f(c,c-b-1,a,m-1) - \dfrac{1}{2}h(c,c-b-1,a,m-1).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}g(a,b,c,n)&=\sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor\\&=\sum_{i=0}^n \sum_{j=0}^{m-1}i\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right] \\&=\sum_{j=0}^{m-1}\sum_{i=0}^n i\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\&=\sum_{j=0}^{m-1}\dfrac{1}{2}\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2 \\&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}f(c,c-b-1,a,m-1) - \dfrac{1}{2}h(c,c-b-1,a,m-1).\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mi data-latex=i>i</mi><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mi data-latex=i>i</mi><mrow data-latex="\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=j>j</mi><mo data-latex="<">&lt;</mo><mrow data-latex=\left\lfloor\frac{ai+b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mi data-latex=i>i</mi><mrow data-latex="\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=i>i</mi><mo data-latex=">">></mo><mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mrow data-latex=\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mi data-latex=m>m</mi><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=->−</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><msup data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2><mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mi data-latex=m>m</mi><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
g(a,b,c,n)&=\sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor\\
&=\sum_{i=0}^n \sum_{j=0}^{m-1}i
\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right] \\
&=\sum_{j=0}^{m-1}\sum_{i=0}^n i\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}\dfrac{1}{2}\left(\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor+n+1\right)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - \dfrac{1}{2}\sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor^2\\
&=\dfrac{1}{2}mn(n+1) - \dfrac{1}{2}f(c,c-b-1,a,m-1) - \dfrac{1}{2}h(c,c-b-1,a,m-1).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>对于和式 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h></mjx-container>，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
h(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2\\
&=\sum_{i=0}^n\sum_{j=0}^{m-1}(2j+1)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]\\
&=\sum_{j=0}^{m-1}\sum_{i=0}^n(2j+1)\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}(2j+1)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=nm^2 - \sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - 2\sum_{j=0}^{m-1}j\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\\
&=nm^2 - f(c,c-b-1,a,m-1) - 2g(c,c-b-1,a,m-1).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
h(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2 \\
&=\sum_{i=0}^n\sum_{j=0}^{m-1}(2j+1)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]\\
&=\sum_{j=0}^{m-1}\sum_{i=0}^n(2j+1)\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}(2j+1)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=nm^2  - \sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - 2\sum_{j=0}^{m-1}j\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\\
&=nm^2  - f(c,c-b-1,a,m-1) - 2g(c,c-b-1,a,m-1).
\end{aligned}" style=min-width:31.142em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.771em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^2" space=2><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor"><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.097em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mrow data-latex="\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{ai+b}{c}\right\rfloor space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=4><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{i=0}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mrow data-latex="\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=">" space=4><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=4><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mrow data-latex=\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:3.054em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=m^2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=3><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{cj+c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj+c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=m^2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}h(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2\\&=\sum_{i=0}^n\sum_{j=0}^{m-1}(2j+1)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]\\&=\sum_{j=0}^{m-1}\sum_{i=0}^n(2j+1)\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\&=\sum_{j=0}^{m-1}(2j+1)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\&=nm^2 - \sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - 2\sum_{j=0}^{m-1}j\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\\&=nm^2 - f(c,c-b-1,a,m-1) - 2g(c,c-b-1,a,m-1).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}h(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2 \\&=\sum_{i=0}^n\sum_{j=0}^{m-1}(2j+1)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]\\&=\sum_{j=0}^{m-1}\sum_{i=0}^n(2j+1)\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\&=\sum_{j=0}^{m-1}(2j+1)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\&=nm^2  - \sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - 2\sum_{j=0}^{m-1}j\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\\&=nm^2  - f(c,c-b-1,a,m-1) - 2g(c,c-b-1,a,m-1).\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^2"><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-latex="\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=j>j</mi><mo data-latex="<">&lt;</mo><mrow data-latex=\left\lfloor\frac{ai+b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-latex="\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=i>i</mi><mo data-latex=">">></mo><mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-latex=\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><msup data-latex=m^2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mrow data-latex="\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=->−</mo><mn data-latex=2>2</mn><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><mi data-latex=j>j</mi><mrow data-latex=\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{cj+c-b-1}{a}><mrow data-latex=cj+c-b-1><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><msup data-latex=m^2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mn data-latex=2>2</mn><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
h(a,b,c,n)&=\sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2\\
&=\sum_{i=0}^n\sum_{j=0}^{m-1}(2j+1)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]\\
&=\sum_{j=0}^{m-1}\sum_{i=0}^n(2j+1)\left[i>\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor \right]\\
&=\sum_{j=0}^{m-1}(2j+1)\left(n-\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\right)\\
&=nm^2 - \sum_{j=0}^{m-1}\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor - 2\sum_{j=0}^{m-1}j\left\lfloor\frac{cj+c-b-1}{a}\right\rfloor\\
&=nm^2 - f(c,c-b-1,a,m-1) - 2g(c,c-b-1,a,m-1).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>从几何直观的角度看，这些非线性的求和式相当于给区域中的每个点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(i,j)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(i,j)></mjx-container> 都赋予了相应的权重 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=w(i,j)><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=w(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=w(i,j)></mjx-container>．除了这些权重之外，其余部分的计算过程是完全一致的．对于权重的选择，一般地，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{i=0}^ni^r\left\lfloor \frac{ai+b}{c} \right\rfloor^s = \sum_{i=0}^n\sum_{j=0}^{m-1} i^r\left((j+1)^s-j^s\right)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right].
" aria-hidden=true class=NCM-N display=true><mjx-munderover data-latex="\sum_{i=0}^n"><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex=i^r space=2><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^s"><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor"><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.097em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{j=0}^{m-1}" space=2><mjx-over style=padding-bottom:.141em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style=padding-left:.04em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.165em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex=i^r space=2><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mrow data-latex=\left((j+1)^s-j^s\right) space=2><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^s><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=j^s space=3><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex="\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]" space=2><mjx-mo data-latex=\left[><mjx-c class="mjx-c5B NCM-S5">[</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\frac{ai+b}{c}\right\rfloor space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right]><mjx-c class="mjx-c5D NCM-S5">]</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{i=0}^ni^r\left\lfloor \frac{ai+b}{c} \right\rfloor^s = \sum_{i=0}^n\sum_{j=0}^{m-1} i^r\left((j+1)^s-j^s\right)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]." display=block xmlns=http://www.w3.org/1998/Math/MathML><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><msup data-latex=i^r><mi data-latex=i>i</mi><mi data-latex=r>r</mi></msup><msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^s"><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=s>s</mi></msup><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><munderover data-latex="\sum_{j=0}^{m-1}"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></munderover><msup data-latex=i^r><mi data-latex=i>i</mi><mi data-latex=r>r</mi></msup><mrow data-latex=\left((j+1)^s-j^s\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><msup data-latex=)^s><mo data-latex=) stretchy=false>)</mo><mi data-latex=s>s</mi></msup><mo data-latex=->−</mo><msup data-latex=j^s><mi data-latex=j>j</mi><mi data-latex=s>s</mi></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex="\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right]" data-mjx-texclass=INNER><mo data-latex=\left[ data-mjx-texclass=OPEN>[</mo><mi data-latex=j>j</mi><mo data-latex="<">&lt;</mo><mrow data-latex=\left\lfloor\frac{ai+b}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right] data-mjx-texclass=CLOSE>]</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{i=0}^ni^r\left\lfloor \frac{ai+b}{c} \right\rfloor^s = \sum_{i=0}^n\sum_{j=0}^{m-1} i^r\left((j+1)^s-j^s\right)\left[j<\left\lfloor\frac{ai+b}{c}\right\rfloor\right].
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>本题的另一个特点是，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h></mjx-container> 在递归计算时，会相互交错．因此，需要将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(f,g,h)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=g space=2><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(f,g,h) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=,>,</mo><mi data-latex=g>g</mi><mo data-latex=,>,</mo><mi data-latex=h>h</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(f,g,h)></mjx-container> 作为三元组同时递归．</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=k>struct</span><span class=w> </span><span class=nc>Data</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>f</span><span class=p>,</span><span class=w> </span><span class=n>g</span><span class=p>,</span><span class=w> </span><span class=n>h</span><span class=p>;</span>
<span class=p>};</span>

<span class=n>Data</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>998244353</span><span class=p>;</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>i2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>M</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>i6</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>M</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>6</span><span class=p>;</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>i2</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>i6</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=n>Data</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>};</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>aa</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>aa</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>))</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>g</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>aa</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n3</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n2</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>tmp</span><span class=p>.</span><span class=n>h</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>aa</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>g</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>+</span>
<span class=w>             </span><span class=n>aa</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>aa</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n3</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>+</span>
<span class=w>             </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>aa</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>bb</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n2</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>)</span><span class=w> </span><span class=o>%</span>
<span class=w>            </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=n>res</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>M</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=n>res</span><span class=p>.</span><span class=n>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>M</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>f</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>i2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>M</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>h</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>i2</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=n>res</span><span class=p>.</span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tmp</span><span class=p>.</span><span class=n>g</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>M</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>f</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>' '</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>h</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>' '</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>g</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><details class=example data-original-document-end=8553 data-original-document-start=8452 open><summary><a href=https://www.luogu.com.cn/problem/P5172 target=_blank>[清华集训 2014] Sum</a></summary> <p>多组询问．给定正整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container>，求</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor}.
" aria-hidden=true class=NCM-N display=true><mjx-munderover data-latex="\sum_{d=1}^n"><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=")^{\lfloor d\sqrt{r}\rfloor}"><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{\lfloor d\sqrt{r}\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor}." display=block xmlns=http://www.w3.org/1998/Math/MathML><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=")^{\lfloor d\sqrt{r}\rfloor}"><mo data-latex=) stretchy=false>)</mo><mrow data-latex="{\lfloor d\sqrt{r}\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note data-original-document-end=10919 data-original-document-start=8748><summary>解答一</summary> <p>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 是完全平方数，那么当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\sqrt{r}><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\sqrt{r} xmlns=http://www.w3.org/1998/Math/MathML><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\sqrt{r}></mjx-container> 为偶数时，和式为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container>；否则，和式依据 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 奇偶性不同，在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-1><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-1></mjx-container> 之间交替变化．下面考虑 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 不是完全平方数的情形．</p> <p>为了应用类欧几里得算法，首先将求和式转化为熟悉的形式：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor} &= \sum_{d=1}^n\left(1 - 2(\lfloor d\sqrt{r}\rfloor\bmod 2)\right)\\
&= n - 2\sum_{d=1}^n\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right) \\
&= n - 2\sum_{d=1}^n\lfloor d\sqrt{r}\rfloor + 4 \sum_{d=1}^n\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor\\
&= n - 2f(n,1,0,1) + 4f(n,1,0,2)
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2)\right)\\
&= n - 2\sum_{d=1}^n\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right) \\
&= n - 2\sum_{d=1}^n\lfloor d\sqrt{r}\rfloor + 4 \sum_{d=1}^n\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor\\
&= n - 2f(n,1,0,1) + 4f(n,1,0,2)
\end{aligned}' style=min-width:21.325em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.778em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-munderover data-latex="\sum_{d=1}^n"><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=")^{\lfloor d\sqrt{r}\rfloor}"><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{\lfloor d\sqrt{r}\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{d=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.329em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.778em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munderover data-latex="\sum_{d=1}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right)" space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S6">(</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.329em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mrow data-latex="\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor" space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{\lfloor d\sqrt{r}\rfloor}{2}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="\lfloor d\sqrt{r}\rfloor"><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S6">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.778em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munderover data-latex="\sum_{d=1}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.329em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=4 space=3><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-munderover data-latex="\sum_{d=1}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{d\sqrt{r}}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=d\sqrt{r}><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=4 space=3><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor} &= \sum_{d=1}^n\left(1 - 2(\lfloor d\sqrt{r}\rfloor\bmod 2)\right)\\&= n - 2\sum_{d=1}^n\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right) \\&= n - 2\sum_{d=1}^n\lfloor d\sqrt{r}\rfloor + 4 \sum_{d=1}^n\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor\\&= n - 2f(n,1,0,1) + 4f(n,1,0,2)\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2)\right)\\&= n - 2\sum_{d=1}^n\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right) \\&= n - 2\sum_{d=1}^n\lfloor d\sqrt{r}\rfloor + 4 \sum_{d=1}^n\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor\\&= n - 2f(n,1,0,1) + 4f(n,1,0,2)\end{aligned}' columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=")^{\lfloor d\sqrt{r}\rfloor}"><mo data-latex=) stretchy=false>)</mo><mrow data-latex="{\lfloor d\sqrt{r}\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex=\left data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=( stretchy=false>(</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mn data-latex=2>2</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=->−</mo><mn data-latex=2>2</mn><mrow data-latex="\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor" data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\dfrac{\lfloor d\sqrt{r}\rfloor}{2}"><mrow data-latex="\lfloor d\sqrt{r}\rfloor"><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mn data-latex=4>4</mn><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex=\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{d\sqrt{r}}{2}><mrow data-latex=d\sqrt{r}><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mn data-latex=4>4</mn><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=2>2</mn><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor} &= \sum_{d=1}^n\left(1 - 2(\lfloor d\sqrt{r}\rfloor\bmod 2)\right)\\
&= n - 2\sum_{d=1}^n\left(\lfloor d\sqrt{r}\rfloor - 2\left\lfloor\dfrac{\lfloor d\sqrt{r}\rfloor}{2}\right\rfloor\right) \\
&= n - 2\sum_{d=1}^n\lfloor d\sqrt{r}\rfloor + 4 \sum_{d=1}^n\left\lfloor\dfrac{d\sqrt{r}}{2}\right\rfloor\\
&= n - 2f(n,1,0,1) + 4f(n,1,0,2)
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>其中的函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 具有形式</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(a,b,c,n) = \sum_{i=1}^n\left\lfloor\dfrac{a\sqrt{r}+b}{c}i\right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{a\sqrt{r}+b}{c}i\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a\sqrt{r}+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=a\sqrt{r}+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(a,b,c,n) = \sum_{i=1}^n\left\lfloor\dfrac{a\sqrt{r}+b}{c}i\right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex=\left\lfloor\dfrac{a\sqrt{r}+b}{c}i\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a\sqrt{r}+b}{c}><mrow data-latex=a\sqrt{r}+b><mi data-latex=a>a</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mi data-latex=i>i</mi><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(a,b,c,n) = \sum_{i=1}^n\left\lfloor\dfrac{a\sqrt{r}+b}{c}i\right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>与正文中的算法不同的是，此处的斜率不再是有理数．设斜率</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
k = \dfrac{a\sqrt{r}+b}{c}.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a\sqrt{r}+b}{c} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=a\sqrt{r}+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="k = \dfrac{a\sqrt{r}+b}{c}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{a\sqrt{r}+b}{c}><mrow data-latex=a\sqrt{r}+b><mi data-latex=a>a</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
k = \dfrac{a\sqrt{r}+b}{c}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>同样分为两种情形讨论．如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k\ge 1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k\ge 1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex=\ge>≥</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="k\ge 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n \lfloor(k-\lfloor k\rfloor)i\rfloor + \lfloor k\rfloor \sum_{i=1}^ni\\
&= \lfloor k\rfloor\dfrac{n(n+1)}{2} + f(a,b-c\lfloor k\rfloor,c,n).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n \lfloor(k-\lfloor k\rfloor)i\rfloor + \lfloor k\rfloor \sum_{i=1}^ni\\
&= \lfloor k\rfloor\dfrac{n(n+1)}{2} + f(a,b-c\lfloor k\rfloor,c,n).
\end{aligned}" style=min-width:21.881em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.758em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.142em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{n(n+1)}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=n(n+1)><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n \lfloor(k-\lfloor k\rfloor)i\rfloor + \lfloor k\rfloor \sum_{i=1}^ni\\&= \lfloor k\rfloor\dfrac{n(n+1)}{2} + f(a,b-c\lfloor k\rfloor,c,n).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n \lfloor(k-\lfloor k\rfloor)i\rfloor + \lfloor k\rfloor \sum_{i=1}^ni\\&= \lfloor k\rfloor\dfrac{n(n+1)}{2} + f(a,b-c\lfloor k\rfloor,c,n).\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mi data-latex=i>i</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=) stretchy=false>)</mo><mi data-latex=i>i</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mi data-latex=i>i</mi></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mfrac data-latex=\dfrac{n(n+1)}{2}><mrow data-latex=n(n+1)><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=+>+</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mi data-latex=c>c</mi><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n \lfloor(k-\lfloor k\rfloor)i\rfloor + \lfloor k\rfloor \sum_{i=1}^ni\\
&= \lfloor k\rfloor\dfrac{n(n+1)}{2} + f(a,b-c\lfloor k\rfloor,c,n).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>问题转化为斜率小于一的情形．如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k<1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k<1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex="<">&lt;</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="k<1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=\lfloor nk\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=\lfloor nk\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=n>n</mi><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="m=\lfloor nk\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n\sum_{j=1}^m[j\le\lfloor ki\rfloor]\\
&= \sum_{j=1}^m\sum_{i=1}^n[i>\lfloor k^{-1}j\rfloor] = nm - \sum_{j=1}^m\sum_{i=1}^n[i\le\lfloor k^{-1}j\rfloor].
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n\sum_{j=1}^m[j\le\lfloor ki\rfloor]\\
&= \sum_{j=1}^m\sum_{i=1}^n[i>\lfloor k^{-1}j\rfloor] = nm - \sum_{j=1}^m\sum_{i=1}^n[i\le\lfloor k^{-1}j\rfloor].
\end{aligned}" style=min-width:26.494em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.895em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{j=1}^m" space=2><mjx-over style=padding-bottom:.192em;padding-left:.412em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.124em><mjx-texatom data-latex="{j=1}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.895em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=1}^m" space=4><mjx-over style=padding-bottom:.192em;padding-left:.412em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.124em><mjx-texatom data-latex="{j=1}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{i=1}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=">" space=4><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup data-latex=k^{-1}><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{j=1}^m" space=3><mjx-over style=padding-bottom:.192em;padding-left:.412em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.124em><mjx-texatom data-latex="{j=1}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{i=1}^n" space=2><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup data-latex=k^{-1}><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n\sum_{j=1}^m[j\le\lfloor ki\rfloor]\\&= \sum_{j=1}^m\sum_{i=1}^n[i>\lfloor k^{-1}j\rfloor] = nm - \sum_{j=1}^m\sum_{i=1}^n[i\le\lfloor k^{-1}j\rfloor].\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n\sum_{j=1}^m[j\le\lfloor ki\rfloor]\\&= \sum_{j=1}^m\sum_{i=1}^n[i>\lfloor k^{-1}j\rfloor] = nm - \sum_{j=1}^m\sum_{i=1}^n[i\le\lfloor k^{-1}j\rfloor].\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mi data-latex=i>i</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><munderover data-latex="\sum_{j=1}^m"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=1}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=m>m</mi></munderover><mo data-latex=[ stretchy=false>[</mo><mi data-latex=j>j</mi><mo data-latex=\le>≤</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mi data-latex=i>i</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=] stretchy=false>]</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{j=1}^m"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=1}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=m>m</mi></munderover><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=[ stretchy=false>[</mo><mi data-latex=i>i</mi><mo data-latex=">">></mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup data-latex=k^{-1}><mi data-latex=k>k</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mi data-latex=j>j</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=] stretchy=false>]</mo><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><munderover data-latex="\sum_{j=1}^m"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=1}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=m>m</mi></munderover><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=[ stretchy=false>[</mo><mi data-latex=i>i</mi><mo data-latex=\le>≤</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup data-latex=k^{-1}><mi data-latex=k>k</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mi data-latex=j>j</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=] stretchy=false>]</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=1}^n \lfloor ki\rfloor = \sum_{i=1}^n\sum_{j=1}^m[j\le\lfloor ki\rfloor]\\
&= \sum_{j=1}^m\sum_{i=1}^n[i>\lfloor k^{-1}j\rfloor] = nm - \sum_{j=1}^m\sum_{i=1}^n[i\le\lfloor k^{-1}j\rfloor].
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>此处的推导中，交换 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 的条件比正文中的情形更为简单，是因为直线 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y=kx" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=k space=4><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y=kx" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mi data-latex=k>k</mi><mi data-latex=x>x</mi></math></mjx-assistive-mml><img title="y=kx" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 上没有除了原点之外的格点．关键在于交换后的求和式写成 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,b,c,n)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,b,c,n)></mjx-container> 的形式，这相当于要求 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a',b',c'" aria-hidden=true class=NCM-N><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a',b',c'" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=b>b</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="a',b',c'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 满足</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
k^{-1} = \dfrac{a'\sqrt{r}+b'}{c'}.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=k^{-1}><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{a'\sqrt{r}+b'}{c'}" space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="a'\sqrt{r}+b'"><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msup data-latex="c'"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="k^{-1} = \dfrac{a'\sqrt{r}+b'}{c'}." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=k^{-1}><mi data-latex=k>k</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex="=">=</mo><mfrac data-latex="\dfrac{a'\sqrt{r}+b'}{c'}"><mrow data-latex="a'\sqrt{r}+b'"><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=+>+</mo><msup><mi data-latex=b>b</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></mrow><msup data-latex="c'"><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></mfrac><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
k^{-1} = \dfrac{a'\sqrt{r}+b'}{c'}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这并不困难，只需要将分母有理化，就能得到</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
k^{-1} = \dfrac{c}{a\sqrt{r}+b} = \dfrac{ca\sqrt{r}-cb}{a^2r-b^2}.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=k^{-1}><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c}{a\sqrt{r}+b} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=a\sqrt{r}+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{ca\sqrt{r}-cb}{a^2r-b^2} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ca\sqrt{r}-cb><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=c space=3><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="a^2 r-b^2"><mjx-msup data-latex=a^2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=b^2 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="k^{-1} = \dfrac{c}{a\sqrt{r}+b} = \dfrac{ca\sqrt{r}-cb}{a^2r-b^2}." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=k^{-1}><mi data-latex=k>k</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{c}{a\sqrt{r}+b}><mi data-latex=c>c</mi><mrow data-latex=a\sqrt{r}+b><mi data-latex=a>a</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow></mfrac><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{ca\sqrt{r}-cb}{a^2r-b^2}><mrow data-latex=ca\sqrt{r}-cb><mi data-latex=c>c</mi><mi data-latex=a>a</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=->−</mo><mi data-latex=c>c</mi><mi data-latex=b>b</mi></mrow><mrow data-latex="a^2 r-b^2"><msup data-latex=a^2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msup><mi data-latex=r>r</mi><mo data-latex=->−</mo><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup></mrow></mfrac><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
k^{-1} = \dfrac{c}{a\sqrt{r}+b} = \dfrac{ca\sqrt{r}-cb}{a^2r-b^2}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
a'=ca,~b'=-cb,~c'=a^2r-b^2.
" aria-hidden=true class=NCM-N display=true><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-msup><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-msup><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=a^2 space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=b^2 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="a'=ca,~b'=-cb,~c'=a^2r-b^2." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mi data-latex=c>c</mi><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><msup><mi data-latex=b>b</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mo data-latex=->−</mo><mi data-latex=c>c</mi><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><msup><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><msup data-latex=a^2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msup><mi data-latex=r>r</mi><mo data-latex=->−</mo><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
a'=ca,~b'=-cb,~c'=a^2r-b^2.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这说明</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(a,b,c,n) = nm - f(ca,-cb,a^2r-b^2,m).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=- space=2><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=a^2 space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=b^2 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(a,b,c,n) = nm - f(ca,-cb,a^2r-b^2,m)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mo data-latex=->−</mo><mi data-latex=c>c</mi><mi data-latex=b>b</mi><mo data-latex=,>,</mo><msup data-latex=a^2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msup><mi data-latex=r>r</mi><mo data-latex=->−</mo><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(a,b,c,n) = nm - f(ca,-cb,a^2r-b^2,m).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>为了避免整数溢出，需要每次都将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b,c><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b,c xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b,c></mjx-container> 同除以它们的最大公约数．因为这个计算过程和计算 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 的连分数的过程完全一致，所以根据 <a href=../continued-fraction/#二次无理数>连分数理论</a>，只要保证 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\gcd(a,b,c)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\gcd><mjx-c class=mjx-c67 noic=true style=padding-top:.694em>g</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\gcd(a,b,c)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\gcd data-mjx-texclass=OP movablelimits=true>gcd</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="\gcd(a,b,c)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，它们在计算过程中必然在整型范围内．另外，尽管 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,b,c,n)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,b,c,n)></mjx-container> 不会溢出，但是在该题数据范围下，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,b,c,n)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,b,c,n)></mjx-container> 可能会超过 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=64><mjx-mn data-latex=64><mjx-c class=mjx-c36 noic=true style=padding-top:.677em>6</mjx-c><mjx-c class=mjx-c34 style=padding-top:.677em>4</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=64 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=64>64</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=64></mjx-container> 位整数的范围，自然溢出即可，无需额外处理，最后结果一定在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=[-n,n]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[-n,n] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mo data-latex=->−</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[-n,n]></mjx-container> 之间．</p> <p>尽管斜率不会变为零，算法的复杂度仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log n)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log n)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的，这一点从前文关于算法复杂度的论证容易看出．</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cmath></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>r</span><span class=p>;</span>
<span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>sqrt_r</span><span class=p>;</span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>gcd</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=n>gcd</span><span class=p>(</span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=p>;</span><span class=w> </span><span class=p>}</span>

<span class=kt>unsigned</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>f</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>gcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>gcd</span><span class=p>(</span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>));</span>
<span class=w>  </span><span class=n>a</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=n>d</span><span class=p>;</span>
<span class=w>  </span><span class=n>b</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=n>d</span><span class=p>;</span>
<span class=w>  </span><span class=n>c</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=n>d</span><span class=p>;</span>
<span class=w>  </span><span class=kt>unsigned</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt_r</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>unsigned</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt_r</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=n>c</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>unsigned</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>sqr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sqrt_r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sqrtl</span><span class=p>(</span><span class=n>r</span><span class=p>);</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>sqr</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqr</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>-1</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>r</span><span class=p>;</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>);</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><details class=example data-original-document-end=11059 data-original-document-start=10921 open><summary><a href=https://www.luogu.com.cn/problem/P5179 target=_blank>Fraction</a></summary> <p>给定正整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b,c,d><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=d space=2><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b,c,d xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=d>d</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b,c,d></mjx-container>，求所有满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a/b<p/q<c/d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a/b<p/q<c/d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi><mo data-latex="<">&lt;</mo><mi data-latex=c>c</mi><mo data-latex=/>/</mo><mi data-latex=d>d</mi></math></mjx-assistive-mml><img title="a/b<p/q<c/d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的最简分数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p/q><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p/q></mjx-container> 中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(q,p)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(q,p) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(q,p)></mjx-container> 的字典序最小的那个．</p></details><details class=note data-original-document-end=12121 data-original-document-start=11061><summary>解答</summary> <p>这道题目也是 <a href=../stern-brocot/>Stern–Brocot 树</a> 的经典应用，相关题解可以在 <a href=../continued-fraction/#连分数的树>此处</a> 找到．因为它只依赖于分数的递归结构，所以它同样可以利用类似欧几里得算法的方法求解，故而也可以视作类欧几里得算法的一个应用．</p> <p>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a/b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a/b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a/b></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=c/d><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=c/d xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=c>c</mi><mo data-latex=/>/</mo><mi data-latex=d>d</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=c/d></mjx-container> 之间（不含端点）存在至少一个自然数，可以直接取 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(q,p)=(1,\lfloor a/b\rfloor+1)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=2><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(q,p)=(1,\lfloor a/b\rfloor+1)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=b>b</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(q,p)=(1,\lfloor a/b\rfloor+1)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．否则，必然有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left\lfloor\dfrac{a}{b}\right\rfloor \le \dfrac{a}{b} <\dfrac{p}{q} <\dfrac{c}{d}\le\left\lfloor\dfrac{a}{b}\right\rfloor+1.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex="\left\lfloor\dfrac{a}{b}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{b}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{b} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{p}{q} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c}{d} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{a}{b}\right\rfloor space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{b}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1. space=3><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left\lfloor\dfrac{a}{b}\right\rfloor \le \dfrac{a}{b} <\dfrac{p}{q} <\dfrac{c}{d}\le\left\lfloor\dfrac{a}{b}\right\rfloor+1." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\left\lfloor\dfrac{a}{b}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{b}><mi data-latex=a>a</mi><mi data-latex=b>b</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\le>≤</mo><mfrac data-latex=\dfrac{a}{b}><mi data-latex=a>a</mi><mi data-latex=b>b</mi></mfrac><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{p}{q}><mi data-latex=p>p</mi><mi data-latex=q>q</mi></mfrac><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{c}{d}><mi data-latex=c>c</mi><mi data-latex=d>d</mi></mfrac><mo data-latex=\le>≤</mo><mrow data-latex=\left\lfloor\dfrac{a}{b}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{b}><mi data-latex=a>a</mi><mi data-latex=b>b</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mn data-latex=1.>1.</mn></math></mjx-assistive-mml><img title="
\left\lfloor\dfrac{a}{b}\right\rfloor \le \dfrac{a}{b} <\dfrac{p}{q} <\dfrac{c}{d}\le\left\lfloor\dfrac{a}{b}\right\rfloor+1.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>从这个不等式中可以看出，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p/q><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p/q></mjx-container> 的整数部分可以确定为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor a/b\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor a/b\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=b>b</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor a/b\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，直接消去该整数部分，然后整体取倒数，用于确定它的小数部分．这正是确定 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p/q><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p/q></mjx-container> 的连分数的 <a href=../continued-fraction/#连分数表示的求法>基本方法</a>．若最终的答案是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p/q><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p/q></mjx-container>，那么算法的时间复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{p,q\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=q space=2><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{p,q\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=p>p</mi><mo data-latex=,>,</mo><mi data-latex=q>q</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{p,q\})></mjx-container>．</p> <p>此处，有一个细节问题，即取倒数之后得到的字典序最小的分数，是否是取倒数之前的字典序最小的分数．换句话说，满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a/b<p/q<c/d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a/b<p/q<c/d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi><mo data-latex="<">&lt;</mo><mi data-latex=c>c</mi><mo data-latex=/>/</mo><mi data-latex=d>d</mi></math></mjx-assistive-mml><img title="a/b<p/q<c/d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的分数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p/q><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p/q></mjx-container> 中，字典序 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(q,p)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(q,p) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(q,p)></mjx-container> 最小的，是否也是字典序 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(p,q)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=q space=2><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(p,q) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=,>,</mo><mi data-latex=q>q</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(p,q)></mjx-container> 最小的．假设不然，设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p/q><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p/q></mjx-container> 是字典序 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(q,p)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(q,p) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(q,p)></mjx-container> 最小的，但是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="r/s\neq p/q" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\neq><mjx-c class=mjx-c2260>≠</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="r/s\neq p/q" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi><mo data-latex=/>/</mo><mi data-latex=s>s</mi><mo data-latex=\neq>≠</mo><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img title="r/s\neq p/q" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是字典序 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(r,s)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=s space=2><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(r,s) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=,>,</mo><mi data-latex=s>s</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(r,s)></mjx-container> 最小的．这必然有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="r<p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="r<p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="r<p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="q<s" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=s space=4><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="q<s" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=q>q</mi><mo data-latex="<">&lt;</mo><mi data-latex=s>s</mi></math></mjx-assistive-mml><img title="q<s" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．但是，这说明</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\dfrac{a}{b} < \dfrac{r}{s} < \dfrac{r}{q} < \dfrac{p}{q} < \dfrac{c}{d}.
" aria-hidden=true class=NCM-N display=true><mjx-mfrac data-latex=\dfrac{a}{b}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{r}{s} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{r}{q} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{p}{q} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c}{d} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\dfrac{a}{b} < \dfrac{r}{s} < \dfrac{r}{q} < \dfrac{p}{q} < \dfrac{c}{d}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mfrac data-latex=\dfrac{a}{b}><mi data-latex=a>a</mi><mi data-latex=b>b</mi></mfrac><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{r}{s}><mi data-latex=r>r</mi><mi data-latex=s>s</mi></mfrac><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{r}{q}><mi data-latex=r>r</mi><mi data-latex=q>q</mi></mfrac><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{p}{q}><mi data-latex=p>p</mi><mi data-latex=q>q</mi></mfrac><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{c}{d}><mi data-latex=c>c</mi><mi data-latex=d>d</mi></mfrac><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\dfrac{a}{b} < \dfrac{r}{s} < \dfrac{r}{q} < \dfrac{p}{q} < \dfrac{c}{d}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r/q><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r/q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi><mo data-latex=/>/</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r/q></mjx-container> 无论按照哪个字典序怎样都是严格更小于当前解的．这与所设条件矛盾．因此，上述算法是正确的．</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=kt>void</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&</span><span class=w> </span><span class=n>q</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>d</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>((</span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=n>q</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>solve</span><span class=p>(</span><span class=n>d</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>b</span><span class=p>),</span><span class=w> </span><span class=n>q</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>b</span><span class=p>);</span>
<span class=w>    </span><span class=n>p</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>b</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=n>q</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>d</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=n>q</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>);</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'/'</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><h2 data-original-document-end=12134 data-original-document-start=12123 id=万能欧几里得算法>万能欧几里得算法<a title="Permanent link" class=headerlink href=#万能欧几里得算法></a></h2><p data-original-document-end=12289 data-original-document-start=12136>上一节讨论的类欧几里得算法推导通常较为繁琐，而且能够解决的和式主要是可以转化为直线下（带权）整点计数问题的和式．本节讨论一种更为一般的方法，它进一步抽象了上述过程，从而可以解决更多的问题．因此，这一方法也称为万能欧几里得算法．它同样利用了分数的递归结构求解问题，但是与类欧几里得算法约化问题的思路稍有不同．</p><p data-original-document-end=12304 data-original-document-start=12291>仍然考虑最经典的求和问题：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(a,b,c,n)=\sum_{i=1}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(a,b,c,n)=\sum_{i=1}^n\left\lfloor \frac{ai+b}{c} \right\rfloor," display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
f(a,b,c,n)=\sum_{i=1}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p>其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b,c,n><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b,c,n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b,c,n></mjx-container> 都是正整数．</p><h3 data-original-document-end=12408 data-original-document-start=12400 id=问题转化>问题转化<a title="Permanent link" class=headerlink href=#问题转化></a></h3><p data-original-document-end=12431 data-original-document-start=12410>设参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,b,c,n)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,b,c,n)></mjx-container> 的线段为</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
y = \frac{ax+b}{c},~0< x\le n.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ax+b}{c} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ax+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="y = \frac{ax+b}{c},~0< x\le n." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mfrac data-latex=\frac{ax+b}{c}><mrow data-latex=ax+b><mi data-latex=a>a</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mn data-latex=0>0</mn><mo data-latex="<">&lt;</mo><mi data-latex=x>x</mi><mo data-latex=\le>≤</mo><mi data-latex=n>n</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
y = \frac{ax+b}{c},~0< x\le n.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=12526 data-original-document-start=12471>对于这条线段，可以按照如下方法定义一个由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 组成的字符串 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container>，也称为 <strong>操作序列</strong>：</p><ul data-original-document-end=12661 data-original-document-start=12528><li>字符串恰有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=\lfloor(an+b)/c\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=\lfloor(an+b)/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="m=\lfloor(an+b)/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 组成；</li><li>第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 前方的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 的数量恰等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\lfloor(ai+b)/c\rfloor><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lfloor(ai+b)/c\rfloor xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lfloor(ai+b)/c\rfloor></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,\cdots,n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,\cdots,n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="i=1,\cdots,n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</li></ul><p data-original-document-end=12737 data-original-document-start=12663>从几何直观上看，这大致相当于从原点开始，每向右穿过一次竖向的网格线，就写下一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>，每向上穿过一次横向的网格线，就写下一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>．如下图所示：</p><p data-original-document-end=12776 data-original-document-start=12739><img alt src=../images/euclidean-universal.svg></p><p data-original-document-end=12799 data-original-document-start=12778>当然，这样的定义还需要考量一系列特殊情形：</p><ul data-original-document-end=12932 data-original-document-start=12801><li>经过整点（即同时上穿和右穿）时，需要先写 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 再写 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>；</li><li>字符串开始时，除了在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(0,1]><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(0,1] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(0,1]></mjx-container> 区间内上穿网格线的次数外，还需要格外补充 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor b/c\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor b/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor b/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>；</li><li>字符串结束时，不能有格外的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>．</li></ul><p data-original-document-end=12994 data-original-document-start=12934>如果对于几何直观的描述有任何不明晰的地方，可以参考上述代数方法的定义辅助理解．几何直观的描述，有助于理解下文的算法过程．</p><p data-original-document-end=13105 data-original-document-start=12996>万能欧几里得算法的基本思路，就是将操作序列中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 都视作某个 <a href=../../algebra/basic/#群>幺半群</a> 内的元素，将整个操作序列视为幺半群内元素的乘积，而问题最终的答案与这个乘积有关．</p><p data-original-document-end=13261 data-original-document-start=13107>比如，本题中，可以定义状态向量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v = (1,y,\sum y)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v = (1,y,\sum y)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="v = (1,y,\sum y)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，表示自原点开始，经历了若干次上穿和右穿网格线后，当前的状态．其中，第一个分量是常数，第二个分量是纵坐标 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container>，第三个分量是要求的和式．起始时，有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v=(1,0,0)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v=(1,0,0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="v=(1,0,0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．每向上穿过一次网格线，纵坐标就累加一，即相当于将状态向量右乘以矩阵</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
U = \begin{pmatrix}1 & 1 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1\end{pmatrix}.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={pmatrix} space=4><mjx-mo><mjx-stretchy-v class=mjx-c28 style=vertical-align:-1.65em;height:3.8em><mjx-beg>⎛</mjx-beg><mjx-ext><mjx-spacer>⎜ ⎜ ⎜</mjx-spacer></mjx-ext><mjx-end>⎝</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=min-width:3.5em><mjx-table><mjx-itable><mjx-mtr style=height:.688em><mjx-mtd style=padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo><mjx-stretchy-v class=mjx-c29 style=vertical-align:-1.65em;height:3.8em><mjx-beg>⎞</mjx-beg><mjx-ext><mjx-spacer>⎟ ⎟ ⎟</mjx-spacer></mjx-ext><mjx-end>⎠</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="U = \begin{pmatrix}1 & 1 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1\end{pmatrix}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi><mo data-latex="=">=</mo><mrow data-latex={pmatrix} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>(</mo><mtable columnspacing=1em rowspacing=4pt><mtr><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
U = \begin{pmatrix}1 & 1 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1\end{pmatrix}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=13375 data-original-document-start=13339>每向右穿过一次网格线，和式就累加一次纵坐标，即相当于将状态向量右乘以矩阵</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
R = \begin{pmatrix}1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1\end{pmatrix}.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={pmatrix} space=4><mjx-mo><mjx-stretchy-v class=mjx-c28 style=vertical-align:-1.65em;height:3.8em><mjx-beg>⎛</mjx-beg><mjx-ext><mjx-spacer>⎜ ⎜ ⎜</mjx-spacer></mjx-ext><mjx-end>⎝</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=min-width:3.5em><mjx-table><mjx-itable><mjx-mtr style=height:.688em><mjx-mtd style=padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo><mjx-stretchy-v class=mjx-c29 style=vertical-align:-1.65em;height:3.8em><mjx-beg>⎞</mjx-beg><mjx-ext><mjx-spacer>⎟ ⎟ ⎟</mjx-spacer></mjx-ext><mjx-end>⎠</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="R = \begin{pmatrix}1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1\end{pmatrix}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi><mo data-latex="=">=</mo><mrow data-latex={pmatrix} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>(</mo><mtable columnspacing=1em rowspacing=4pt><mtr><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=1>1</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
R = \begin{pmatrix}1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1\end{pmatrix}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=13514 data-original-document-start=13453>因此，最终的状态就是乘积 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(1,0,0)S><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(1,0,0)S xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(1,0,0)S></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 理解为上述矩阵的乘积．所求的答案，就是最终状态的第三个分量．</p><p data-original-document-end=13583 data-original-document-start=13516>除了将幺半群中的元素定义为矩阵以外，还可以将它们定义为一段操作序列对于最终结果的贡献，然后将操作的乘积定义为两段操作序列的贡献的合并．</p><p data-original-document-end=13849 data-original-document-start=13585>本题中，可以定义每段操作序列的贡献为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(x,y,\sum y)" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(x,y,\sum y)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(x,y,\sum y)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．为了严谨地解释这些记号，可以将这些分量都看作是操作序列的函数，也就是说，对于操作序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container>，它的贡献可以写作 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(x(S),y(S),(\sum y)(S))" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(x(S),y(S),(\sum y)(S))" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(x(S),y(S),(\sum y)(S))" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x(S)><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x(S) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x(S)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y(S)><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y(S) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y(S)></mjx-container> 分别对应着操作序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 的数量，也就是该线段右穿和上穿网格线的次数．最后一项中的求和符号，一般地，有如下定义：对于操作序列上的函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(S)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(S) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(S)></mjx-container>，可以定义 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(\sum f)(S)" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(\sum f)(S)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mo data-latex=\sum>∑</mo><mi data-latex=f>f</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=S>S</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(\sum f)(S)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，或记作 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\sum_S f" aria-hidden=true class=NCM-N><mjx-munder data-latex=\sum_S limits=false><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-script style=vertical-align:-.285em><mjx-mi data-latex=S size=s><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-script></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\sum_S f" xmlns=http://www.w3.org/1998/Math/MathML><munder data-latex=\sum_S><mo data-latex=\sum>∑</mo><mi data-latex=S>S</mi></munder><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="\sum_S f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，为下面的表达式：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_S f := \sum\{f(S_{[1,r]}):S_r=R\}.
" aria-hidden=true class=NCM-N display=true><mjx-munder data-latex=\sum_S><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.494em><mjx-mi data-latex=S size=s><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=":=" space=4><mjx-c class=mjx-c3A>:</mjx-c><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=4><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=S_{[1,r]}><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.177em;margin-left:-.032em><mjx-texatom data-latex={[1,r]} size=s texclass=ORD><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=: space=4><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msub data-latex=S_r space=4><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=R space=4><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_S f := \sum\{f(S_{[1,r]}):S_r=R\}." display=block xmlns=http://www.w3.org/1998/Math/MathML><munder data-latex=\sum_S><mo data-latex=\sum>∑</mo><mi data-latex=S>S</mi></munder><mi data-latex=f>f</mi><mo data-latex=":=" data-mjx-texclass=REL>:=</mo><mo data-latex=\sum>∑</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=S_{[1,r]}><mi data-latex=S>S</mi><mrow data-latex={[1,r]} data-mjx-texclass=ORD><mo data-latex=[ stretchy=false>[</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=] stretchy=false>]</mo></mrow></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=:>:</mo><msub data-latex=S_r><mi data-latex=S>S</mi><mi data-latex=r>r</mi></msub><mo data-latex="=">=</mo><mi data-latex=R>R</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_S f := \sum\{f(S_{[1,r]}):S_r=R\}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14012 data-original-document-start=13898>其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S_r><mjx-msub data-latex=S_r><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S_r xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=S_r><mi data-latex=S>S</mi><mi data-latex=r>r</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S_r></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 中的第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 个字符，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S_{[1,r]}><mjx-msub data-latex=S_{[1,r]}><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.177em;margin-left:-.032em><mjx-texatom data-latex={[1,r]} size=s texclass=ORD><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S_{[1,r]} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=S_{[1,r]}><mi data-latex=S>S</mi><mrow data-latex={[1,r]} data-mjx-texclass=ORD><mo data-latex=[ stretchy=false>[</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=] stretchy=false>]</mo></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S_{[1,r]}></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 中前 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 个字符组成的前缀．也就是说，这个求和记号，可以看作是对于操作序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 中所有以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 结尾的前缀进行的求和．比如说，有</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_S 1 = x,~ \sum_S x = \dfrac{1}{2}x(x+1).
" aria-hidden=true class=NCM-N display=true><mjx-munder data-latex=\sum_S><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.494em><mjx-mi data-latex=S size=s><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-munder data-latex=\sum_S space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.494em><mjx-mi data-latex=S size=s><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_S 1 = x,~ \sum_S x = \dfrac{1}{2}x(x+1)." display=block xmlns=http://www.w3.org/1998/Math/MathML><munder data-latex=\sum_S><mo data-latex=\sum>∑</mo><mi data-latex=S>S</mi></munder><mn data-latex=1>1</mn><mo data-latex="=">=</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><munder data-latex=\sum_S><mo data-latex=\sum>∑</mo><mi data-latex=S>S</mi></munder><mi data-latex=x>x</mi><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><mi data-latex=x>x</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_S 1 = x,~ \sum_S x = \dfrac{1}{2}x(x+1).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14232 data-original-document-start=14067>再比如说，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\sum y" aria-hidden=true class=NCM-N><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\sum y" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="\sum y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 就是操作序列中，每次右穿网格线时，之前上穿网格线的次数的累加．对于整段操作序列来说，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 在所有以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 结尾的前缀处的值，就是在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,\cdots,n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,\cdots,n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="i=1,\cdots,n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 处的所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\lfloor(ai+b)/c\rfloor><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lfloor(ai+b)/c\rfloor xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lfloor(ai+b)/c\rfloor></mjx-container> 的值．因此，对于整段操作序列计算的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\sum y" aria-hidden=true class=NCM-N><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\sum y" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="\sum y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，就是本题最终要求的量．</p><p data-original-document-end=14316 data-original-document-start=14234>初始时，有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="U=(0,1,0)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="U=(0,1,0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="U=(0,1,0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="R=(1,0,0)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="R=(1,0,0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="R=(1,0,0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．进一步，可以将两个元素 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(x_1,y_1,s_1)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_1 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(x_1,y_1,s_1) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_1><mi data-latex=s>s</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(x_1,y_1,s_1)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(x_2,y_2,s_2)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_2 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(x_2,y_2,s_2) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(x_2,y_2,s_2)></mjx-container> 的乘积定义为</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
(x_1,y_1,s_1)\cdot (x_2,y_2,s_2) = (x_1+x_2,y_1+y_2,s_1+s_2+x_2y_1).
" aria-hidden=true class=NCM-N display=true><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_1 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_2 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_1 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=s_2 space=3><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="(x_1,y_1,s_1)\cdot (x_2,y_2,s_2) = (x_1+x_2,y_1+y_2,s_1+s_2+x_2y_1)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_1><mi data-latex=s>s</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_1><mi data-latex=s>s</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
(x_1,y_1,s_1)\cdot (x_2,y_2,s_2) = (x_1+x_2,y_1+y_2,s_1+s_2+x_2y_1).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14419 data-original-document-start=14394>其中，最后一项贡献合并的结果可以通过如下计算得到：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{S_1+S_2}y = \sum_{S_1}y + \sum_{S_2}(y+y_1) = \sum_{S_1}y + \sum_{S_2}y + y_1\sum_{S_2}1 = s_1+s_2+x_2y_1.
" aria-hidden=true class=NCM-N display=true><mjx-munder data-latex=\sum_{S_1+S_2}><mjx-row><mjx-base style=padding-left:.295em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={S_1+S_2} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=s_1 space=4><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=s_2 space=3><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{S_1+S_2}y = \sum_{S_1}y + \sum_{S_2}(y+y_1) = \sum_{S_1}y + \sum_{S_2}y + y_1\sum_{S_2}1 = s_1+s_2+x_2y_1." display=block xmlns=http://www.w3.org/1998/Math/MathML><munder data-latex=\sum_{S_1+S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1+S_2} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mn data-latex=1>1</mn><mo data-latex="=">=</mo><msub data-latex=s_1><mi data-latex=s>s</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{S_1+S_2}y = \sum_{S_1}y + \sum_{S_2}(y+y_1) = \sum_{S_1}y + \sum_{S_2}y + y_1\sum_{S_2}1 = s_1+s_2+x_2y_1.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14609 data-original-document-start=14541>容易验证，这个乘法运算满足结合律，且幺元为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(0,0,0)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(0,0,0) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(0,0,0)></mjx-container>，所以这些元素在该乘法运算下构成幺半群．所求的答案，就是乘积的第三个分量．</p><p data-original-document-end=14673 data-original-document-start=14611>这两种方法都可以得到正确的结果．但是，因为保留了较多的冗余信息，矩阵运算的常数较大，所以第二种方法在处理实际问题时更为实用．</p><h3 data-original-document-end=14683 data-original-document-start=14675 id=算法过程>算法过程<a title="Permanent link" class=headerlink href=#算法过程></a></h3><p data-original-document-end=14741 data-original-document-start=14685>与类欧几里得算法整体约化不同，万能欧几里得算法约化问题的手段是将这些操作分批次地合并．记字符串对应的操作的乘积为</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(a,b,c,n,U,R).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=F(a,b,c,n,U,R). display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(a,b,c,n,U,R).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14775 data-original-document-start=14766>约化过程具体如下：</p><ul data-original-document-end=17325 data-original-document-start=14777><li><p>当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b\ge c" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b\ge c" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex=\ge>≥</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="b\ge c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时，操作序列的开始有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor b/c\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor b/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor b/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>，直接计算它们的乘积，并将这些 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 从操作序列中移除．此时，第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 前方的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 的数量等于</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left\lfloor\dfrac{ai+b}{c}\right\rfloor - \left\lfloor\dfrac{b}{c}\right\rfloor = \left\lfloor\dfrac{ai+(b\bmod c)}{c}\right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{b}{c}\right\rfloor " space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{ai+(b\bmod c)}{c}\right\rfloor" space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{ai+(b\bmod c)}{c}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)'><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor - \left\lfloor\dfrac{b}{c}\right\rfloor = \left\lfloor\dfrac{ai+(b\bmod c)}{c}\right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=->−</mo><mrow data-latex="\left\lfloor\dfrac{b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{b}{c}><mi data-latex=b>b</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor\dfrac{ai+(b\bmod c)}{c}\right\rfloor" data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\dfrac{ai+(b\bmod c)}{c}"><mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)'><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left\lfloor\dfrac{ai+b}{c}\right\rfloor - \left\lfloor\dfrac{b}{c}\right\rfloor = \left\lfloor\dfrac{ai+(b\bmod c)}{c}\right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，这相当于将线段参数由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,b,c,n)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,b,c,n)></mjx-container> 变为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a,b\bmod c,c,n)" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a,b\bmod c,c,n)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a,b\bmod c,c,n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．所以，对于这种情形，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(a,b,c,n,U,R) = U^{\lfloor b/c\rfloor}F(a,b\bmod c,c,n,U,R).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex="U^{\lfloor b/c\rfloor}" space=4><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.054em><mjx-texatom data-latex="{\lfloor b/c\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="F(a,b,c,n,U,R) = U^{\lfloor b/c\rfloor}F(a,b\bmod c,c,n,U,R)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex="U^{\lfloor b/c\rfloor}"><mi data-latex=U>U</mi><mrow data-latex="{\lfloor b/c\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(a,b,c,n,U,R) = U^{\lfloor b/c\rfloor}F(a,b\bmod c,c,n,U,R).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><p>当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a\ge c" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a\ge c" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=\ge>≥</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="a\ge c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时，操作序列中每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 的前方都至少有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor a/c\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor a/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor a/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>，可以将它们合并到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 上．也就是说，可以用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="U^{\lfloor a/c\rfloor}R" aria-hidden=true class=NCM-N><mjx-msup data-latex="U^{\lfloor a/c\rfloor}"><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.054em><mjx-texatom data-latex="{\lfloor a/c\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="U^{\lfloor a/c\rfloor}R" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="U^{\lfloor a/c\rfloor}"><mi data-latex=U>U</mi><mrow data-latex="{\lfloor a/c\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mi data-latex=R>R</mi></math></mjx-assistive-mml><img title="U^{\lfloor a/c\rfloor}R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 替代 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>．合并后的字符串中，第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 前方的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 的数量等于</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left\lfloor\dfrac{ai+b}{c}\right\rfloor - \left\lfloor\dfrac{a}{c}\right\rfloor i = \left\lfloor\dfrac{(a\bmod c)i+b}{c}\right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{a}{c}\right\rfloor " space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{(a\bmod c)i+b}{c}\right\rfloor" space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{(a\bmod c)i+b}{c}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)i+b'><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor - \left\lfloor\dfrac{a}{c}\right\rfloor i = \left\lfloor\dfrac{(a\bmod c)i+b}{c}\right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=->−</mo><mrow data-latex="\left\lfloor\dfrac{a}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor\dfrac{(a\bmod c)i+b}{c}\right\rfloor" data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\dfrac{(a\bmod c)i+b}{c}"><mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c)i+b'><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left\lfloor\dfrac{ai+b}{c}\right\rfloor - \left\lfloor\dfrac{a}{c}\right\rfloor i = \left\lfloor\dfrac{(a\bmod c)i+b}{c}\right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，这相当于将线段参数由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,b,c,n)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,b,c,n)></mjx-container> 变为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a\bmod c,b,c,n)" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a\bmod c,b,c,n)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a\bmod c,b,c,n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．所以，对于这种情形，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(a,b,c,n,U,R) = F(a\bmod c,b,c,n,U,U^{\lfloor a/c\rfloor}R).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=F space=4><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex="U^{\lfloor a/c\rfloor}" space=2><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.054em><mjx-texatom data-latex="{\lfloor a/c\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="F(a,b,c,n,U,R) = F(a\bmod c,b,c,n,U,U^{\lfloor a/c\rfloor}R)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><msup data-latex="U^{\lfloor a/c\rfloor}"><mi data-latex=U>U</mi><mrow data-latex="{\lfloor a/c\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(a,b,c,n,U,R) = F(a\bmod c,b,c,n,U,U^{\lfloor a/c\rfloor}R).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><p>对于剩下的情形，需要翻转横纵坐标，这基本是在交换 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>，只是翻转后线段的参数需要仔细计算．结合操作序列的定义可知，需要确定系数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a',b',c',n')" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup space=2><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a',b',c',n')" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=b>b</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=,>,</mo><msup><mi data-latex=n>n</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a',b',c',n')" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 使得变换前的操作序列中，第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 前方的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 的数量恰为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor(a'j+b')/c'\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor(a'j+b')/c'\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=a>a</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mi data-latex=j>j</mi><mo data-latex=+>+</mo><msup><mi data-latex=b>b</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><msup><mi data-latex=c>c</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor(a'j+b')/c'\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且总共有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="n'" aria-hidden=true class=NCM-N><mjx-msup data-latex="n'"><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="n'" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="n'"><mi data-latex=n>n</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="n'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>．根据定义可知，</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
n'=\left\lfloor\dfrac{an+b}{c}\right\rfloor = m,
" aria-hidden=true class=NCM-N display=true><mjx-msup><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{an+b}{c}\right\rfloor " space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{an+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=an+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="n'=\left\lfloor\dfrac{an+b}{c}\right\rfloor = m," display=block xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=n>n</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor\dfrac{an+b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{an+b}{c}><mrow data-latex=an+b><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="=">=</mo><mi data-latex=m>m</mi><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
n'=\left\lfloor\dfrac{an+b}{c}\right\rfloor = m,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>而第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 前方的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 的数量，就等于最大的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 使得</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\left\lfloor\dfrac{ai+b}{c}\right\rfloor < j 
&\iff \dfrac{ai+b}{c} < j \iff i < \dfrac{cj-b}{a} \\
&\iff i < \left\lceil\dfrac{cj-b}{a}\right\rceil = \left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor + 1.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\;\Longleftrightarrow\;i < \left\lceil\dfrac{cj-b}{a}\right\rceil = \left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor + 1.
\end{aligned}" style=min-width:23.017em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.17em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mrow data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=j space=4><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mfrac data-latex=\dfrac{ai+b}{c} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=j space=4><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow space=4><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mi data-latex=i space=4><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{cj-b}{a} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj-b><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.17em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mi data-latex=i space=4><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lceil\dfrac{cj-b}{a}\right\rceil " space=4><mjx-mo data-latex=\left\lceil><mjx-c class="mjx-c2308 NCM-S5">⌈</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{cj-b}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=cj-b><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rceil "><mjx-c class="mjx-c2309 NCM-S5">⌉</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor " space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{cj-b - 1}{a}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="cj-b - 1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1. space=3><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\left\lfloor\dfrac{ai+b}{c}\right\rfloor < j &\iff \dfrac{ai+b}{c} < j \iff i < \dfrac{cj-b}{a} \\&\iff i < \left\lceil\dfrac{cj-b}{a}\right\rceil = \left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor + 1.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\;\Longleftrightarrow\;i < \left\lceil\dfrac{cj-b}{a}\right\rceil = \left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor + 1.\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mrow data-latex="\left\lfloor\dfrac{ai+b}{c}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="<">&lt;</mo><mi data-latex=j>j</mi></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mfrac data-latex=\dfrac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex="<">&lt;</mo><mi data-latex=j>j</mi><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mi data-latex=i>i</mi><mo data-latex="<">&lt;</mo><mfrac data-latex=\dfrac{cj-b}{a}><mrow data-latex=cj-b><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi></mrow><mi data-latex=a>a</mi></mfrac></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><mi data-latex=i>i</mi><mo data-latex="<">&lt;</mo><mrow data-latex="\left\lceil\dfrac{cj-b}{a}\right\rceil " data-mjx-texclass=INNER><mo data-latex=\left\lceil data-mjx-texclass=OPEN>⌈</mo><mfrac data-latex=\dfrac{cj-b}{a}><mrow data-latex=cj-b><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rceil " data-mjx-texclass=CLOSE>⌉</mo></mrow><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\dfrac{cj-b - 1}{a}"><mrow data-latex="cj-b - 1"><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mn data-latex=1.>1.</mn></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\left\lfloor\dfrac{ai+b}{c}\right\rfloor < j 
&\iff \dfrac{ai+b}{c} < j \iff i < \dfrac{cj-b}{a} \\
&\iff i < \left\lceil\dfrac{cj-b}{a}\right\rceil = \left\lfloor\dfrac{cj-b - 1}{a}\right\rfloor + 1.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i = \lfloor(cj-b-1)/a\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i = \lfloor(cj-b-1)/a\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="i = \lfloor(cj-b-1)/a\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．这一推导过程与前文类欧几里得算法的推导类似，同样利用了上下取整函数的性质．</p> <p>有两处细节需要处理：</p> <ul><li>截距项 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=-(b+1)/a><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-(b+1)/a xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=b>b</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-(b+1)/a></mjx-container> 为负数．注意到，如果将线段向左平移一个单位，就可以让截距项恢复为非负数，因为总有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(c-b-1)/a\ge 0" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(c-b-1)/a\ge 0" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\ge>≥</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="(c-b-1)/a\ge 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．因此，可以将交换前的第一段 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R^{\lfloor(c-b-1)/a\rfloor}U><mjx-msup data-latex=R^{\lfloor(c-b-1)/a\rfloor}><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\lfloor(c-b-1)/a\rfloor} size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R^{\lfloor(c-b-1)/a\rfloor}U xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=R^{\lfloor(c-b-1)/a\rfloor}><mi data-latex=R>R</mi><mrow data-latex={\lfloor(c-b-1)/a\rfloor} data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R^{\lfloor(c-b-1)/a\rfloor}U></mjx-container> 提取出来，只交换剩余操作序列中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>；</li><li>交换 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 后，结尾存在多余的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>．因此，交换 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 之前，需要首先将最后一段 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 提取出来，只交换剩余操作序列中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>．这一段 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 的数量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=n-\lfloor(cm-b-1)/a\rfloor><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n-\lfloor(cm-b-1)/a\rfloor xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n-\lfloor(cm-b-1)/a\rfloor></mjx-container>．</li></ul> <p>去掉头尾若干个字符后，第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 前方的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 的数量变为：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left\lfloor\dfrac{c(j+1)-b-1}{a}\right\rfloor - \left\lfloor\dfrac{c-b-1}{a}\right\rfloor = \left\lfloor\dfrac{cj+(c-b-1)\bmod a}{a}\right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex="\left\lfloor\dfrac{c(j+1)-b-1}{a}\right\rfloor "><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c(j+1)-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=c(j+1)-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{c-b-1}{a}\right\rfloor " space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c-b-1}{a}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=c-b-1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{cj+(c-b-1)\bmod a}{a}\right\rfloor" space=4><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S6">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{cj+(c-b-1)\bmod a}{a}"><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}a'><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S6">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left\lfloor\dfrac{c(j+1)-b-1}{a}\right\rfloor - \left\lfloor\dfrac{c-b-1}{a}\right\rfloor = \left\lfloor\dfrac{cj+(c-b-1)\bmod a}{a}\right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\left\lfloor\dfrac{c(j+1)-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{c(j+1)-b-1}{a}><mrow data-latex=c(j+1)-b-1><mi data-latex=c>c</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=->−</mo><mrow data-latex="\left\lfloor\dfrac{c-b-1}{a}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{c-b-1}{a}><mrow data-latex=c-b-1><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex="=">=</mo><mrow data-latex="\left\lfloor\dfrac{cj+(c-b-1)\bmod a}{a}\right\rfloor" data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex="\dfrac{cj+(c-b-1)\bmod a}{a}"><mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}a'><mi data-latex=c>c</mi><mi data-latex=j>j</mi><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=a>a</mi></mrow><mi data-latex=a>a</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left\lfloor\dfrac{c(j+1)-b-1}{a}\right\rfloor - \left\lfloor\dfrac{c-b-1}{a}\right\rfloor = \left\lfloor\dfrac{cj+(c-b-1)\bmod a}{a}\right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>回忆起，交换前的序列中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 的数量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m = \lfloor(an+b)/c\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m = \lfloor(an+b)/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="m = \lfloor(an+b)/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．而上述左移一个单位的操作，要求保证交换前至少存在一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>，也就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="m>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．利用这一条件，可以分为两种情形：</p> <ul><li><p>对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="m>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形，处理了上面的两点后，交换完 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 的操作序列就是对应着参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(c,(c-b-1)\bmod a,a,m-1)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(c,(c-b-1)\bmod a,a,m-1)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(c,(c-b-1)\bmod a,a,m-1)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的线段的合法序列．所以，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(a,b,c,n,U,R) = R^{\lfloor(c-b-1)/a\rfloor}UF(c,(c-b-1)\bmod a,a,m-1,R,U)R^{n-\lfloor(cm-b-1)/a\rfloor}.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=R^{\lfloor(c-b-1)/a\rfloor} space=4><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\lfloor(c-b-1)/a\rfloor} size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex="R^{n-\lfloor(c m-b-1)/a\rfloor}"><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{n-\lfloor(c m-b-1)/a\rfloor}" size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="F(a,b,c,n,U,R) = R^{\lfloor(c-b-1)/a\rfloor}UF(c,(c-b-1)\bmod a,a,m-1,R,U)R^{n-\lfloor(cm-b-1)/a\rfloor}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=R^{\lfloor(c-b-1)/a\rfloor}><mi data-latex=R>R</mi><mrow data-latex={\lfloor(c-b-1)/a\rfloor} data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mi data-latex=U>U</mi><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=) stretchy=false>)</mo><msup data-latex="R^{n-\lfloor(c m-b-1)/a\rfloor}"><mi data-latex=R>R</mi><mrow data-latex="{n-\lfloor(c m-b-1)/a\rfloor}" data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(a,b,c,n,U,R) = R^{\lfloor(c-b-1)/a\rfloor}UF(c,(c-b-1)\bmod a,a,m-1,R,U)R^{n-\lfloor(cm-b-1)/a\rfloor}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><p>特别地，对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="m=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形，交换前的操作序列中只包含 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>，无需交换，可以直接返回：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(a,b,c,n,U,R) = R^n.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=R^n space=4><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="F(a,b,c,n,U,R) = R^n." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=R^n><mi data-latex=R>R</mi><mi data-latex=n>n</mi></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(a,b,c,n,U,R) = R^n.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>与类欧几里得算法不同，万能欧几里得算法的这一特殊情形需要单独处理，否则会因涉及负幂次而无法正确计算．</p></li></ul></li></ul><p data-original-document-end=17346 data-original-document-start=17327>利用这些讨论，就可以将问题递归地解决．</p><p data-original-document-end=17495 data-original-document-start=17348>假设幺半群内元素单次相乘的时间复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(1)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(1)></mjx-container> 的．那么，如果计算过程中这些元素的幂次计算都使用 <a href=../../binary-exponentiation/>快速幂</a> 进行，最终的算法复杂度就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=O(\log\max\{a,c\}+\log(b/c))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\max space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi space=3><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=)><mjx-mo><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\max\{a,c\}+\log(b/c)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=+>+</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=)><mo data-mjx-texclass=OPEN>(</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\max\{a,c\}+\log(b/c))></mjx-container> 的<sup id=fnref:complexity><a class=footnote-ref href=#fn:complexity>1</a></sup>．</p><details class=note data-original-document-end=18642 data-original-document-start=17629><summary>对复杂度的解释</summary> <p>对比（类）欧几里得算法，万能欧几里得算法只是多了求快速幂的步骤．其余的计算过程的复杂度和类欧几里得算法相仿，已经说明是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log\min\{a,c,n\})><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\min space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\min\{a,c,n\}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\min\{a,c,n\})></mjx-container> 的．现在，需要计算这些快速幂的总复杂度．</p> <p>除了第一轮迭代，都有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b<c" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b<c" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="b<c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，因此这些迭代每轮都涉及三次快速幂的计算，总的复杂度是：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
O\left(\log\left\lfloor\dfrac{a}{c}\right\rfloor+\log\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor+\log\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right)\right),
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mrow data-latex=\left(\log\left\lfloor\dfrac{a}{c}\right\rfloor+\log\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor+\log\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right)\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{a}{c}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S4">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S4">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\log space=3><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c-b_1-1}{a_1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="c-b_1 -1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\log space=3><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{cm-b_1-1}{a_1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="cm-b_1 -1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=O\left(\log\left\lfloor\dfrac{a}{c}\right\rfloor+\log\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor+\log\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right)\right), display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mrow data-latex=\left(\log\left\lfloor\dfrac{a}{c}\right\rfloor+\log\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor+\log\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right)\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=\left\lfloor\dfrac{a}{c}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{c-b_1-1}{a_1}><mrow data-latex="c-b_1 -1"><mi data-latex=c>c</mi><mo data-latex=->−</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mrow data-latex=\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{cm-b_1-1}{a_1}><mrow data-latex="cm-b_1 -1"><mi data-latex=c>c</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
O\left(\log\left\lfloor\dfrac{a}{c}\right\rfloor+\log\left\lfloor\dfrac{c-b_1-1}{a_1}\right\rfloor+\log\left(n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor\right)\right),
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_1=a\bmod c" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_1=a\bmod c" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex="=">=</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="a_1=a\bmod c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b_1=b\bmod c" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=b_1><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=b space=4><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b_1=b\bmod c" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex="=">=</mo><mi data-latex=b>b</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi></math></mjx-assistive-mml><img title="b_1=b\bmod c" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=\lfloor(a_1n+b_1)/c\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=\lfloor(a_1n+b_1)/c\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=n>n</mi><mo data-latex=+>+</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="m=\lfloor(a_1n+b_1)/c\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．后面两项，分别有估计：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\dfrac{c-b_1-1}{a_1} &\le \dfrac{c}{a_1},\\
n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor &\le n - \dfrac{cm-b_1-1}{a_1} + 1 \\
&\le n - \dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1} +1 \\
&= \dfrac{c+1}{a_1}+1.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
\dfrac{c-b_1-1}{a_1} &\le \dfrac{c}{a_1},\\
n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor &\le n - \dfrac{cm-b_1-1}{a_1} + 1 \\
&\le n - \dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1} +1 \\
&= \dfrac{c+1}{a_1}+1.
\end{aligned}" style=min-width:25.921em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.206em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mfrac data-latex=\dfrac{c-b_1-1}{a_1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="c-b_1 -1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c}{a_1} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.206em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor " space=3><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{cm-b_1-1}{a_1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="cm-b_1 -1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="\right\rfloor "><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{cm-b_1-1}{a_1} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="cm-b_1 -1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.296em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="c((a_1 n+b_1 )/c-1)-b_1 -1"><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.178em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{c+1}{a_1} space=4><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=c+1><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1. space=3><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\dfrac{c-b_1-1}{a_1} &\le \dfrac{c}{a_1},\\n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor &\le n - \dfrac{cm-b_1-1}{a_1} + 1 \\&\le n - \dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1} +1 \\&= \dfrac{c+1}{a_1}+1.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\dfrac{c-b_1-1}{a_1} &\le \dfrac{c}{a_1},\\n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor &\le n - \dfrac{cm-b_1-1}{a_1} + 1 \\&\le n - \dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1} +1 \\&= \dfrac{c+1}{a_1}+1.\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mfrac data-latex=\dfrac{c-b_1-1}{a_1}><mrow data-latex="c-b_1 -1"><mi data-latex=c>c</mi><mo data-latex=->−</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\le>≤</mo><mfrac data-latex=\dfrac{c}{a_1}><mi data-latex=c>c</mi><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=n>n</mi><mo data-latex=->−</mo><mrow data-latex="\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor " data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{cm-b_1-1}{a_1}><mrow data-latex="cm-b_1 -1"><mi data-latex=c>c</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex="\right\rfloor " data-mjx-texclass=CLOSE>⌋</mo></mrow></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\le>≤</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mfrac data-latex=\dfrac{cm-b_1-1}{a_1}><mrow data-latex="cm-b_1 -1"><mi data-latex=c>c</mi><mi data-latex=m>m</mi><mo data-latex=->−</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\le>≤</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mfrac data-latex=\dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1}><mrow data-latex="c((a_1 n+b_1 )/c-1)-b_1 -1"><mi data-latex=c>c</mi><mo data-latex=( stretchy=false>(</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=n>n</mi><mo data-latex=+>+</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mfrac data-latex=\dfrac{c+1}{a_1}><mrow data-latex=c+1><mi data-latex=c>c</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub></mfrac><mo data-latex=+>+</mo><mn data-latex=1.>1.</mn></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\dfrac{c-b_1-1}{a_1} &\le \dfrac{c}{a_1},\\
n-\left\lfloor\dfrac{cm-b_1-1}{a_1}\right\rfloor &\le n - \dfrac{cm-b_1-1}{a_1} + 1 \\
&\le n - \dfrac{c((a_1n+b_1)/c-1)-b_1-1}{a_1} +1 \\
&= \dfrac{c+1}{a_1}+1.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，这两项的复杂度都是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log(c/a_1))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=)><mjx-mo><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log(c/a_1)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=)><mo data-mjx-texclass=OPEN>(</mo><mi data-latex=c>c</mi><mo data-latex=/>/</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log(c/a_1))></mjx-container> 的．</p> <p>每一轮迭代中，线段的参数都由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=(a,\cdot,c,\cdot)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,\cdot,c,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,\cdot,c,\cdot)></mjx-container> 变换为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(c,\cdot,a\bmod c,\cdot)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(c,\cdot,a\bmod c,\cdot)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=,>,</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(c,\cdot,a\bmod c,\cdot)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，且该轮总的时间复杂度为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
O\left(\log\dfrac{a}{c}+\log\dfrac{c}{a\bmod c}\right).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mrow data-latex="\left(\log\dfrac{a}{c}+\log\dfrac{c}{a\bmod c}\right)" space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{c} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\log space=3><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mfrac data-latex="\dfrac{c}{a\bmod c}" space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c'><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="O\left(\log\dfrac{a}{c}+\log\dfrac{c}{a\bmod c}\right)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mrow data-latex="\left(\log\dfrac{a}{c}+\log\dfrac{c}{a\bmod c}\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mfrac data-latex=\dfrac{a}{c}><mi data-latex=a>a</mi><mi data-latex=c>c</mi></mfrac><mo data-latex=+>+</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mfrac data-latex="\dfrac{c}{a\bmod c}"><mi data-latex=c>c</mi><mrow data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}c'><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=c>c</mi></mrow></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
O\left(\log\dfrac{a}{c}+\log\dfrac{c}{a\bmod c}\right).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>对于全部递归的轮次，这些项可以裂项相消，因此，最后总和复杂度就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log a+\log c)=O(\log\max\{a,c\})" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\log space=3><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=O space=4><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\max space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log a+\log c)=O(\log\max\{a,c\})" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=a>a</mi><mo data-latex=+>+</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log a+\log c)=O(\log\max\{a,c\})" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的．</p> <p>最后，再加上第一轮迭代中快速幂 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="U^{\lfloor b/c\rfloor}" aria-hidden=true class=NCM-N><mjx-msup data-latex="U^{\lfloor b/c\rfloor}"><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.054em><mjx-texatom data-latex="{\lfloor b/c\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="U^{\lfloor b/c\rfloor}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="U^{\lfloor b/c\rfloor}"><mi data-latex=U>U</mi><mrow data-latex="{\lfloor b/c\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup></math></mjx-assistive-mml><img title="U^{\lfloor b/c\rfloor}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的复杂度 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log(b/c))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=)><mjx-mo><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log(b/c)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=)><mo data-mjx-texclass=OPEN>(</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log(b/c))></mjx-container>，就得到总的复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=O(\log\max\{a,c\}+\log(b/c))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=\max space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi space=3><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=)><mjx-mo><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log\max\{a,c\}+\log(b/c)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=+>+</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=)><mo data-mjx-texclass=OPEN>(</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log\max\{a,c\}+\log(b/c))></mjx-container>．</p></details><p data-original-document-end=18692 data-original-document-start=18644>万能欧几里得算法的流程可以写成统一的模板，处理具体问题时只需要更改模板类型 <code>T</code> 的实现即可．</p><details class=example data-original-document-end=18796 data-original-document-start=18694 open><summary>参考实现</summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span></pre></div></td><td class=code><div><pre><span></span><code><span class=c1>// Class T implements the monoid.</span>
<span class=c1>// Assume that it provides a multiplication operator</span>
<span class=c1>//     and a default constructor returning the unity in the monoid.</span>

<span class=c1>// Binary exponentiation.</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>&</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=c1>// Universal Euclidean algorithm.</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>R</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>((</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>U</span><span class=w> </span><span class=o>*</span>
<span class=w>         </span><span class=n>euclid</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>)</span><span class=w> </span><span class=o>*</span>
<span class=w>         </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><p data-original-document-end=18821 data-original-document-start=18798>利用万能欧几里得算法可以得到模板题的实现如下：</p><details class=example><summary>模板题实现（<a href=https://judge.yosupo.jp/problem/sum_of_floor_of_linear target=_blank>Library Checker - Sum of Floor of Linear</a>）</summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;array></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=c1>// Switch between matrix and info merging approaches.</span>
<span class=cp>#define MATRIX 1</span>

<span class=c1>// Class T implements the monoid.</span>
<span class=c1>// Assume that it provides a multiplication operator</span>
<span class=c1>//     and a default constructor returning the unity in the monoid.</span>

<span class=c1>// Binary exponentiation.</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>&</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=c1>// Universal Euclidean algorithm.</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>R</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>((</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>U</span><span class=w> </span><span class=o>*</span>
<span class=w>         </span><span class=n>euclid</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>)</span><span class=w> </span><span class=o>*</span>
<span class=w>         </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>);</span>
<span class=p>}</span>

<span class=cp>#if MATRIX</span>

<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=kt>size_t</span><span class=w> </span><span class=n>N</span><span class=o>></span>
<span class=k>struct</span><span class=w> </span><span class=nc>Matrix</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>array</span><span class=o>&lt;</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>,</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>N</span><span class=o>></span><span class=w> </span><span class=n>mat</span><span class=p>;</span>

<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>loc</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=kt>size_t</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>j</span><span class=p>];</span><span class=w> </span><span class=p>}</span>

<span class=w>  </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>loc</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=kt>size_t</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>mat</span><span class=p>[</span><span class=n>i</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>j</span><span class=p>];</span><span class=w> </span><span class=p>}</span>

<span class=w>  </span><span class=n>Matrix</span><span class=p>()</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>mat</span><span class=p>{}</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>N</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>loc</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=n>Matrix</span><span class=w> </span><span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Matrix</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Matrix</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>mat</span><span class=p>.</span><span class=n>fill</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>N</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>N</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>N</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=n>res</span><span class=p>.</span><span class=n>loc</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>loc</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>loc</span><span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>j</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>};</span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=n>Matrix</span><span class=o>&lt;</span><span class=mi>3</span><span class=o>></span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>;</span>
<span class=w>  </span><span class=n>U</span><span class=p>.</span><span class=n>loc</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>R</span><span class=p>.</span><span class=n>loc</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>loc</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
<span class=p>}</span>

<span class=cp>#else</span>

<span class=k>struct</span><span class=w> </span><span class=nc>Info</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>;</span>

<span class=w>  </span><span class=n>Info</span><span class=p>()</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>y</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>s</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{}</span>

<span class=w>  </span><span class=n>Info</span><span class=w> </span><span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Info</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Info</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>y</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>};</span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=n>Info</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>;</span>
<span class=w>  </span><span class=n>U</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=n>R</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>s</span><span class=p>;</span>
<span class=p>}</span>

<span class=cp>#endif</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>b</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><h3 id=例题_1>例题<a title="Permanent link" class=headerlink href=#例题_1></a></h3><details class=example open><summary><a href=https://www.luogu.com.cn/problem/P5170 target=_blank>【模板】类欧几里得算法</a></summary> <p>多组询问．给定正整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b,c,n><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b,c,n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b,c,n></mjx-container>，求</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2 .
\end{aligned}" style=min-width:12.655em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.766em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=i space=2><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" space=2><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.771em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^2" space=2><mjx-mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor"><mjx-mo data-latex="\left\lfloor "><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ai+b}{c}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ai+b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.097em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2 .\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><mi data-latex=i>i</mi><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=n>n</mi></munderover><msup data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor^2"><mrow data-latex="\left\lfloor \frac{ai+b}{c} \right\rfloor" data-mjx-texclass=INNER><mo data-latex="\left\lfloor " data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\frac{ai+b}{c}><mrow data-latex=ai+b><mi data-latex=a>a</mi><mi data-latex=i>i</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi></mrow><mi data-latex=c>c</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
g(a,b,c,n) &= \sum_{i=0}^ni\left\lfloor \frac{ai+b}{c} \right\rfloor,\\
h(a,b,c,n) &= \sum_{i=0}^n\left\lfloor \frac{ai+b}{c} \right\rfloor^2.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note data-original-document-end=21948 data-original-document-start=19415><summary>解答二</summary> <p>为了应用万能欧几里得算法的模板，首先将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="i=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的项提出来，单独考虑．对于剩下的部分，可以看作是对参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(a,b,c,n)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(a,b,c,n) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(a,b,c,n)></mjx-container> 的线段分别计算 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\sum y,\sum xy,\sum y^2" aria-hidden=true class=NCM-N><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\sum y,\sum xy,\sum y^2" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup></math></mjx-assistive-mml><img title="\sum y,\sum xy,\sum y^2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．如正文所言，有两种将操作序列转换为幺半群元素的方式．</p> <p><strong>矩阵运算</strong>：状态向量定义为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(1,x,y,xy,y^2,\sum y,\sum xy,\sum y^2)" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(1,x,y,xy,y^2,\sum y,\sum xy,\sum y^2)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=,>,</mo><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(1,x,y,xy,y^2,\sum y,\sum xy,\sum y^2)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．初始状态为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(1,0,0,0,0,0,0,0)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(1,0,0,0,0,0,0,0) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(1,0,0,0,0,0,0,0)></mjx-container>，两个操作分别为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
U =
\begin{pmatrix}
1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\
0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 2 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 
\end{pmatrix},~
R = 
\begin{pmatrix}
1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 1 & 0 & 1 & 1 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 1 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 
\end{pmatrix}.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={pmatrix} space=4><mjx-mo><mjx-stretchy-v class=mjx-c28 style=vertical-align:-5.15em;height:10.8em><mjx-beg>⎛</mjx-beg><mjx-ext><mjx-spacer>⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜</mjx-spacer></mjx-ext><mjx-end>⎝</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=min-width:11em><mjx-table><mjx-itable><mjx-mtr style=height:.688em><mjx-mtd style=padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo><mjx-stretchy-v class=mjx-c29 style=vertical-align:-5.15em;height:10.8em><mjx-beg>⎞</mjx-beg><mjx-ext><mjx-spacer>⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟</mjx-spacer></mjx-ext><mjx-end>⎠</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={pmatrix} space=4><mjx-mo><mjx-stretchy-v class=mjx-c28 style=vertical-align:-5.15em;height:10.8em><mjx-beg>⎛</mjx-beg><mjx-ext><mjx-spacer>⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜</mjx-spacer></mjx-ext><mjx-end>⎝</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=min-width:11em><mjx-table><mjx-itable><mjx-mtr style=height:.688em><mjx-mtd style=padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding:.2em .5em"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-bottom:.2em;padding-left:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.688em><mjx-mtd style=padding-top:.2em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=padding-top:.2em;padding-left:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo><mjx-stretchy-v class=mjx-c29 style=vertical-align:-5.15em;height:10.8em><mjx-beg>⎞</mjx-beg><mjx-ext><mjx-spacer>⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟</mjx-spacer></mjx-ext><mjx-end>⎠</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="U =\begin{pmatrix}1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 \\0 & 0 & 1 & 0 & 2 & 0 & 0 & 0 \\0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \end{pmatrix},~R = \begin{pmatrix}1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\0 & 0 & 1 & 1 & 0 & 1 & 1 & 0 \\0 & 0 & 0 & 1 & 0 & 0 & 1 & 0 \\0 & 0 & 0 & 0 & 1 & 0 & 0 & 1 \\0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \end{pmatrix}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi><mo data-latex="=">=</mo><mrow data-latex={pmatrix} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>(</mo><mtable columnspacing=1em rowspacing=4pt><mtr><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=2>2</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=R>R</mi><mo data-latex="=">=</mo><mrow data-latex={pmatrix} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>(</mo><mtable columnspacing=1em rowspacing=4pt><mtr><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd><mtd><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=0>0</mn></mtd><mtd><mn data-latex=1>1</mn></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
U =
\begin{pmatrix}
1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\
0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 2 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 
\end{pmatrix},~
R = 
\begin{pmatrix}
1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 1 & 0 & 1 & 1 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 1 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 
\end{pmatrix}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>最终答案为初始状态右乘这些操作矩阵的乘积得到的向量末尾三个分量．</p> <p>这个做法的常数巨大，并不能通过本题，这里给出细节仅仅是为了辅助理解．</p> <p><strong>贡献合并</strong>：一段操作序列的贡献定义为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(x,y,\sum y,\sum xy,\sum y^2)" aria-hidden=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(x,y,\sum y,\sum xy,\sum y^2)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(x,y,\sum y,\sum xy,\sum y^2)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．两个操作分别为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
U = (0,1,0,0,0),~ R = (1,0,0,0,0).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="U = (0,1,0,0,0),~ R = (1,0,0,0,0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=R>R</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
U = (0,1,0,0,0),~ R = (1,0,0,0,0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>贡献合并时，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\sum_{S_1+S_2} y 
&= \sum_{S_1}y + \sum_{S_2}(y+y_1) = \sum_{S_1}y + \sum_{S_2}y + x_2y_1,\\
\sum_{S_1+S_2} xy
&= \sum_{S_1}xy + \sum_{S_2}(x+x_1)(y+y_1) \\
&= \sum_{S_1}xy + \sum_{S_2}xy + x_1\sum_{S_2}y + y_1\sum_{S_2}x + x_1y_1\sum_{S_2}1\\
&= \sum_{S_1}xy + \sum_{S_2}xy + x_1\sum_{S_2}y + \dfrac{1}{2}x_2(x_2+1)y_1 + x_1x_2y_1,\\
\sum_{S_1+S_2}y^2
&= \sum_{S_1}y^2 + \sum_{S_2}(y+y_1)^2 \\
&= \sum_{S_1}y^2 + \sum_{S_2}y^2 + 2y_1\sum_{S_2}y + y_1^2\sum_{S_2}1  \\
&= \sum_{S_1}y^2 + \sum_{S_2}y^2 + 2y_1\sum_{S_2}y + x_2y_1^2.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
\sum_{S_1 +S_2 } y 
&= \sum_{S_1 }y + \sum_{S_2 }(y+y_1 ) = \sum_{S_1 }y + \sum_{S_2 }y + x_2 y_1 ,\\
\sum_{S_1 +S_2 } xy
&= \sum_{S_1 }xy + \sum_{S_2 }(x+x_1 )(y+y_1 ) \\
&= \sum_{S_1 }xy + \sum_{S_2 }xy + x_1 \sum_{S_2 }y + y_1 \sum_{S_2 }x + x_1 y_1 \sum_{S_2 }1\\
&= \sum_{S_1 }xy + \sum_{S_2 }xy + x_1 \sum_{S_2 }y + \dfrac{1}{2}x_2 (x_2 +1)y_1  + x_1 x_2 y_1 ,\\
\sum_{S_1 +S_2 }y^2 
&= \sum_{S_1 }y^2  + \sum_{S_2 }(y+y_1 )^2  \\
&= \sum_{S_1 }y^2  + \sum_{S_2 }y^2  + 2y_1 \sum_{S_2 }y + y_1 ^2 \sum_{S_2 }1  \\
&= \sum_{S_1 }y^2  + \sum_{S_2 }y^2  + 2y_1 \sum_{S_2 }y + x_2 y_1 ^2 .
\end{aligned}" style=min-width:27.713em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-munder data-latex=\sum_{S_1+S_2}><mjx-row><mjx-base style=padding-left:.295em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={S_1+S_2} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-munder data-latex=\sum_{S_1+S_2}><mjx-row><mjx-base style=padding-left:.295em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={S_1+S_2} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.664em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{2} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-munder data-latex=\sum_{S_1+S_2}><mjx-row><mjx-base style=padding-left:.295em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={S_1+S_2} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msup data-latex=)^2><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msubsup data-latex=y_1^2 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.189em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=y^2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msubsup data-latex=y_1^2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.189em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\sum_{S_1+S_2} y &= \sum_{S_1}y + \sum_{S_2}(y+y_1) = \sum_{S_1}y + \sum_{S_2}y + x_2y_1,\\\sum_{S_1+S_2} xy&= \sum_{S_1}xy + \sum_{S_2}(x+x_1)(y+y_1) \\&= \sum_{S_1}xy + \sum_{S_2}xy + x_1\sum_{S_2}y + y_1\sum_{S_2}x + x_1y_1\sum_{S_2}1\\&= \sum_{S_1}xy + \sum_{S_2}xy + x_1\sum_{S_2}y + \dfrac{1}{2}x_2(x_2+1)y_1 + x_1x_2y_1,\\\sum_{S_1+S_2}y^2&= \sum_{S_1}y^2 + \sum_{S_2}(y+y_1)^2 \\&= \sum_{S_1}y^2 + \sum_{S_2}y^2 + 2y_1\sum_{S_2}y + y_1^2\sum_{S_2}1  \\&= \sum_{S_1}y^2 + \sum_{S_2}y^2 + 2y_1\sum_{S_2}y + x_2y_1^2.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\sum_{S_1 +S_2 } y &= \sum_{S_1 }y + \sum_{S_2 }(y+y_1 ) = \sum_{S_1 }y + \sum_{S_2 }y + x_2 y_1 ,\\\sum_{S_1 +S_2 } xy&= \sum_{S_1 }xy + \sum_{S_2 }(x+x_1 )(y+y_1 ) \\&= \sum_{S_1 }xy + \sum_{S_2 }xy + x_1 \sum_{S_2 }y + y_1 \sum_{S_2 }x + x_1 y_1 \sum_{S_2 }1\\&= \sum_{S_1 }xy + \sum_{S_2 }xy + x_1 \sum_{S_2 }y + \dfrac{1}{2}x_2 (x_2 +1)y_1  + x_1 x_2 y_1 ,\\\sum_{S_1 +S_2 }y^2 &= \sum_{S_1 }y^2  + \sum_{S_2 }(y+y_1 )^2  \\&= \sum_{S_1 }y^2  + \sum_{S_2 }y^2  + 2y_1 \sum_{S_2 }y + y_1 ^2 \sum_{S_2 }1  \\&= \sum_{S_1 }y^2  + \sum_{S_2 }y^2  + 2y_1 \sum_{S_2 }y + x_2 y_1 ^2 .\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><munder data-latex=\sum_{S_1+S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1+S_2} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><munder data-latex=\sum_{S_1+S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1+S_2} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=x>x</mi><mi data-latex=y>y</mi></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mn data-latex=1>1</mn></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=x>x</mi><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><mfrac data-latex=\dfrac{1}{2}><mn data-latex=1>1</mn><mn data-latex=2>2</mn></mfrac><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd><munder data-latex=\sum_{S_1+S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1+S_2} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><msup data-latex=)^2><mo data-latex=) stretchy=false>)</mo><mn data-latex=2>2</mn></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><mn data-latex=2>2</mn><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msubsup data-latex=y_1^2><mi data-latex=y>y</mi><mn data-latex=1>1</mn><mn data-latex=2>2</mn></msubsup><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mn data-latex=1>1</mn></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><mn data-latex=2>2</mn><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msubsup data-latex=y_1^2><mi data-latex=y>y</mi><mn data-latex=1>1</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\sum_{S_1+S_2} y 
&= \sum_{S_1}y + \sum_{S_2}(y+y_1) = \sum_{S_1}y + \sum_{S_2}y + x_2y_1,\\
\sum_{S_1+S_2} xy
&= \sum_{S_1}xy + \sum_{S_2}(x+x_1)(y+y_1) \\
&= \sum_{S_1}xy + \sum_{S_2}xy + x_1\sum_{S_2}y + y_1\sum_{S_2}x + x_1y_1\sum_{S_2}1\\
&= \sum_{S_1}xy + \sum_{S_2}xy + x_1\sum_{S_2}y + \dfrac{1}{2}x_2(x_2+1)y_1 + x_1x_2y_1,\\
\sum_{S_1+S_2}y^2
&= \sum_{S_1}y^2 + \sum_{S_2}(y+y_1)^2 \\
&= \sum_{S_1}y^2 + \sum_{S_2}y^2 + 2y_1\sum_{S_2}y + y_1^2\sum_{S_2}1  \\
&= \sum_{S_1}y^2 + \sum_{S_2}y^2 + 2y_1\sum_{S_2}y + x_2y_1^2.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这说明，应该将操作的乘法定义为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
&(x_1,y_1,s_1,t_1,u_1)\cdot(x_2,y_2,s_2,t_2,u_2)\\
&= (x_1+x_2,y_1+y_2,s_1+s_2+x_2y_1,\\
&\qquad t_1+t_2+x_1s_2+(1/2)x_2(x_2+1)y_1+x_1x_2y_1,\\
&\qquad u_1+u_2+2y_1s_2+x_2y_1^2).
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
&(x_1 ,y_1 ,s_1 ,t_1 ,u_1 )\cdot(x_2 ,y_2 ,s_2 ,t_2 ,u_2 )\\
&= (x_1 +x_2 ,y_1 +y_2 ,s_1 +s_2 +x_2 y_1 ,\\
&\qquad t_1 +t_2 +x_1 s_2 +(1/2)x_2 (x_2 +1)y_1 +x_1 x_2 y_1 ,\\
&\qquad u_1 +u_2 +2y_1 s_2 +x_2 y_1 ^2 ).
\end{aligned}" style=min-width:21.343em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_1 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=t_1 space=2><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=u_1 space=2><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_2 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=t_2 space=2><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=u_2 space=2><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=s_1 space=2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=s_2 space=3><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\qquad style=width:2em></mjx-mspace><mjx-msub data-latex=t_1><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=t_2 space=3><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=s_2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\qquad style=width:2em></mjx-mspace><mjx-msub data-latex=u_1><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=u_2 space=3><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=s_2><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msubsup data-latex=y_1^2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.189em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}&(x_1,y_1,s_1,t_1,u_1)\cdot(x_2,y_2,s_2,t_2,u_2)\\&= (x_1+x_2,y_1+y_2,s_1+s_2+x_2y_1,\\&\qquad t_1+t_2+x_1s_2+(1/2)x_2(x_2+1)y_1+x_1x_2y_1,\\&\qquad u_1+u_2+2y_1s_2+x_2y_1^2).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}&(x_1 ,y_1 ,s_1 ,t_1 ,u_1 )\cdot(x_2 ,y_2 ,s_2 ,t_2 ,u_2 )\\&= (x_1 +x_2 ,y_1 +y_2 ,s_1 +s_2 +x_2 y_1 ,\\&\qquad t_1 +t_2 +x_1 s_2 +(1/2)x_2 (x_2 +1)y_1 +x_1 x_2 y_1 ,\\&\qquad u_1 +u_2 +2y_1 s_2 +x_2 y_1 ^2 ).\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_1><mi data-latex=s>s</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=t_1><mi data-latex=t>t</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=u_1><mi data-latex=u>u</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=t_2><mi data-latex=t>t</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=u_2><mi data-latex=u>u</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=s_1><mi data-latex=s>s</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\qquad width=2em></mspace><msub data-latex=t_1><mi data-latex=t>t</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=t_2><mi data-latex=t>t</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=/>/</mo><mn data-latex=2>2</mn><mo data-latex=) stretchy=false>)</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\qquad width=2em></mspace><msub data-latex=u_1><mi data-latex=u>u</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=u_2><mi data-latex=u>u</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><mn data-latex=2>2</mn><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><msub data-latex=s_2><mi data-latex=s>s</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><msubsup data-latex=y_1^2><mi data-latex=y>y</mi><mn data-latex=1>1</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
&(x_1,y_1,s_1,t_1,u_1)\cdot(x_2,y_2,s_2,t_2,u_2)\\
&= (x_1+x_2,y_1+y_2,s_1+s_2+x_2y_1,\\
&\qquad t_1+t_2+x_1s_2+(1/2)x_2(x_2+1)y_1+x_1x_2y_1,\\
&\qquad u_1+u_2+2y_1s_2+x_2y_1^2).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>虽然直接验证较为繁琐，但是上述定义的贡献向量在该乘法下的确构成幺半群，单位元为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(0,0,0,0,0)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(0,0,0,0,0) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(0,0,0,0,0)></mjx-container>．</p> <p>对于一般的情形，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\sum_{S_1+S_2}x^ry^s &= \sum_{S_1}x^ry^s + \sum_{S_2}(x+x_1)^r(y+y_1)^s \\
&= \sum_{S_1}x^ry^s + \sum_{i=0}^r\sum_{j=0}^s\binom{r}{i}\binom{s}{j}x_1^{r-i}y_1^{s-j}\sum_{S_2}x^iy^j.
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
\sum_{S_1 +S_2 }x^ry^s &= \sum_{S_1 }x^ry^s + \sum_{S_2 }(x+x_1 )^r(y+y_1 )^s \\
&= \sum_{S_1 }x^ry^s + \sum_{i=0}^r\sum_{j=0}^s\binom{r}{i}\binom{s}{j}x_1 ^{r-i}y_1 ^{s-j}\sum_{S_2 }x^iy^j.
\end{aligned}" style=min-width:24.251em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.272em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-munder data-latex=\sum_{S_1+S_2}><mjx-row><mjx-base style=padding-left:.295em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={S_1+S_2} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^r space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex=y^s><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^r space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex=y^s><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_2} space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=x_1 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msup data-latex=)^r><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msup data-latex=)^s><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.895em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\sum_{S_1} space=4><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_1} size=s texclass=ORD><mjx-msub data-latex=S_1><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^r space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex=y^s><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^r" space=3><mjx-over style=padding-bottom:.192em;padding-left:.563em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover data-latex="\sum_{j=0}^s" space=2><mjx-over style=padding-bottom:.192em;padding-left:.556em><mjx-mi data-latex=s size=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.124em><mjx-texatom data-latex="{j=0}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\binom{r}{i} space=2><mjx-texatom data-latex="\biggl (" texclass=OPEN><mjx-mo><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo></mjx-texatom><mjx-mfrac><mjx-frac atop=true delims=true style=vertical-align:-.686em type=d><mjx-num style=padding-bottom:.69em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-num><mjx-den><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-den></mjx-frac></mjx-mfrac><mjx-texatom data-latex="\biggr )" texclass=CLOSE><mjx-mo><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-texatom></mjx-mrow><mjx-mrow data-latex=\binom{s}{j}><mjx-texatom data-latex="\biggl (" texclass=OPEN><mjx-mo><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo></mjx-texatom><mjx-mfrac><mjx-frac atop=true delims=true style=vertical-align:-.686em type=d><mjx-num style=padding-bottom:.69em><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-num><mjx-den><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-den></mjx-frac></mjx-mfrac><mjx-texatom data-latex="\biggr )" texclass=CLOSE><mjx-mo><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-texatom></mjx-mrow><mjx-msubsup data-latex=x_1^{r-i}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={r-i} size=s texclass=ORD><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msubsup data-latex=y_1^{s-j}><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={s-j} size=s texclass=ORD><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-munder data-latex=\sum_{S_2} space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.351em><mjx-texatom data-latex={S_2} size=s texclass=ORD><mjx-msub data-latex=S_2><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.032em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^i space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex=y^j><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=j size=s><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\sum_{S_1+S_2}x^ry^s &= \sum_{S_1}x^ry^s + \sum_{S_2}(x+x_1)^r(y+y_1)^s \\&= \sum_{S_1}x^ry^s + \sum_{i=0}^r\sum_{j=0}^s\binom{r}{i}\binom{s}{j}x_1^{r-i}y_1^{s-j}\sum_{S_2}x^iy^j.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\sum_{S_1 +S_2 }x^ry^s &= \sum_{S_1 }x^ry^s + \sum_{S_2 }(x+x_1 )^r(y+y_1 )^s \\&= \sum_{S_1 }x^ry^s + \sum_{i=0}^r\sum_{j=0}^s\binom{r}{i}\binom{s}{j}x_1 ^{r-i}y_1 ^{s-j}\sum_{S_2 }x^iy^j.\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><munder data-latex=\sum_{S_1+S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1+S_2} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><msup data-latex=x^r><mi data-latex=x>x</mi><mi data-latex=r>r</mi></msup><msup data-latex=y^s><mi data-latex=y>y</mi><mi data-latex=s>s</mi></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><msup data-latex=x^r><mi data-latex=x>x</mi><mi data-latex=r>r</mi></msup><msup data-latex=y^s><mi data-latex=y>y</mi><mi data-latex=s>s</mi></msup><mo data-latex=+>+</mo><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><msup data-latex=)^r><mo data-latex=) stretchy=false>)</mo><mi data-latex=r>r</mi></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=+>+</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><msup data-latex=)^s><mo data-latex=) stretchy=false>)</mo><mi data-latex=s>s</mi></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex=\sum_{S_1}><mo data-latex=\sum>∑</mo><mrow data-latex={S_1} data-mjx-texclass=ORD><msub data-latex=S_1><mi data-latex=S>S</mi><mn data-latex=1>1</mn></msub></mrow></munder><msup data-latex=x^r><mi data-latex=x>x</mi><mi data-latex=r>r</mi></msup><msup data-latex=y^s><mi data-latex=y>y</mi><mi data-latex=s>s</mi></msup><mo data-latex=+>+</mo><munderover data-latex="\sum_{i=0}^r"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=r>r</mi></munderover><munderover data-latex="\sum_{j=0}^s"><mo data-latex=\sum>∑</mo><mrow data-latex="{j=0}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=s>s</mi></munderover><mrow data-latex=\binom{r}{i} data-mjx-texclass=ORD><mrow data-latex="\biggl (" data-mjx-texclass=OPEN><mo maxsize=2.047em minsize=2.047em>(</mo></mrow><mfrac linethickness=0><mi data-latex=r>r</mi><mi data-latex=i>i</mi></mfrac><mrow data-latex="\biggr )" data-mjx-texclass=CLOSE><mo maxsize=2.047em minsize=2.047em>)</mo></mrow></mrow><mrow data-latex=\binom{s}{j} data-mjx-texclass=ORD><mrow data-latex="\biggl (" data-mjx-texclass=OPEN><mo maxsize=2.047em minsize=2.047em>(</mo></mrow><mfrac linethickness=0><mi data-latex=s>s</mi><mi data-latex=j>j</mi></mfrac><mrow data-latex="\biggr )" data-mjx-texclass=CLOSE><mo maxsize=2.047em minsize=2.047em>)</mo></mrow></mrow><msubsup data-latex=x_1^{r-i}><mi data-latex=x>x</mi><mn data-latex=1>1</mn><mrow data-latex={r-i} data-mjx-texclass=ORD><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=i>i</mi></mrow></msubsup><msubsup data-latex=y_1^{s-j}><mi data-latex=y>y</mi><mn data-latex=1>1</mn><mrow data-latex={s-j} data-mjx-texclass=ORD><mi data-latex=s>s</mi><mo data-latex=->−</mo><mi data-latex=j>j</mi></mrow></msubsup><munder data-latex=\sum_{S_2}><mo data-latex=\sum>∑</mo><mrow data-latex={S_2} data-mjx-texclass=ORD><msub data-latex=S_2><mi data-latex=S>S</mi><mn data-latex=2>2</mn></msub></mrow></munder><msup data-latex=x^i><mi data-latex=x>x</mi><mi data-latex=i>i</mi></msup><msup data-latex=y^j><mi data-latex=y>y</mi><mi data-latex=j>j</mi></msup><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\sum_{S_1+S_2}x^ry^s &= \sum_{S_1}x^ry^s + \sum_{S_2}(x+x_1)^r(y+y_1)^s \\
&= \sum_{S_1}x^ry^s + \sum_{i=0}^r\sum_{j=0}^s\binom{r}{i}\binom{s}{j}x_1^{r-i}y_1^{s-j}\sum_{S_2}x^iy^j.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>只要维护好所有更低幂次的贡献，就可以计算一般情形的和式．</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>&</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>R</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>((</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>U</span><span class=w> </span><span class=o>*</span>
<span class=w>         </span><span class=n>euclid</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>)</span><span class=w> </span><span class=o>*</span>
<span class=w>         </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>);</span>
<span class=p>}</span>

<span class=k>constexpr</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>998244353</span><span class=p>;</span>

<span class=k>struct</span><span class=w> </span><span class=nc>Info</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>t</span><span class=p>,</span><span class=w> </span><span class=n>u</span><span class=p>;</span>

<span class=w>  </span><span class=n>Info</span><span class=p>()</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>x</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>y</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>s</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>t</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>u</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{}</span>

<span class=w>  </span><span class=n>Info</span><span class=w> </span><span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Info</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Info</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>y</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>t</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>t</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>u</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>u</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>u</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>};</span>

<span class=kt>void</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>Info</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>;</span>
<span class=w>  </span><span class=n>U</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=n>R</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>euclid</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>u</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)(</span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>c</span><span class=p>))</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>M</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>' '</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>' '</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>g</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=n>solve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><details class=example open><summary><a href=https://www.luogu.com.cn/problem/P5172 target=_blank>[清华集训 2014] Sum</a></summary> <p>多组询问．给定正整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container>，求</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor}.
" aria-hidden=true class=NCM-N display=true><mjx-munderover data-latex="\sum_{d=1}^n"><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{d=1}" size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=")^{\lfloor d\sqrt{r}\rfloor}"><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{\lfloor d\sqrt{r}\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor}." display=block xmlns=http://www.w3.org/1998/Math/MathML><munderover data-latex="\sum_{d=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{d=1}" data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=")^{\lfloor d\sqrt{r}\rfloor}"><mo data-latex=) stretchy=false>)</mo><mrow data-latex="{\lfloor d\sqrt{r}\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=d>d</mi><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{d=1}^n(-1)^{\lfloor d\sqrt{r}\rfloor}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note data-original-document-end=23385 data-original-document-start=22201><summary>解答二</summary> <p>首先，单独处理 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 为完全平方数的情形，与前文完全一致，从略．此处，仅考虑 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 不是完全平方数的情形．</p> <p>本题应用万能欧几里得算法的方式有很多．比如说，可以为每个操作定义一个线性变换：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
U(x) = -x,~ R(x) = x + 1.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1. space=3><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="U(x) = -x,~ R(x) = x + 1." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=->−</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=R>R</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mn data-latex=1.>1.</mn></math></mjx-assistive-mml><img title="
U(x) = -x,~ R(x) = x + 1.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>操作的乘法定义为线性变换的复合．那么，最终的答案就是操作序列对应的变换的复合得到的函数在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="x=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 处的值．</p> <p>还可以为每段操作序列定义它的贡献．贡献可以定义为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=((-1)^y,\sum(-1)^y)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^y><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mi data-latex=y size=s><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\sum space=2><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^y><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mi data-latex=y size=s><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=((-1)^y,\sum(-1)^y) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^y><mo data-latex=) stretchy=false>)</mo><mi data-latex=y>y</mi></msup><mo data-latex=,>,</mo><mo data-latex=\sum>∑</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^y><mo data-latex=) stretchy=false>)</mo><mi data-latex=y>y</mi></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=((-1)^y,\sum(-1)^y)></mjx-container>．那么，两个操作分别取</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
U = (0,-1),~ R = (1,1).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=- space=2><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="U = (0,-1),~ R = (1,1)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=R>R</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
U = (0,-1),~ R = (1,1).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>贡献的合并定义为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
(u_1,v_1)\cdot(u_2,v_2) = (u_1u_2,v_1+u_1v_2).
" aria-hidden=true class=NCM-N display=true><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=u_1><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=v_1 space=2><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=u_2><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=v_2 space=2><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=u_1><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=u_2><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=v_1 space=2><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=u_1 space=3><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=v_2><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="(u_1,v_1)\cdot(u_2,v_2) = (u_1u_2,v_1+u_1v_2)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=u_1><mi data-latex=u>u</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=v_1><mi data-latex=v>v</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=u_2><mi data-latex=u>u</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=v_2><mi data-latex=v>v</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=u_1><mi data-latex=u>u</mi><mn data-latex=1>1</mn></msub><msub data-latex=u_2><mi data-latex=u>u</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=v_1><mi data-latex=v>v</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=u_1><mi data-latex=u>u</mi><mn data-latex=1>1</mn></msub><msub data-latex=v_2><mi data-latex=v>v</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
(u_1,v_1)\cdot(u_2,v_2) = (u_1u_2,v_1+u_1v_2).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>容易验证，在该乘法下，所有操作构成了幺半群，且单位元为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(0,1)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(0,1) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(0,1)></mjx-container>．最终的答案就是所有元素乘积的第二个分量．</p> <p>这两种方法是一致的，因为如果将线性变换写作 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)=u+vx" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=u space=4><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)=u+vx" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=u>u</mi><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mi data-latex=x>x</mi></math></mjx-assistive-mml><img title="f(x)=u+vx" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么线性变换的复合对应的系数的变化，恰恰就是上述操作的乘法．也就是说，这两个幺半群是同构的．</p> <p>本题中，线段的参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(k,n)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(k,n) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(k,n)></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k\in\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k\in\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex=\in>∈</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="k\in\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为直线的斜率．设操作序列对应的乘积为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=F(k,n,U,R)><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=F(k,n,U,R) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=F(k,n,U,R)></mjx-container>．那么，有如下递归算法：</p> <ul><li><p>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k\ge 1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k\ge 1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex=\ge>≥</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="k\ge 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么操作序列中每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container> 前方都有至少 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor k\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor k\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor k\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>，所以，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(k,n,U,R) = F(k-\lfloor k\rfloor,n,U,U^{\lfloor k\rfloor} R).
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=F space=4><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=3><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex="U^{\lfloor k\rfloor}" space=2><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.054em><mjx-texatom data-latex="{\lfloor k\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="F(k,n,U,R) = F(k-\lfloor k\rfloor,n,U,U^{\lfloor k\rfloor} R)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><msup data-latex="U^{\lfloor k\rfloor}"><mi data-latex=U>U</mi><mrow data-latex="{\lfloor k\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=k>k</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(k,n,U,R) = F(k-\lfloor k\rfloor,n,U,U^{\lfloor k\rfloor} R).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><p>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k<1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k<1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex="<">&lt;</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="k<1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么交换操作序列中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>，并舍去末尾的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container>（即交换前的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=R><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=R xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=R>R</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=R></mjx-container>），所以，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
F(k,n,U,R) = F(k^{-1},m,R,U)R^{n-\lfloor k^{-1}m\rfloor}.
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=F><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=F space=4><mjx-c class=mjx-c1D439>𝐹</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=k^{-1}><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=R space=2><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=U space=2><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex="R^{n-\lfloor k^{-1}m\rfloor}"><mjx-mi data-latex=R><mjx-c class=mjx-c1D445>𝑅</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{n-\lfloor k^{-1}m\rfloor}" size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-msup data-latex=k^{-1}><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="F(k,n,U,R) = F(k^{-1},m,R,U)R^{n-\lfloor k^{-1}m\rfloor}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=F>F</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=k^{-1}><mi data-latex=k>k</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=,>,</mo><mi data-latex=R>R</mi><mo data-latex=,>,</mo><mi data-latex=U>U</mi><mo data-latex=) stretchy=false>)</mo><msup data-latex="R^{n-\lfloor k^{-1}m\rfloor}"><mi data-latex=R>R</mi><mrow data-latex="{n-\lfloor k^{-1}m\rfloor}" data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><msup data-latex=k^{-1}><mi data-latex=k>k</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mi data-latex=m>m</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
F(k,n,U,R) = F(k^{-1},m,R,U)R^{n-\lfloor k^{-1}m\rfloor}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li></ul> <p>算法中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 的迭代过程其实就是在求 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\sqrt{r}><mjx-msqrt data-latex=\sqrt{r}><mjx-sqrt><mjx-surd><mjx-mo><mjx-c class=mjx-c221A>√</mjx-c></mjx-mo></mjx-surd><mjx-box style=padding-top:.281em><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\sqrt{r} xmlns=http://www.w3.org/1998/Math/MathML><msqrt data-latex=\sqrt{r}><mi data-latex=r>r</mi></msqrt></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\sqrt{r}></mjx-container> 的连分数展开．为此，可以应用 <a href=../pell-equation/#pqa-算法>PQa 算法</a>．求连分数的过程和万能欧几里得算法迭代的过程可以同时进行．</p> <p>和类欧几里得算法的情形一致，算法的复杂度仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log n)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log n)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的．</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cmath></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>

<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>></span>
<span class=n>T</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>>>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>&</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>struct</span><span class=w> </span><span class=nc>LinearTransform</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>u</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>;</span>

<span class=w>  </span><span class=n>LinearTransform</span><span class=p>()</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>u</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=n>v</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{}</span>

<span class=w>  </span><span class=n>LinearTransform</span><span class=w> </span><span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>LinearTransform</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>LinearTransform</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>u</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>u</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>u</span><span class=p>;</span>
<span class=w>    </span><span class=n>res</span><span class=p>.</span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rhs</span><span class=p>.</span><span class=n>v</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>eval</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>u</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
<span class=p>};</span>

<span class=kt>int</span><span class=w> </span><span class=nf>solve</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>sqrt_r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sqrtl</span><span class=p>(</span><span class=n>r</span><span class=p>);</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>sqr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sqrt_r</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>sqr</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqr</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>sqr</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>-1</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=n>LinearTransform</span><span class=w> </span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>;</span>
<span class=w>  </span><span class=n>U</span><span class=p>.</span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span>
<span class=w>  </span><span class=n>R</span><span class=p>.</span><span class=n>u</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>P</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sqr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>Q</span><span class=p>;</span>
<span class=w>    </span><span class=n>R</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>R</span><span class=p>;</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>((</span><span class=n>P</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sqrt_r</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>    </span><span class=n>P</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>Q</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>P</span><span class=p>;</span>
<span class=w>    </span><span class=n>Q</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>D</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>P</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>Q</span><span class=p>;</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>rem</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)(</span><span class=n>m</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>P</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sqrt_r</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>Q</span><span class=p>);</span>
<span class=w>    </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pow</span><span class=p>(</span><span class=n>R</span><span class=p>,</span><span class=w> </span><span class=n>rem</span><span class=p>).</span><span class=n>eval</span><span class=p>(</span><span class=n>val</span><span class=p>);</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>U</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=p>);</span>
<span class=w>    </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(;</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>r</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>solve</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><h2 data-original-document-end=23392 data-original-document-start=23387 id=习题>习题<a title="Permanent link" class=headerlink href=#习题></a></h2><p data-original-document-end=23398 data-original-document-start=23394>模板题：</p><ul data-original-document-end=24040 data-original-document-start=23400><li><a href=https://judge.yosupo.jp/problem/sum_of_floor_of_linear target=_blank>Library Checker - Sum of Floor of Linear</a></li><li><a href=https://www.luogu.com.cn/problem/P5170 target=_blank>Luogu P5170【模板】类欧几里得算法</a></li><li><a href=https://www.luogu.com.cn/problem/P5171 target=_blank>Luogu P5171 Earthquake</a></li><li><a href=https://www.luogu.com.cn/problem/P5172 target=_blank>Luogu P5172 [清华集训 2014] Sum</a></li><li><a href=https://www.luogu.com.cn/problem/P4132 target=_blank>Luogu P4132 [BJOI2012] 算不出的等式</a></li><li><a href=https://loj.ac/p/138 target=_blank>LOJ 138. 类欧几里得算法</a></li><li><a href=https://loj.ac/p/6440 target=_blank>LOJ 6440. 万能欧几里得</a></li><li><a href=https://www.luogu.com.cn/problem/P5179 target=_blank>Luogu P5179 Fraction</a></li><li><a href=https://codeforces.com/problemset/problem/1182/F target=_blank>Codeforces 1182 F. Maximum Sine</a></li></ul><p data-original-document-end=24046 data-original-document-start=24042>应用题：</p><ul data-original-document-end=24633 data-original-document-start=24048><li><a href=https://www.luogu.com.cn/problem/P4433 target=_blank>Luogu P4433 [COCI 2009/2010 #1] ALADIN</a></li><li><a href=https://atcoder.jp/contests/abc372/tasks/abc372_g target=_blank>AtCoder Beginner Contest 372 G - Ax + By &lt; C</a></li><li><a href=https://atcoder.jp/contests/abc313/tasks/abc313_g target=_blank>AtCoder Beginner Contest 313 G - Redistribution of Piles</a></li><li><a href=https://atcoder.jp/contests/abc283/tasks/abc283_h target=_blank>AtCoder Beginner Contest 283 Ex - Popcount Sum</a></li><li><a href=https://codeforces.com/problemset/problem/1098/E target=_blank>Codeforces 1098 E. Fedya the Potter</a></li><li><a href=https://codeforces.com/problemset/problem/868/G target=_blank>Codeforces 868 G. El Toll Caves</a></li></ul><h2 data-original-document-end=24920 data-original-document-start=24635 id=参考资料与注释>参考资料与注释<a title="Permanent link" class=headerlink href=#参考资料与注释></a></h2><div class=footnote><hr><ol><li id=fn:complexity><p>通常考虑的问题中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=b><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=b></mjx-container> 都与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 同阶，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(\log(b/c))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mrow data-latex=)><mjx-mo><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(\log(b/c)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mrow data-latex=)><mo data-mjx-texclass=OPEN>(</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=c>c</mi><mo data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(\log(b/c))></mjx-container> 这一项可以忽略．而且，如果在调用万能欧几里得算法前，首先进行了一轮类欧几里得算法的取模，消除 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=b><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=b></mjx-container> 的影响，这一项的快速幂的复杂度是可以规避的．这其实是因为通常的问题中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 的初始形式较为特殊，它的幂次有着更简单的形式，不需要通过快速幂计算．比如正文的例子中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="U^{\lfloor b/a\rfloor}" aria-hidden=true class=NCM-N><mjx-msup data-latex="U^{\lfloor b/a\rfloor}"><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.054em><mjx-texatom data-latex="{\lfloor b/a\rfloor}" size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="U^{\lfloor b/a\rfloor}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="U^{\lfloor b/a\rfloor}"><mi data-latex=U>U</mi><mrow data-latex="{\lfloor b/a\rfloor}" data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup></math></mjx-assistive-mml><img title="U^{\lfloor b/a\rfloor}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的结果，就是将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=U><mjx-mi data-latex=U><mjx-c class=mjx-c1D448>𝑈</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=U xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=U>U</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=U></mjx-container> 中不在对角线上的那个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container> 替换成 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor b/a\rfloor" aria-hidden=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor b/a\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=b>b</mi><mo data-latex=/>/</mo><mi data-latex=a>a</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor b/a\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，而无需用快速幂计算． <a title="Jump back to footnote 1 in the text" class=footnote-backref href=#fnref:complexity>↩</a></p></li></ol></div><hr><blockquote class=page-copyright><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"></path></svg></i>本页面最近更新：</span><span class=facts_modified>2026/1/7 08:56:54</span>，<a class=edit_history href=https://github.com/OI-wiki/OI-wiki/commits/master/docs/math/number-theory/euclidean.md target=_blank>更新历史</a><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"></path></svg></i>发现错误？想一起完善？ <a href="https://oi-wiki.org/edit-landing/?ref=/math/number-theory/euclidean.md" class=page_edit_url title=edit.link.title>在 GitHub 上编辑此页！</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M16 17v2H2v-2s0-4 7-4 7 4 7 4m-3.5-9.5A3.5 3.5 0 1 0 9 11a3.5 3.5 0 0 0 3.5-3.5m3.44 5.5A5.32 5.32 0 0 1 18 17v2h4v-2s0-3.63-6.06-4M15 4a3.4 3.4 0 0 0-1.93.59 5 5 0 0 1 0 5.82A3.4 3.4 0 0 0 15 11a3.5 3.5 0 0 0 0-7"></path></svg></i>本页面贡献者：</span><span class=page_contributors><a href=https://github.com/sshwy target=_blank>sshwy</a>, <a href=https://github.com/StudyingFather target=_blank>StudyingFather</a>, <a href=https://github.com/Enter-tainer target=_blank>Enter-tainer</a>, <a href=https://github.com/Tiphereth-A target=_blank>Tiphereth-A</a>, <a href=https://github.com/H-J-Granger target=_blank>H-J-Granger</a>, <a href=https://github.com/countercurrent-time target=_blank>countercurrent-time</a>, <a href=https://github.com/NachtgeistW target=_blank>NachtgeistW</a>, <a href=https://github.com/c-forrest target=_blank>c-forrest</a>, <a href=https://github.com/Early0v0 target=_blank>Early0v0</a>, <a href=https://github.com/Ir1d target=_blank>Ir1d</a>, <a href=https://github.com/MegaOwIer target=_blank>MegaOwIer</a>, <a href=https://github.com/Xeonacid target=_blank>Xeonacid</a>, <a href=https://github.com/AngelKitty target=_blank>AngelKitty</a>, <a href=https://github.com/CCXXXI target=_blank>CCXXXI</a>, <a href=https://github.com/cjsoft target=_blank>cjsoft</a>, <a href=https://github.com/diauweb target=_blank>diauweb</a>, <a href=https://github.com/ezoixx130 target=_blank>ezoixx130</a>, <a href=https://github.com/FFjet target=_blank>FFjet</a>, <a href=https://github.com/GekkaSaori target=_blank>GekkaSaori</a>, <a href=https://github.com/Henry-ZHR target=_blank>Henry-ZHR</a>, <a href=https://github.com/Konano target=_blank>Konano</a>, <a href=https://github.com/LovelyBuggies target=_blank>LovelyBuggies</a>, <a href=https://github.com/Makkiy target=_blank>Makkiy</a>, <a href=mailto:i@margatroid.xyz target=_blank>mgt</a>, <a href=https://github.com/minghu6 target=_blank>minghu6</a>, <a href=https://github.com/P-Y-Y target=_blank>P-Y-Y</a>, <a href=https://github.com/PotassiumWings target=_blank>PotassiumWings</a>, <a href=https://github.com/qz-cqy target=_blank>qz-cqy</a>, <a href=https://github.com/SamZhangQingChuan target=_blank>SamZhangQingChuan</a>, <a href=mailto:suyun514@qq.com target=_blank>Suyun514</a>, <a href=https://github.com/weiyong1024 target=_blank>weiyong1024</a>, <a href=https://github.com/alphagocc target=_blank>alphagocc</a>, <a href=https://github.com/cxm1024 target=_blank>cxm1024</a>, <a href=https://github.com/GavinZhengOI target=_blank>GavinZhengOI</a>, <a href=https://github.com/Gesrua target=_blank>Gesrua</a>, <a href=https://github.com/Great-designer target=_blank>Great-designer</a>, <a href=https://github.com/iamtwz target=_blank>iamtwz</a>, <a href=https://github.com/ksyx target=_blank>ksyx</a>, <a href=https://github.com/kxccc target=_blank>kxccc</a>, <a href=https://github.com/lychees target=_blank>lychees</a>, <a href=https://github.com/megakite target=_blank>megakite</a>, <a href=https://github.com/Peanut-Tang target=_blank>Peanut-Tang</a>, <a href=https://github.com/r-value target=_blank>r-value</a>, <a href=https://github.com/SukkaW target=_blank>SukkaW</a>, <a href=https://github.com/TonyYin0418 target=_blank>TonyYin0418</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10.08 10.86c.05-.33.16-.62.3-.86.3-.56.81-.85 1.5-.86.45 0 .86.2 1.15.49.28.31.47.74.47 1.17h1.8c-.02-.47-.11-.9-.3-1.3-.15-.38-.38-.72-.68-1-1.45-1.34-4.14-1.15-5.37.37-1.29 1.67-1.32 4.59-.01 6.26 1.21 1.49 3.86 1.7 5.3.37.31-.25.56-.56.76-.92.16-.36.27-.74.28-1.15H13.5c0 .21-.07.4-.16.57-.09.19-.21.34-.34.47-.33.26-.72.4-1.14.4-.36-.01-.66-.08-.89-.23a1.4 1.4 0 0 1-.59-.64c-.5-.9-.42-2.15-.3-3.14M12 2C6.5 2 2 6.5 2 12c.53 13.27 19.5 13.26 20 0 0-5.5-4.5-10-10-10m0 18c-4.41 0-8-3.59-8-8 .44-10.61 15.56-10.61 16 0 0 4.41-3.59 8-8 8"></path></svg></i>本页面的全部内容在 <strong><a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh target=_blank>CC BY-SA 4.0</a> 和 <a href=https://github.com/zTrix/sata-license target=_blank>SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span></blockquote><div class=giscus data-no-instant id=__comments></div><div id=__comments_script></div><script>var comments=document.createElement("script"),commentsTheme="slate"===document.body.dataset.mdColorScheme?"dark":"light";Object.entries({async:!0,src:"https://giscus.app/client.js",crossOrigin:"anonymous","data-repo":"OI-wiki/gitment","data-repo-id":"MDEwOlJlcG9zaXRvcnkxNDQzODg5NjU=","data-category":"评论","data-category-id":"DIC_kwDOCJszZc4CS54y","data-mapping":"specific","data-term":"类欧几里德算法","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":commentsTheme,"data-lang":"zh-CN","data-loading":"lazy"}).forEach((e=>comments.setAttribute(e[0],e[1]))),document.getElementById("__comments_script").replaceWith(comments)</script></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><script>function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script><button class=data-tip-left data-tip=回到顶部 id=myBtn onclick=topFunction()><svg class="Zi Zi--BackToTop data-tip-left" viewbox="0 0 24 24" data-tip=回到顶部 fill=currentColor height=24 width=24><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight>Copyright © 2016 - 2026 OI Wiki Team</div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs <div id=miitbeian></div> </a></div><div class=build_date_utc style=float:right><a href=https://github.com/OI-wiki/OI-wiki target=_blank> 最近更新：1b96d637c, 2026-02-25 </a></div><script>"oi-wiki.com"!=window.location.hostname&&"www.oi-wiki.com"!=window.location.hostname||(document.getElementById("miitbeian").innerHTML='<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>'),console.log("%c OI Wiki %c 1b96d637c %c","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),console.log("少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org")</script></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../../..", "features": ["content.action.edit", "navigation.tabs", "navigation.instant", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.931a43a5.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script><script src=../../../assets/javascripts/bundle.73202423.min.js></script><script src="../../../assets/javascripts/oiwiki-feedback-sys-frontend.js?v=5b99436423505efd4a4e01c1b294beee"></script><script src="../../../_static/js/oiwiki-feedback-sys-frontend.js?v=9c84250724ffe2e409ef6df0cac8900b"></script><script>"use strict";"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then((function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)})).catch((function(e){console.log("PWA Registration failed with "+e)}))</script></body></html>