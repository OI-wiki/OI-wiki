<!doctype html><html class=no-js lang=zh-Hans><meta charset=utf-8><meta content=on http-equiv=x-dns-prefetch-control><link href=//oi-wiki.org rel=dns-prefetch><link href=//search.oi-wiki.org rel=dns-prefetch><link href=//api.github.com rel=dns-prefetch><link href=//www.google-analytics.com rel=dns-prefetch><meta content="width=device-width,initial-scale=1" name=viewport><meta content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛" name=description><meta content="hly1204, ShaoChenHeng, Chrogeek, Enter-tainer, Great-designer, iamtwz, monkeysui, nanmenyangde, rgw2010, sshwy, StudyingFather, TachikakaMin, Tiphereth-A, Xeonacid, xyf007, marscheng1" name=author><link href=https://oi-wiki.org/math/number-theory/quad-residue/ rel=canonical><link href=../congruence-equation/ rel=prev><link href=../primitive-root/ rel=next><link href=../../../favicon.ico rel=icon><meta content="mkdocs-1.5.3, mkdocs-material-9.6.15" name=generator><title>二次剩余 - OI Wiki</title><link href=../../../assets/stylesheets/main.bd3167ff.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}@font-face{font-family:Fira Sans;font-style:normal;font-weight:300;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:italic;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot);src:local(Fira Sans),local(FiraSans-Italic),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:normal;font-weight:700;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans)format("svg")}@font-face{font-family:Fira Mono;font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot);src:local(Fira Mono),local(FiraMono-Normal),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono)format("svg")}</style><link href="../../../_static/css/extra.css?v=16" rel=stylesheet><link href="../../../assets/stylesheets/oiwiki-feedback-sys-frontend.css?v=202763fcae134a48bc639c9f3cde9d46" rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-124485594-1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-124485594-1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-124485594-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><script src=../../../assets/javascripts/toggle-sidebar.js></script><link href="../../../assets/stylesheets/mathjax.css?hash=3b97f50827c49ac9c18bf068907fb9c8f7c03fea7566ddb8026d26336f0ef684" rel=stylesheet></head><body data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#引入> 跳转至 </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=页眉><a aria-label="OI Wiki" class="md-header__button md-logo" title="OI Wiki" data-md-component=logo href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"></path></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OI Wiki </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> 二次剩余 </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" data-md-color-media="(prefers-color-scheme: light)" class=md-option data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg></label><input aria-label="Switch to light mode" data-md-color-media="(prefers-color-scheme: dark)" class=md-option data-md-color-accent=blue data-md-color-primary=blue data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=搜索 autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=搜索 required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg></label><nav aria-label=查找 class=md-search__options><button class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1 title=清空当前内容 type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>正在初始化搜索引擎</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a class=md-source data-md-component=source href=https://github.com/OI-wiki/OI-wiki target=_blank title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg></div> <div class=md-source__repository>OI-wiki/OI-wiki</div> </a></div></nav></header><div class=md-container data-md-component=container><nav aria-label=标签 class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../../..> 简介 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../contest/> 比赛相关 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../tools/> 工具软件 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../lang/> 语言基础 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../basic/> 算法基础 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../search/> 搜索 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../dp/> 动态规划 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../string/> 字符串 </a></li><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../../> 数学 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../ds/> 数据结构 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../graph/> 图论 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../geometry/> 计算几何 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../misc/> 杂项 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../topic/rmq/> 专题 </a></li></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OI Wiki" class="md-nav__button md-logo" title="OI Wiki" data-md-component=logo href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"></path></svg> </a> OI Wiki</label><div class=md-nav__source><a class=md-source data-md-component=source href=https://github.com/OI-wiki/OI-wiki target=_blank title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg></div> <div class=md-source__repository>OI-wiki/OI-wiki</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_1 type=checkbox> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0><span class=md-ellipsis> 简介 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_1_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_1><span class="md-nav__icon md-icon"></span> 简介</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../..> <span class=md-ellipsis> Getting Started </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/about/> <span class=md-ellipsis> 关于本项目 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/htc/> <span class=md-ellipsis> 如何参与 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/what-oi-wiki-is-not/> <span class=md-ellipsis> OI Wiki 不是什么 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/format/> <span class=md-ellipsis> 格式手册 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/symbol/> <span class=md-ellipsis> 数学符号表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/faq/> <span class=md-ellipsis> F.A.Q. </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/mirrors/> <span class=md-ellipsis> 镜像站列表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/thanks/> <span class=md-ellipsis> 致谢 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0><span class=md-ellipsis> 比赛相关 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_2><span class="md-nav__icon md-icon"></span> 比赛相关</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/> <span class=md-ellipsis> 比赛相关简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_2 type=checkbox> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0><span class=md-ellipsis> 赛事 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_2><span class="md-nav__icon md-icon"></span> 赛事</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/oi/> <span class=md-ellipsis> OI 赛事与赛制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/icpc/> <span class=md-ellipsis> ICPC/CCPC 赛事与赛制 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_3 type=checkbox> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0><span class=md-ellipsis> 题型 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_3><span class="md-nav__icon md-icon"></span> 题型</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/problems/> <span class=md-ellipsis> 题型概述 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/interaction/> <span class=md-ellipsis> 交互题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/roadmap/> <span class=md-ellipsis> 学习路线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/resources/> <span class=md-ellipsis> 学习资源 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_6 type=checkbox> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0><span class=md-ellipsis> 技巧 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_6><span class="md-nav__icon md-icon"></span> 技巧</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/io/> <span class=md-ellipsis> 读入、输出优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/dictionary/> <span class=md-ellipsis> 分段打表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/common-mistakes/> <span class=md-ellipsis> 常见错误 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/common-tricks/> <span class=md-ellipsis> 常见技巧 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/problemsetting/> <span class=md-ellipsis> 出题 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0><span class=md-ellipsis> 工具软件 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> 工具软件</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/> <span class=md-ellipsis> 工具软件简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_2 type=checkbox> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0><span class=md-ellipsis> 代码编辑工具 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_2><span class="md-nav__icon md-icon"></span> 代码编辑工具</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/vim/> <span class=md-ellipsis> Vim </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/emacs/> <span class=md-ellipsis> Emacs </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/vscode/> <span class=md-ellipsis> VS Code </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/atom/> <span class=md-ellipsis> Atom </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/eclipse/> <span class=md-ellipsis> Eclipse </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/npp/> <span class=md-ellipsis> Notepad++ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/kate/> <span class=md-ellipsis> Kate </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/devcpp/> <span class=md-ellipsis> Dev-C++ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/clion/> <span class=md-ellipsis> CLion </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/geany/> <span class=md-ellipsis> Geany </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/xcode/> <span class=md-ellipsis> Xcode </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/guide/> <span class=md-ellipsis> GUIDE </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/sublime/> <span class=md-ellipsis> Sublime Text </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/cpeditor/> <span class=md-ellipsis> CP Editor </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/codeblocks/> <span class=md-ellipsis> Code::Blocks </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_3 type=checkbox> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0><span class=md-ellipsis> 评测工具 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_3><span class="md-nav__icon md-icon"></span> 评测工具</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/> <span class=md-ellipsis> 评测工具简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/arbiter/> <span class=md-ellipsis> Arbiter </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/cena/> <span class=md-ellipsis> Cena </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/ccr-plus/> <span class=md-ellipsis> CCR Plus </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/lemon/> <span class=md-ellipsis> Lemon </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/cmd/> <span class=md-ellipsis> 命令行 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/compile-debug/> <span class=md-ellipsis> 命令行编译与调试 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/compiler/> <span class=md-ellipsis> 编译器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/wsl/> <span class=md-ellipsis> WSL (Windows 10) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/special-judge/> <span class=md-ellipsis> Special Judge </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_9 type=checkbox> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex=0><span class=md-ellipsis> Testlib </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_9_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_9><span class="md-nav__icon md-icon"></span> Testlib</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/> <span class=md-ellipsis> Testlib 简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/general/> <span class=md-ellipsis> 通用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/generator/> <span class=md-ellipsis> Generator </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/validator/> <span class=md-ellipsis> Validator </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/interactor/> <span class=md-ellipsis> Interactor </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/checker/> <span class=md-ellipsis> Checker </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/polygon/> <span class=md-ellipsis> Polygon </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/oj-tool/> <span class=md-ellipsis> OJ 工具 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/latex/> <span class=md-ellipsis> LaTeX 入门 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/git/> <span class=md-ellipsis> Git </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0><span class=md-ellipsis> 语言基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_4><span class="md-nav__icon md-icon"></span> 语言基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/> <span class=md-ellipsis> 语言基础简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2 type=checkbox> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0><span class=md-ellipsis> C++ 基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_2><span class="md-nav__icon md-icon"></span> C++ 基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/helloworld/> <span class=md-ellipsis> Hello, World! </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/basic/> <span class=md-ellipsis> C++ 语法基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/var/> <span class=md-ellipsis> 变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/op/> <span class=md-ellipsis> 运算 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2_5 type=checkbox> <label class=md-nav__link for=__nav_4_2_5 id=__nav_4_2_5_label tabindex=0><span class=md-ellipsis> 流程控制语句 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_5_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_2_5><span class="md-nav__icon md-icon"></span> 流程控制语句</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/branch/> <span class=md-ellipsis> 分支 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/loop/> <span class=md-ellipsis> 循环 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2_6 type=checkbox> <label class=md-nav__link for=__nav_4_2_6 id=__nav_4_2_6_label tabindex=0><span class=md-ellipsis> 高级数据类型 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_6_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_2_6><span class="md-nav__icon md-icon"></span> 高级数据类型</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/array/> <span class=md-ellipsis> 数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/struct/> <span class=md-ellipsis> 结构体 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/union/> <span class=md-ellipsis> 联合体 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pointer/> <span class=md-ellipsis> 指针 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/func/> <span class=md-ellipsis> 函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/file-op/> <span class=md-ellipsis> 文件操作 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_3 type=checkbox> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0><span class=md-ellipsis> C++ 标准库 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_3><span class="md-nav__icon md-icon"></span> C++ 标准库</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/> <span class=md-ellipsis> C++ 标准库简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_3_2 type=checkbox> <label class=md-nav__link for=__nav_4_3_2 id=__nav_4_3_2_label tabindex=0><span class=md-ellipsis> STL 容器 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_3_2_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_3_2><span class="md-nav__icon md-icon"></span> STL 容器</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/container/> <span class=md-ellipsis> STL 容器简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/iterator/> <span class=md-ellipsis> 迭代器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/sequence-container/> <span class=md-ellipsis> 序列式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/associative-container/> <span class=md-ellipsis> 关联式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/unordered-container/> <span class=md-ellipsis> 无序关联式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/container-adapter/> <span class=md-ellipsis> 容器适配器 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/algorithm/> <span class=md-ellipsis> STL 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/bitset/> <span class=md-ellipsis> bitset </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/string/> <span class=md-ellipsis> string </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/pair/> <span class=md-ellipsis> pair </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_4 type=checkbox> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0><span class=md-ellipsis> C++ 进阶 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_4_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_4><span class="md-nav__icon md-icon"></span> C++ 进阶</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/class/> <span class=md-ellipsis> 类 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/namespace/> <span class=md-ellipsis> 命名空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/value-category/> <span class=md-ellipsis> 值类别 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/op-overload/> <span class=md-ellipsis> 重载运算符 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/reference/> <span class=md-ellipsis> 引用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/const/> <span class=md-ellipsis> 常量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/new/> <span class=md-ellipsis> 新版 C++ 特性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/lambda/> <span class=md-ellipsis> Lambda 表达式 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_4_9 type=checkbox> <label class=md-nav__link for=__nav_4_4_9 id=__nav_4_4_9_label tabindex=0><span class=md-ellipsis> pb_ds </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_4_9_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_4_9><span class="md-nav__icon md-icon"></span> pb_ds</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/> <span class=md-ellipsis> pb_ds 简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/pq/> <span class=md-ellipsis> 堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/tree/> <span class=md-ellipsis> 平衡树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/optimizations/> <span class=md-ellipsis> 编译优化 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/cpp-other-langs/> <span class=md-ellipsis> C++ 与其他常用语言的区别 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pas-cpp/> <span class=md-ellipsis> Pascal 转 C++ 急救 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/python/> <span class=md-ellipsis> Python 速成 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/java/> <span class=md-ellipsis> Java 速成 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/java-pro/> <span class=md-ellipsis> Java 进阶 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5 type=checkbox> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0><span class=md-ellipsis> 算法基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> 算法基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/> <span class=md-ellipsis> 算法基础简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5_2 type=checkbox> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0><span class=md-ellipsis> 复杂度 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_5_2><span class="md-nav__icon md-icon"></span> 复杂度</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/complexity/> <span class=md-ellipsis> 复杂度简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/amortized-analysis/> <span class=md-ellipsis> 均摊复杂度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/enumerate/> <span class=md-ellipsis> 枚举 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/simulate/> <span class=md-ellipsis> 模拟 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/divide-and-conquer/> <span class=md-ellipsis> 递归 & 分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/greedy/> <span class=md-ellipsis> 贪心 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5_7 type=checkbox> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0><span class=md-ellipsis> 排序 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_7_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_5_7><span class="md-nav__icon md-icon"></span> 排序</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/sort-intro/> <span class=md-ellipsis> 排序简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/selection-sort/> <span class=md-ellipsis> 选择排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/bubble-sort/> <span class=md-ellipsis> 冒泡排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/insertion-sort/> <span class=md-ellipsis> 插入排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/counting-sort/> <span class=md-ellipsis> 计数排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/radix-sort/> <span class=md-ellipsis> 基数排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/quick-sort/> <span class=md-ellipsis> 快速排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/merge-sort/> <span class=md-ellipsis> 归并排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/heap-sort/> <span class=md-ellipsis> 堆排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/bucket-sort/> <span class=md-ellipsis> 桶排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/shell-sort/> <span class=md-ellipsis> 希尔排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/tournament-sort/> <span class=md-ellipsis> 锦标赛排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/tim-sort/> <span class=md-ellipsis> Tim 排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/stl-sort/> <span class=md-ellipsis> 排序相关 STL </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/use-of-sort/> <span class=md-ellipsis> 排序应用 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/prefix-sum/> <span class=md-ellipsis> 前缀和 & 差分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/binary/> <span class=md-ellipsis> 二分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/binary-lifting/> <span class=md-ellipsis> 倍增 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/construction/> <span class=md-ellipsis> 构造 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_6 type=checkbox> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0><span class=md-ellipsis> 搜索 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> 搜索</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../search/> <span class=md-ellipsis> 搜索部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/dfs/> <span class=md-ellipsis> DFS（搜索） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/bfs/> <span class=md-ellipsis> BFS（搜索） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/bidirectional/> <span class=md-ellipsis> 双向搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/heuristic/> <span class=md-ellipsis> 启发式搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/astar/> <span class=md-ellipsis> A* </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/iterative/> <span class=md-ellipsis> 迭代加深搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/idastar/> <span class=md-ellipsis> IDA* </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/backtracking/> <span class=md-ellipsis> 回溯法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/dlx/> <span class=md-ellipsis> Dancing Links </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/alpha-beta/> <span class=md-ellipsis> Alpha–Beta 剪枝 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/opt/> <span class=md-ellipsis> 优化 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_7 type=checkbox> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0><span class=md-ellipsis> 动态规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_7_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_7><span class="md-nav__icon md-icon"></span> 动态规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../dp/> <span class=md-ellipsis> 动态规划部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/basic/> <span class=md-ellipsis> 动态规划基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/memo/> <span class=md-ellipsis> 记忆化搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/knapsack/> <span class=md-ellipsis> 背包 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/interval/> <span class=md-ellipsis> 区间 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/dag/> <span class=md-ellipsis> DAG 上的 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/tree/> <span class=md-ellipsis> 树形 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/state/> <span class=md-ellipsis> 状压 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/number/> <span class=md-ellipsis> 数位 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/plug/> <span class=md-ellipsis> 插头 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/count/> <span class=md-ellipsis> 计数 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/dynamic/> <span class=md-ellipsis> 动态 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/probability/> <span class=md-ellipsis> 概率 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/dp-of-dp/> <span class=md-ellipsis> DP 套 DP </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_7_15 type=checkbox> <label class=md-nav__link for=__nav_7_15 id=__nav_7_15_label tabindex=0><span class=md-ellipsis> DP 优化 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_7_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_7_15><span class="md-nav__icon md-icon"></span> DP 优化</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/dp-opt/> <span class=md-ellipsis> DP 优化简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/monotonous-queue-stack/> <span class=md-ellipsis> 单调队列/单调栈优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/slope/> <span class=md-ellipsis> 斜率优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/quadrangle/> <span class=md-ellipsis> 四边形不等式优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/slope-trick/> <span class=md-ellipsis> Slope Trick 优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/wqs-binary-search/> <span class=md-ellipsis> WQS 二分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/opt/state/> <span class=md-ellipsis> 状态设计优化 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../dp/misc/> <span class=md-ellipsis> 其它 DP 方法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_8 type=checkbox> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0><span class=md-ellipsis> 字符串 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_8_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_8><span class="md-nav__icon md-icon"></span> 字符串</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../string/> <span class=md-ellipsis> 字符串部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/basic/> <span class=md-ellipsis> 字符串基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/lib-func/> <span class=md-ellipsis> 标准库 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/match/> <span class=md-ellipsis> 字符串匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/hash/> <span class=md-ellipsis> 字符串哈希 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/trie/> <span class=md-ellipsis> 字典树 (Trie) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/kmp/> <span class=md-ellipsis> 前缀函数与 KMP 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/bm/> <span class=md-ellipsis> Boyer–Moore 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/z-func/> <span class=md-ellipsis> Z 函数（扩展 KMP） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/ac-automaton/> <span class=md-ellipsis> AC 自动机 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_8_11 type=checkbox> <label class=md-nav__link for=__nav_8_11 id=__nav_8_11_label tabindex=0><span class=md-ellipsis> 后缀数组 (SA) </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_8_11_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_8_11><span class="md-nav__icon md-icon"></span> 后缀数组 (SA)</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../string/sa/> <span class=md-ellipsis> 后缀数组简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/sa-optimal-inplace/> <span class=md-ellipsis> 最优原地后缀排序算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../string/sam/> <span class=md-ellipsis> 后缀自动机 (SAM) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/suffix-bst/> <span class=md-ellipsis> 后缀平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/general-sam/> <span class=md-ellipsis> 广义后缀自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/suffix-tree/> <span class=md-ellipsis> 后缀树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/manacher/> <span class=md-ellipsis> Manacher </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/pam/> <span class=md-ellipsis> 回文树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/seq-automaton/> <span class=md-ellipsis> 序列自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/minimal-string/> <span class=md-ellipsis> 最小表示法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/lyndon/> <span class=md-ellipsis> Lyndon 分解 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/main-lorentz/> <span class=md-ellipsis> Main–Lorentz 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_9 type=checkbox> <label class=md-nav__link for=__nav_9 id=__nav_9_label><span class=md-ellipsis> 数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_9_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_9><span class="md-nav__icon md-icon"></span> 数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../> <span class=md-ellipsis> 数学部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../boolean-algebra/> <span class=md-ellipsis> 布尔代数 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_3 type=checkbox> <label class=md-nav__link for=__nav_9_3 id=__nav_9_3_label tabindex=0><span class=md-ellipsis> 数字系统 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_3><span class="md-nav__icon md-icon"></span> 数字系统</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/intro/> <span class=md-ellipsis> 数字系统简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/base/> <span class=md-ellipsis> 进位制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/balanced-ternary/> <span class=md-ellipsis> 平衡三进制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numeral-sys/gray-code/> <span class=md-ellipsis> 格雷码 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../bit/> <span class=md-ellipsis> 位操作 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../binary-set/> <span class=md-ellipsis> 二进制集合操作 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../bignum/> <span class=md-ellipsis> 高精度计算 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../binary-exponentiation/> <span class=md-ellipsis> 快速幂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../permutation/> <span class=md-ellipsis> 置换和排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../coordinate/> <span class=md-ellipsis> 弧度制与坐标系 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../complex/> <span class=md-ellipsis> 复数 </span> </a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_9_11 type=checkbox> <label class=md-nav__link for=__nav_9_11 id=__nav_9_11_label tabindex=0><span class=md-ellipsis> 数论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_9_11_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_11><span class="md-nav__icon md-icon"></span> 数论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../basic/> <span class=md-ellipsis> 数论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../mod-arithmetic/> <span class=md-ellipsis> 模算术简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../prime/> <span class=md-ellipsis> 素数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../gcd/> <span class=md-ellipsis> 最大公约数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../euler-totient/> <span class=md-ellipsis> 欧拉函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../sieve/> <span class=md-ellipsis> 筛法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../pollard-rho/> <span class=md-ellipsis> 分解质因数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../bezouts/> <span class=md-ellipsis> 裴蜀定理 & 一次不定方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../fermat/> <span class=md-ellipsis> 费马小定理 & 欧拉定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../inverse/> <span class=md-ellipsis> 模逆元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-equation/> <span class=md-ellipsis> 线性同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../crt/> <span class=md-ellipsis> 中国剩余定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../lift-the-exponent/> <span class=md-ellipsis> 升幂引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../factorial/> <span class=md-ellipsis> 阶乘取模 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../lucas/> <span class=md-ellipsis> 卢卡斯定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../congruence-equation/> <span class=md-ellipsis> 同余方程 </span> </a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> 二次剩余 </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./> <span class=md-ellipsis> 二次剩余 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#引入> <span class=md-ellipsis> 引入 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#定义> <span class=md-ellipsis> 定义 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#euler-判别法> <span class=md-ellipsis> Euler 判别法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#legendre-符号> <span class=md-ellipsis> Legendre 符号 </span> </a> <nav aria-label="Legendre 符号" class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#性质> <span class=md-ellipsis> 性质 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#二次互反律> <span class=md-ellipsis> 二次互反律 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#jacobi-符号> <span class=md-ellipsis> Jacobi 符号 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#模意义下开平方> <span class=md-ellipsis> 模意义下开平方 </span> </a> <nav aria-label=模意义下开平方 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#特殊情况时的算法> <span class=md-ellipsis> 特殊情况时的算法 </span> </a> <nav aria-label=特殊情况时的算法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#atkin-算法> <span class=md-ellipsis> Atkin 算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#cipolla-算法> <span class=md-ellipsis> Cipolla 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#bostanmori-算法> <span class=md-ellipsis> Bostan–Mori 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#legendre-算法> <span class=md-ellipsis> Legendre 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#tonellishanks-算法> <span class=md-ellipsis> Tonelli–Shanks 算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#习题> <span class=md-ellipsis> 习题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料与注释> <span class=md-ellipsis> 参考资料与注释 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../primitive-root/> <span class=md-ellipsis> 阶 & 原根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../discrete-logarithm/> <span class=md-ellipsis> 离散对数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../residue/> <span class=md-ellipsis> 高次剩余 & 单位根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../sqrt-decomposition/> <span class=md-ellipsis> 数论分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../dirichlet/> <span class=md-ellipsis> 狄利克雷卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../mobius/> <span class=md-ellipsis> 莫比乌斯反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../du/> <span class=md-ellipsis> 杜教筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../powerful-number/> <span class=md-ellipsis> Powerful Number 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../min-25/> <span class=md-ellipsis> Min_25 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../zhou/> <span class=md-ellipsis> 洲阁筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../euclidean/> <span class=md-ellipsis> 类欧几里德算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../meissel-lehmer/> <span class=md-ellipsis> Meissel–Lehmer 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../continued-fraction/> <span class=md-ellipsis> 连分数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../stern-brocot/> <span class=md-ellipsis> Stern–Brocot 树与 Farey 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../quadratic/> <span class=md-ellipsis> 二次域 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../pell-equation/> <span class=md-ellipsis> Pell 方程 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_12 type=checkbox> <label class=md-nav__link for=__nav_9_12 id=__nav_9_12_label tabindex=0><span class=md-ellipsis> 多项式与生成函数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_12_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_12><span class="md-nav__icon md-icon"></span> 多项式与生成函数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../poly/intro/> <span class=md-ellipsis> 多项式与生成函数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/fundamental/> <span class=md-ellipsis> 代数基本定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/fft/> <span class=md-ellipsis> 快速傅里叶变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/ntt/> <span class=md-ellipsis> 快速数论变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/fwt/> <span class=md-ellipsis> 快速沃尔什变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/czt/> <span class=md-ellipsis> Chirp Z 变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/newton/> <span class=md-ellipsis> 多项式牛顿迭代 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/multipoint-eval-interpolation/> <span class=md-ellipsis> 多项式多点求值|快速插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/elementary-func/> <span class=md-ellipsis> 多项式初等函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/linear-recurrence/> <span class=md-ellipsis> 常系数齐次线性递推 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/shift/> <span class=md-ellipsis> 多项式平移|连续点值平移 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/symbolic-method/> <span class=md-ellipsis> 符号化方法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/lagrange-inversion/> <span class=md-ellipsis> Lagrange 反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/comp-rev/> <span class=md-ellipsis> 形式幂级数复合|复合逆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/ogf/> <span class=md-ellipsis> 普通生成函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../poly/egf/> <span class=md-ellipsis> 指数生成函数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_13 type=checkbox> <label class=md-nav__link for=__nav_9_13 id=__nav_9_13_label tabindex=0><span class=md-ellipsis> 组合数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_13><span class="md-nav__icon md-icon"></span> 组合数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/combination/> <span class=md-ellipsis> 排列组合 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/drawer-principle/> <span class=md-ellipsis> 抽屉原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/inclusion-exclusion-principle/> <span class=md-ellipsis> 容斥原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/fibonacci/> <span class=md-ellipsis> 斐波那契数列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/derangement/> <span class=md-ellipsis> 错位排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/catalan/> <span class=md-ellipsis> 卡特兰数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/stirling/> <span class=md-ellipsis> 斯特林数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/bell/> <span class=md-ellipsis> 贝尔数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/bernoulli/> <span class=md-ellipsis> 伯努利数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/entringer/> <span class=md-ellipsis> Entringer Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/eulerian/> <span class=md-ellipsis> Eulerian Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/partition/> <span class=md-ellipsis> 分拆数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/vandermonde-convolution/> <span class=md-ellipsis> 范德蒙德卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/polya/> <span class=md-ellipsis> Pólya 计数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../combinatorics/graph-enumeration/> <span class=md-ellipsis> 图论计数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_14 type=checkbox> <label class=md-nav__link for=__nav_9_14 id=__nav_9_14_label tabindex=0><span class=md-ellipsis> 线性代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_14_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_14><span class="md-nav__icon md-icon"></span> 线性代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/> <span class=md-ellipsis> 线性代数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/vector/> <span class=md-ellipsis> 向量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/product/> <span class=md-ellipsis> 内积和外积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/matrix/> <span class=md-ellipsis> 矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/elementary-operations/> <span class=md-ellipsis> 初等变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/determinant/> <span class=md-ellipsis> 行列式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/vector-space/> <span class=md-ellipsis> 线性空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/basis/> <span class=md-ellipsis> 线性基 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/linear-mapping/> <span class=md-ellipsis> 线性映射 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/char-poly/> <span class=md-ellipsis> 特征多项式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/diagonalization/> <span class=md-ellipsis> 对角化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../linear-algebra/jordan/> <span class=md-ellipsis> Jordan标准型 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_15 type=checkbox> <label class=md-nav__link for=__nav_9_15 id=__nav_9_15_label tabindex=0><span class=md-ellipsis> 线性规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_15><span class="md-nav__icon md-icon"></span> 线性规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../linear-programming/> <span class=md-ellipsis> 线性规划基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../simplex/> <span class=md-ellipsis> 单纯形法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_16 type=checkbox> <label class=md-nav__link for=__nav_9_16 id=__nav_9_16_label tabindex=0><span class=md-ellipsis> 抽象代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_16_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_16><span class="md-nav__icon md-icon"></span> 抽象代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../algebra/basic/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/group-theory/> <span class=md-ellipsis> 群论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/ring-theory/> <span class=md-ellipsis> 环论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/field-theory/> <span class=md-ellipsis> 域论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../algebra/schreier-sims/> <span class=md-ellipsis> Schreier–Sims 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_17 type=checkbox> <label class=md-nav__link for=__nav_9_17 id=__nav_9_17_label tabindex=0><span class=md-ellipsis> 概率论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_17><span class="md-nav__icon md-icon"></span> 概率论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../probability/basic-conception/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/conditional-probability/> <span class=md-ellipsis> 条件概率与独立性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/random-variable/> <span class=md-ellipsis> 随机变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/exp-var/> <span class=md-ellipsis> 随机变量的数字特征 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/concentration-inequality/> <span class=md-ellipsis> 概率不等式 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_18 type=checkbox> <label class=md-nav__link for=__nav_9_18 id=__nav_9_18_label tabindex=0><span class=md-ellipsis> 博弈论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_18><span class="md-nav__icon md-icon"></span> 博弈论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../game-theory/intro/> <span class=md-ellipsis> 博弈论简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../game-theory/impartial-game/> <span class=md-ellipsis> 公平组合游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../game-theory/zero-sum-game/> <span class=md-ellipsis> 零和游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../game-theory/partizan-game/> <span class=md-ellipsis> 非公平组合游戏 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_19 type=checkbox> <label class=md-nav__link for=__nav_9_19 id=__nav_9_19_label tabindex=0><span class=md-ellipsis> 数值算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_19_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_19><span class="md-nav__icon md-icon"></span> 数值算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../numerical/interp/> <span class=md-ellipsis> 插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numerical/integral/> <span class=md-ellipsis> 数值积分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numerical/gauss/> <span class=md-ellipsis> 高斯消元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../numerical/newton/> <span class=md-ellipsis> 牛顿迭代法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../order-theory/> <span class=md-ellipsis> 序理论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../young-tableau/> <span class=md-ellipsis> 杨氏矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../matroid/> <span class=md-ellipsis> 拟阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../berlekamp-massey/> <span class=md-ellipsis> Berlekamp–Massey 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10 type=checkbox> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0><span class=md-ellipsis> 数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_10><span class="md-nav__icon md-icon"></span> 数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/> <span class=md-ellipsis> 数据结构部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/stack/> <span class=md-ellipsis> 栈 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/queue/> <span class=md-ellipsis> 队列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/linked-list/> <span class=md-ellipsis> 链表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/hash/> <span class=md-ellipsis> 哈希表 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_6 type=checkbox> <label class=md-nav__link for=__nav_10_6 id=__nav_10_6_label tabindex=0><span class=md-ellipsis> 并查集 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_6><span class="md-nav__icon md-icon"></span> 并查集</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/dsu/> <span class=md-ellipsis> 并查集 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/dsu-complexity/> <span class=md-ellipsis> 并查集复杂度 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_7 type=checkbox> <label class=md-nav__link for=__nav_10_7 id=__nav_10_7_label tabindex=0><span class=md-ellipsis> 堆 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_7_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_7><span class="md-nav__icon md-icon"></span> 堆</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/heap/> <span class=md-ellipsis> 堆简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/binary-heap/> <span class=md-ellipsis> 二叉堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/pairing-heap/> <span class=md-ellipsis> 配对堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/leftist-tree/> <span class=md-ellipsis> 左偏树 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_8 type=checkbox> <label class=md-nav__link for=__nav_10_8 id=__nav_10_8_label tabindex=0><span class=md-ellipsis> 块状数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_8_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_8><span class="md-nav__icon md-icon"></span> 块状数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/decompose/> <span class=md-ellipsis> 分块思想 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/block-array/> <span class=md-ellipsis> 块状数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/block-list/> <span class=md-ellipsis> 块状链表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/tree-decompose/> <span class=md-ellipsis> 树分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sqrt-tree/> <span class=md-ellipsis> Sqrt Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/monotonous-stack/> <span class=md-ellipsis> 单调栈 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/monotonous-queue/> <span class=md-ellipsis> 单调队列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sparse-table/> <span class=md-ellipsis> ST 表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/fenwick/> <span class=md-ellipsis> 树状数组 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_13 type=checkbox> <label class=md-nav__link for=__nav_10_13 id=__nav_10_13_label tabindex=0><span class=md-ellipsis> 线段树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_13><span class="md-nav__icon md-icon"></span> 线段树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg/> <span class=md-ellipsis> 线段树基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-merge-split/> <span class=md-ellipsis> 线段树合并 & 分裂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/li-chao-tree/> <span class=md-ellipsis> 李超线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/cat-tree/> <span class=md-ellipsis> 猫树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-beats/> <span class=md-ellipsis> 区间最值操作 & 区间历史最值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/kinetic-tournament-tree/> <span class=md-ellipsis> Kinetic Tournament Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/dividing/> <span class=md-ellipsis> 划分树 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_15 type=checkbox> <label class=md-nav__link for=__nav_10_15 id=__nav_10_15_label tabindex=0><span class=md-ellipsis> 二叉搜索树 & 平衡树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_15><span class="md-nav__icon md-icon"></span> 二叉搜索树 & 平衡树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/bst/> <span class=md-ellipsis> 二叉搜索树 & 平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/treap/> <span class=md-ellipsis> Treap </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/splay/> <span class=md-ellipsis> Splay 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/wblt/> <span class=md-ellipsis> WBLT </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sgt/> <span class=md-ellipsis> 替罪羊树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/cartesian-tree/> <span class=md-ellipsis> 笛卡尔树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sbt/> <span class=md-ellipsis> Size Balanced Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/avl/> <span class=md-ellipsis> AVL 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/rbtree/> <span class=md-ellipsis> 红黑树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/llrbt/> <span class=md-ellipsis> 左偏红黑树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/aa-tree/> <span class=md-ellipsis> AA 树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/skiplist/> <span class=md-ellipsis> 跳表 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_17 type=checkbox> <label class=md-nav__link for=__nav_10_17 id=__nav_10_17_label tabindex=0><span class=md-ellipsis> 可持久化数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_17><span class="md-nav__icon md-icon"></span> 可持久化数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent/> <span class=md-ellipsis> 可持久化数据结构简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-seg/> <span class=md-ellipsis> 可持久化线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-block-array/> <span class=md-ellipsis> 可持久化块状数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-balanced/> <span class=md-ellipsis> 可持久化平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-trie/> <span class=md-ellipsis> 可持久化字典树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-heap/> <span class=md-ellipsis> 可持久化可并堆 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_18 type=checkbox> <label class=md-nav__link for=__nav_10_18 id=__nav_10_18_label tabindex=0><span class=md-ellipsis> 树套树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_18><span class="md-nav__icon md-icon"></span> 树套树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-seg/> <span class=md-ellipsis> 线段树套线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-balanced/> <span class=md-ellipsis> 平衡树套线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/balanced-in-seg/> <span class=md-ellipsis> 线段树套平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-bit/> <span class=md-ellipsis> 树状数组套权值线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/bit-in-block-array/> <span class=md-ellipsis> 分块套树状数组 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/kdt/> <span class=md-ellipsis> K-D Tree </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_20 type=checkbox> <label class=md-nav__link for=__nav_10_20 id=__nav_10_20_label tabindex=0><span class=md-ellipsis> 动态树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_20_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_20><span class="md-nav__icon md-icon"></span> 动态树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/lct/> <span class=md-ellipsis> Link Cut Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/global-bst/> <span class=md-ellipsis> 全局平衡二叉树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/ett/> <span class=md-ellipsis> Euler Tour Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/top-tree/> <span class=md-ellipsis> Top Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/divide-combine/> <span class=md-ellipsis> 析合树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/pq-tree/> <span class=md-ellipsis> PQ 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/finger-tree/> <span class=md-ellipsis> 手指树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/huffman-tree/> <span class=md-ellipsis> 霍夫曼树 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11 type=checkbox> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0><span class=md-ellipsis> 图论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_11><span class="md-nav__icon md-icon"></span> 图论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/> <span class=md-ellipsis> 图论部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/concept/> <span class=md-ellipsis> 图论相关概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/save/> <span class=md-ellipsis> 图的存储 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dfs/> <span class=md-ellipsis> DFS（图论） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bfs/> <span class=md-ellipsis> BFS（图论） </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_6 type=checkbox> <label class=md-nav__link for=__nav_11_6 id=__nav_11_6_label tabindex=0><span class=md-ellipsis> 树上问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_6><span class="md-nav__icon md-icon"></span> 树上问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-basic/> <span class=md-ellipsis> 树基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-diameter/> <span class=md-ellipsis> 树的直径 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-center/> <span class=md-ellipsis> 树的中心 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-centroid/> <span class=md-ellipsis> 树的重心 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/lca/> <span class=md-ellipsis> 最近公共祖先 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/hld/> <span class=md-ellipsis> 树链剖分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dsu-on-tree/> <span class=md-ellipsis> 树上启发式合并 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/virtual-tree/> <span class=md-ellipsis> 虚树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-divide/> <span class=md-ellipsis> 树分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dynamic-tree-divide/> <span class=md-ellipsis> 动态树分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-ahu/> <span class=md-ellipsis> AHU 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-hash/> <span class=md-ellipsis> 树哈希 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-random-walk/> <span class=md-ellipsis> 树上随机游走 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dag/> <span class=md-ellipsis> 有向无环图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/topo/> <span class=md-ellipsis> 拓扑排序 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_9 type=checkbox> <label class=md-nav__link for=__nav_11_9 id=__nav_11_9_label tabindex=0><span class=md-ellipsis> 最短路问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_9_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_9><span class="md-nav__icon md-icon"></span> 最短路问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/shortest-path/> <span class=md-ellipsis> 最短路 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/diff-constraints/> <span class=md-ellipsis> 差分约束 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/kth-path/> <span class=md-ellipsis> k 短路 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/mod-shortest-path/> <span class=md-ellipsis> 同余最短路 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_10 type=checkbox> <label class=md-nav__link for=__nav_11_10 id=__nav_11_10_label tabindex=0><span class=md-ellipsis> 生成树问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_10_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_10><span class="md-nav__icon md-icon"></span> 生成树问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/mst/> <span class=md-ellipsis> 最小生成树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dmst/> <span class=md-ellipsis> 最小树形图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/mdst/> <span class=md-ellipsis> 最小直径生成树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/steiner-tree/> <span class=md-ellipsis> 斯坦纳树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/node/> <span class=md-ellipsis> 拆点 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_13 type=checkbox> <label class=md-nav__link for=__nav_11_13 id=__nav_11_13_label tabindex=0><span class=md-ellipsis> 连通性相关 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_13><span class="md-nav__icon md-icon"></span> 连通性相关</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/scc/> <span class=md-ellipsis> 强连通分量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bcc/> <span class=md-ellipsis> 双连通分量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/cut/> <span class=md-ellipsis> 割点和桥 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/block-forest/> <span class=md-ellipsis> 圆方树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/connectivity/> <span class=md-ellipsis> 点/边连通度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/rings-count/> <span class=md-ellipsis> 环计数问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/min-cycle/> <span class=md-ellipsis> 最小环 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/2-sat/> <span class=md-ellipsis> 2-SAT </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/euler/> <span class=md-ellipsis> 欧拉图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/hamilton/> <span class=md-ellipsis> 哈密顿图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bi-graph/> <span class=md-ellipsis> 二分图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/planar/> <span class=md-ellipsis> 平面图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/chord/> <span class=md-ellipsis> 弦图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/color/> <span class=md-ellipsis> 图的着色 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_23 type=checkbox> <label class=md-nav__link for=__nav_11_23 id=__nav_11_23_label tabindex=0><span class=md-ellipsis> 网络流 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_23_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_23><span class="md-nav__icon md-icon"></span> 网络流</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/> <span class=md-ellipsis> 网络流简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/max-flow/> <span class=md-ellipsis> 最大流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/min-cut/> <span class=md-ellipsis> 最小割 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/min-cost/> <span class=md-ellipsis> 费用流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/bound/> <span class=md-ellipsis> 上下界网络流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/stoer-wagner/> <span class=md-ellipsis> Stoer–Wagner 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_24 type=checkbox> <label class=md-nav__link for=__nav_11_24 id=__nav_11_24_label tabindex=0><span class=md-ellipsis> 图的匹配 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_24_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_24><span class="md-nav__icon md-icon"></span> 图的匹配</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/graph-match/> <span class=md-ellipsis> 图匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/bigraph-match/> <span class=md-ellipsis> 二分图最大匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/bigraph-weight-match/> <span class=md-ellipsis> 二分图最大权匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/general-match/> <span class=md-ellipsis> 一般图最大匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/general-weight-match/> <span class=md-ellipsis> 一般图最大权匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/stable-match/> <span class=md-ellipsis> 稳定匹配 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/prufer/> <span class=md-ellipsis> Prüfer 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/matrix-tree/> <span class=md-ellipsis> 矩阵树定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/lgv/> <span class=md-ellipsis> LGV 引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/max-clique/> <span class=md-ellipsis> 最大团搜索算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dominator-tree/> <span class=md-ellipsis> 支配树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-random-walk/> <span class=md-ellipsis> 图上随机游走 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_12 type=checkbox> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0><span class=md-ellipsis> 计算几何 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_12_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_12><span class="md-nav__icon md-icon"></span> 计算几何</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../geometry/> <span class=md-ellipsis> 计算几何部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/2d/> <span class=md-ellipsis> 二维计算几何基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/3d/> <span class=md-ellipsis> 三维计算几何基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/distance/> <span class=md-ellipsis> 距离 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/pick/> <span class=md-ellipsis> Pick 定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/triangulation/> <span class=md-ellipsis> 三角剖分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/convex-hull/> <span class=md-ellipsis> 凸包 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/scanning/> <span class=md-ellipsis> 扫描线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/rotating-calipers/> <span class=md-ellipsis> 旋转卡壳 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/half-plane/> <span class=md-ellipsis> 半平面交 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/nearest-points/> <span class=md-ellipsis> 平面最近点对 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/random-incremental/> <span class=md-ellipsis> 随机增量法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/inverse/> <span class=md-ellipsis> 反演变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/misc/> <span class=md-ellipsis> 计算几何杂项 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13 type=checkbox> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0><span class=md-ellipsis> 杂项 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_13><span class="md-nav__icon md-icon"></span> 杂项</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/> <span class=md-ellipsis> 杂项简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/discrete/> <span class=md-ellipsis> 离散化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/two-pointer/> <span class=md-ellipsis> 双指针 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_4 type=checkbox> <label class=md-nav__link for=__nav_13_4 id=__nav_13_4_label tabindex=0><span class=md-ellipsis> 离线算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_4_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_13_4><span class="md-nav__icon md-icon"></span> 离线算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/offline/> <span class=md-ellipsis> 离线算法简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/cdq-divide/> <span class=md-ellipsis> CDQ 分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/parallel-binsearch/> <span class=md-ellipsis> 整体二分 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_4_4 type=checkbox> <label class=md-nav__link for=__nav_13_4_4 id=__nav_13_4_4_label tabindex=0><span class=md-ellipsis> 莫队算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_4_4_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_13_4_4><span class="md-nav__icon md-icon"></span> 莫队算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-intro/> <span class=md-ellipsis> 莫队算法简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo/> <span class=md-ellipsis> 普通莫队算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/modifiable-mo-algo/> <span class=md-ellipsis> 带修改莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-on-tree/> <span class=md-ellipsis> 树上莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/rollback-mo-algo/> <span class=md-ellipsis> 回滚莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-2dimen/> <span class=md-ellipsis> 二维莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-secondary-offline/> <span class=md-ellipsis> 莫队二次离线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-with-bitset/> <span class=md-ellipsis> 莫队配合 bitset </span> </a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/frac-programming/> <span class=md-ellipsis> 分数规划 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_6 type=checkbox> <label class=md-nav__link for=__nav_13_6 id=__nav_13_6_label tabindex=0><span class=md-ellipsis> 随机化 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_13_6><span class="md-nav__icon md-icon"></span> 随机化</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/random/> <span class=md-ellipsis> 随机函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/rand-technique/> <span class=md-ellipsis> 随机化技巧 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/hill-climbing/> <span class=md-ellipsis> 爬山算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/simulated-annealing/> <span class=md-ellipsis> 模拟退火 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/hoverline/> <span class=md-ellipsis> 悬线法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/fsm/> <span class=md-ellipsis> 有限状态自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/cc-basic/> <span class=md-ellipsis> 计算理论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/endianness/> <span class=md-ellipsis> 字节顺序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/josephus/> <span class=md-ellipsis> 约瑟夫问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/expression/> <span class=md-ellipsis> 表达式求值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/job-order/> <span class=md-ellipsis> 在一台机器上规划任务 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/main-element/> <span class=md-ellipsis> 主元素问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/garsia-wachs/> <span class=md-ellipsis> Garsia–Wachs 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/15-puzzle/> <span class=md-ellipsis> 15-puzzle </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/kahan-summation/> <span class=md-ellipsis> Kahan 求和 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/odt/> <span class=md-ellipsis> 珂朵莉树/颜色段均摊 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/space-optimization/> <span class=md-ellipsis> 空间优化简介 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_14 type=checkbox> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex=0><span class=md-ellipsis> 专题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_14_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_14><span class="md-nav__icon md-icon"></span> 专题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../topic/rmq/> <span class=md-ellipsis> RMQ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/dsu-app/> <span class=md-ellipsis> 并查集应用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/bracket/> <span class=md-ellipsis> 括号序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/segment-tree-offline/> <span class=md-ellipsis> 线段树与离线询问 </span> </a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#引入> <span class=md-ellipsis> 引入 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#定义> <span class=md-ellipsis> 定义 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#euler-判别法> <span class=md-ellipsis> Euler 判别法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#legendre-符号> <span class=md-ellipsis> Legendre 符号 </span> </a> <nav aria-label="Legendre 符号" class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#性质> <span class=md-ellipsis> 性质 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#二次互反律> <span class=md-ellipsis> 二次互反律 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#jacobi-符号> <span class=md-ellipsis> Jacobi 符号 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#模意义下开平方> <span class=md-ellipsis> 模意义下开平方 </span> </a> <nav aria-label=模意义下开平方 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#特殊情况时的算法> <span class=md-ellipsis> 特殊情况时的算法 </span> </a> <nav aria-label=特殊情况时的算法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#atkin-算法> <span class=md-ellipsis> Atkin 算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#cipolla-算法> <span class=md-ellipsis> Cipolla 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#bostanmori-算法> <span class=md-ellipsis> Bostan–Mori 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#legendre-算法> <span class=md-ellipsis> Legendre 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#tonellishanks-算法> <span class=md-ellipsis> Tonelli–Shanks 算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#习题> <span class=md-ellipsis> 习题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料与注释> <span class=md-ellipsis> 参考资料与注释 </span> </a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://oi-wiki.org/edit-landing/?ref=/math/number-theory/quad-residue.md" rel=edit title=编辑此页> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a><h1>二次剩余</h1><h2 data-original-document-end=5 data-original-document-start=0 id=引入>引入<a title="Permanent link" class=headerlink href=#引入></a></h2><p data-original-document-end=75 data-original-document-start=7>二次剩余可以认为是在讨论求模意义下 <strong>开平方</strong> 运算的可行性．对于更高次方的开方可参见 <a href=../residue/>k 次剩余</a>．</p><h2 data-original-document-end=82 data-original-document-start=77 id=定义>定义<a title="Permanent link" class=headerlink href=#定义></a></h2><details class=abstract data-original-document-end=269 data-original-document-start=84 open><summary>二次剩余</summary> <p>令整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(a,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，若存在整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 使得</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^2\equiv a\pmod p,
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^2\equiv a\pmod p," display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
x^2\equiv a\pmod p,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>则称 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次剩余，否则称 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次非剩余．后文可能在模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 显然的情况下简写成二次（非）剩余．</p></details><h2 data-original-document-end=283 data-original-document-start=271 id=euler-判别法>Euler 判别法<a title="Permanent link" class=headerlink href=#euler-判别法></a></h2><p data-original-document-end=302 data-original-document-start=285>当模数为奇素数时，我们有如下定理：</p><details class=abstract data-original-document-end=366 data-original-document-start=304 open><summary>Euler 判别法</summary> <p>对奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 和满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(a,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
a^{\frac{p-1}{2}}\equiv\begin{cases}
    1 \pmod p,  & (\exists x\in\mathbf{Z}),~~a\equiv x^2\pmod p,\\
    -1 \pmod p, & \text{otherwise}.\\
\end{cases}
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:18.873em><mjx-table><mjx-itable><mjx-mtr style=height:1.082em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\exists><mjx-c class=mjx-c2203>∃</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex=\mathbf{Z} space=4 texclass=ORD><mjx-mi data-latex=Z><mjx-c class=mjx-c1D419>𝐙</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mtext data-latex=~><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=x^2 space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mtext data-latex=\text{otherwise}><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c68 noic=true style=padding-top:.694em>h</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.694em>r</mjx-c><mjx-c class=mjx-c77 noic=true style=padding-top:.694em>w</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c65 style=padding-top:.694em>e</mjx-c></mjx-mtext><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="a^{\frac{p-1}{2}}\equiv\begin{cases}1 \pmod p,  & (\exists x\in\mathbf{Z}),~~a\equiv x^2\pmod p,\\-1 \pmod p, & \text{otherwise}.\\\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd><mtd><mo data-latex=( stretchy=false>(</mo><mi data-latex=\exists mathvariant=normal>∃</mi><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mrow data-latex=\mathbf{Z} data-mjx-texclass=ORD><mi data-latex=Z mathvariant=bold>Z</mi></mrow><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mtext data-latex=~> </mtext><mi data-latex=a>a</mi><mo data-latex=\equiv>≡</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex=\text{otherwise}>otherwise</mtext><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
a^{\frac{p-1}{2}}\equiv\begin{cases}
    1 \pmod p,  & (\exists x\in\mathbf{Z}),~~a\equiv x^2\pmod p,\\
    -1 \pmod p, & \text{otherwise}.\\
\end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>即对上述的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，</p> <ol data-original-document-end=14265 data-original-document-start=14264><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次剩余当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{\frac{p-1}{2}}\equiv 1 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{\frac{p-1}{2}}\equiv 1 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^{\frac{p-1}{2}}\equiv 1 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</li><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次非剩余当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{\frac{p-1}{2}}\equiv -1 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{\frac{p-1}{2}}\equiv -1 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^{\frac{p-1}{2}}\equiv -1 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</li></ol></details><details class=note><summary>证明</summary> <p>首先由 <a href=../fermat/#费马小定理>Fermat 小定理</a> 有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{p-1}\equiv 1\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{p-1}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={p-1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{p-1}\equiv 1\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{p-1}><mi data-latex=a>a</mi><mrow data-latex={p-1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^{p-1}\equiv 1\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，故</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(a^{\frac{p-1}{2}}+1\right)\left(a^{\frac{p-1}{2}}-1\right)\equiv 0\pmod p,
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(a^{\frac{p-1}{2}}+1\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(a^{\frac{p-1}{2}}-1\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(a^{\frac{p-1}{2}}+1\right)\left(a^{\frac{p-1}{2}}-1\right)\equiv 0\pmod p," display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(a^{\frac{p-1}{2}}+1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(a^{\frac{p-1}{2}}-1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
\left(a^{\frac{p-1}{2}}+1\right)\left(a^{\frac{p-1}{2}}-1\right)\equiv 0\pmod p,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>从而对任意满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(a,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 均有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{(p-1)/2}\equiv \pm 1\pmod p." aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{(p-1)/2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(p-1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{(p-1)/2}\equiv \pm 1\pmod p." xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{(p-1)/2}><mi data-latex=a>a</mi><mrow data-latex={(p-1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\equiv>≡</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="a^{(p-1)/2}\equiv \pm 1\pmod p." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></p> <p>另外由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 是奇素数，我们有：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^{p-1}-a^{\frac{p-1}{2}}={\left(x^2\right)}^{\frac{p-1}{2}}-a^{\frac{p-1}{2}}=(x^2-a)P(x),
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=x^{p-1}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p-1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}} space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex="{\left(x^2 \right)}^{\frac{p-1}{2}}" space=4><mjx-texatom data-latex="{\left(x^2 \right)}" texclass=ORD><mjx-mrow data-latex="\left(x^2 \right)"><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow></mjx-texatom><mjx-script style=vertical-align:.611em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}} space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^{p-1}-a^{\frac{p-1}{2}}={\left(x^2\right)}^{\frac{p-1}{2}}-a^{\frac{p-1}{2}}=(x^2-a)P(x)," display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^{p-1}><mi data-latex=x>x</mi><mrow data-latex={p-1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=->−</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex="=">=</mo><msup data-latex="{\left(x^2 \right)}^{\frac{p-1}{2}}"><mrow data-latex="{\left(x^2 \right)}" data-mjx-texclass=ORD><mrow data-latex="\left(x^2 \right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=->−</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=P>P</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
x^{p-1}-a^{\frac{p-1}{2}}={\left(x^2\right)}^{\frac{p-1}{2}}-a^{\frac{p-1}{2}}=(x^2-a)P(x),
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=P(x)><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=P(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=P>P</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=P(x)></mjx-container> 是某个整系数多项式，进而：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
    x^p-x&=x\left(x^{p-1}-a^{\frac{p-1}{2}}\right)+x\left(a^{\frac{p-1}{2}}-1\right)\\
    &=(x^2-a)xP(x)+\left(a^{\frac{p-1}{2}}-1\right)x.\\
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
    x^p-x&=x\left(x^{p-1}-a^{\frac{p-1}{2}}\right)+x\left(a^{\frac{p-1}{2}}-1\right)\\
    &=(x^2 -a)xP(x)+\left(a^{\frac{p-1}{2}}-1\right)x.\\
\end{aligned}" style=min-width:17.713em><mjx-table><mjx-itable><mjx-mtr data-latex="
    " style=height:1.792em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msup data-latex=x^p><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mrow data-latex=\left(x^{p-1}-a^{\frac{p-1}{2}}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-msup data-latex=x^{p-1}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p-1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}} space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mrow data-latex=\left(a^{\frac{p-1}{2}}-1\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
    " style=height:1.792em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mrow data-latex=\left(a^{\frac{p-1}{2}}-1\right) space=3><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}x^p-x&=x\left(x^{p-1}-a^{\frac{p-1}{2}}\right)+x\left(a^{\frac{p-1}{2}}-1\right)\\&=(x^2-a)xP(x)+\left(a^{\frac{p-1}{2}}-1\right)x.\\\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}x^p-x&=x\left(x^{p-1}-a^{\frac{p-1}{2}}\right)+x\left(a^{\frac{p-1}{2}}-1\right)\\&=(x^2 -a)xP(x)+\left(a^{\frac{p-1}{2}}-1\right)x.\\\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><msup data-latex=x^p><mi data-latex=x>x</mi><mi data-latex=p>p</mi></msup><mo data-latex=->−</mo><mi data-latex=x>x</mi></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=x>x</mi><mrow data-latex=\left(x^{p-1}-a^{\frac{p-1}{2}}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=x^{p-1}><mi data-latex=x>x</mi><mrow data-latex={p-1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=->−</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=+>+</mo><mi data-latex=x>x</mi><mrow data-latex=\left(a^{\frac{p-1}{2}}-1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=x>x</mi><mi data-latex=P>P</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mrow data-latex=\left(a^{\frac{p-1}{2}}-1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mi data-latex=x>x</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
    x^p-x&=x\left(x^{p-1}-a^{\frac{p-1}{2}}\right)+x\left(a^{\frac{p-1}{2}}-1\right)\\
    &=(x^2-a)xP(x)+\left(a^{\frac{p-1}{2}}-1\right)x.\\
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>由 <a href=../congruence-equation/#定理-5>同余方程的定理 5</a> 可知，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次剩余当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{(p-1)/2}\equiv 1\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{(p-1)/2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(p-1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{(p-1)/2}\equiv 1\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{(p-1)/2}><mi data-latex=a>a</mi><mrow data-latex={(p-1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^{(p-1)/2}\equiv 1\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>. 进而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的非二次剩余当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{(p-1)/2}\equiv -1\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{(p-1)/2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(p-1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{(p-1)/2}\equiv -1\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{(p-1)/2}><mi data-latex=a>a</mi><mrow data-latex={(p-1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^{(p-1)/2}\equiv -1\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</p></details><p>基于 Euler 判别法，我们可以得到如下推论：</p><details class=note open><summary>二次剩余的数量</summary> <p>对于奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container>，模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 意义下二次剩余和二次非剩余均有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\dfrac{p-1}{2}><mjx-mstyle data-latex=\dfrac{p-1}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\dfrac{p-1}{2} xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p-1}{2} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\dfrac{p-1}{2}></mjx-container> 个．</p></details><details class=note><summary>证明</summary> <p>根据 Euler 判别法，考虑 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{\frac{p-1}{2}}\equiv 1\pmod p." aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{\frac{p-1}{2}}\equiv 1\pmod p." xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="a^{\frac{p-1}{2}}\equiv 1\pmod p." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></p> <p>注意到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\dfrac{p-1}{2}\mid (p-1)" aria-hidden=true breakable=true class=NCM-N><mjx-mstyle data-latex=\dfrac{p-1}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex=\mid><mjx-c class=mjx-c2223>∣</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\dfrac{p-1}{2}\mid (p-1)" xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p-1}{2} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle><mo data-latex=\mid>∣</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\dfrac{p-1}{2}\mid (p-1)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，由 <a href=../congruence-equation/#定理-6>同余方程的定理 6</a> 可知 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{\frac{p-1}{2}}\equiv 1\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{\frac{p-1}{2}}\equiv 1\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^{\frac{p-1}{2}}\equiv 1\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\dfrac{p-1}{2}><mjx-mstyle data-latex=\dfrac{p-1}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\dfrac{p-1}{2} xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p-1}{2} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\dfrac{p-1}{2}></mjx-container> 个解．所以模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 意义下二次剩余和二次非剩余均有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\dfrac{p-1}{2}><mjx-mstyle data-latex=\dfrac{p-1}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\dfrac{p-1}{2} xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p-1}{2} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\dfrac{p-1}{2}></mjx-container> 个．</p></details><h2 id=legendre-符号>Legendre 符号<a title="Permanent link" class=headerlink href=#legendre-符号></a></h2><p>为了方便接下来的讨论，我们引入如下记号：</p><details class=abstract open><summary>Legendre 符号</summary> <p>对 <strong>奇素数</strong> <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 和整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，定义 Legendre 符号如下：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{a}{p}\right)=\begin{cases}
    0,  & p\mid a,\\
    1,  & (p\nmid a) \land ((\exists x\in\mathbf{Z}),~~a\equiv x^2\pmod p),\\
    -1, & \text{otherwise}.\\
\end{cases}
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{a}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-stretchy-v class=mjx-c7B style=vertical-align:-1.492em;height:3.484em><mjx-beg>⎧</mjx-beg><mjx-ext class=NCM-EM><mjx-spacer>{ {</mjx-spacer></mjx-ext><mjx-mid>⎨</mjx-mid><mjx-ext class=NCM-EM><mjx-spacer>{ {</mjx-spacer></mjx-ext><mjx-end>⎩</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=min-width:19.402em><mjx-table><mjx-itable><mjx-mtr style=height:1em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\mid space=4><mjx-c class=mjx-c2223>∣</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:1.084em><mjx-mtd style=text-align:left;padding-top:.1em;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-bottom:.1em;padding-left:.5em><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\nmid space=4><mjx-c class=mjx-c2224>∤</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\land space=3><mjx-c class=mjx-c2227>∧</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\exists><mjx-c class=mjx-c2203>∃</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex=\mathbf{Z} space=4 texclass=ORD><mjx-mi data-latex=Z><mjx-c class=mjx-c1D419>𝐙</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mtext data-latex=~><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=x^2 space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.887em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mtext data-latex=\text{otherwise}><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c68 noic=true style=padding-top:.694em>h</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.694em>r</mjx-c><mjx-c class=mjx-c77 noic=true style=padding-top:.694em>w</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c65 style=padding-top:.694em>e</mjx-c></mjx-mtext><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{a}{p}\right)=\begin{cases}0,  & p\mid a,\\1,  & (p\nmid a) \land ((\exists x\in\mathbf{Z}),~~a\equiv x^2\pmod p),\\-1, & \text{otherwise}.\\\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{a}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a}{p}><mi data-latex=a>a</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mn data-latex=0>0</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\mid>∣</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=\nmid>∤</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\land>∧</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=\exists mathvariant=normal>∃</mi><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mrow data-latex=\mathbf{Z} data-mjx-texclass=ORD><mi data-latex=Z mathvariant=bold>Z</mi></mrow><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mtext data-latex=~> </mtext><mi data-latex=a>a</mi><mo data-latex=\equiv>≡</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex=\text{otherwise}>otherwise</mtext><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
\left(\frac{a}{p}\right)=\begin{cases}
    0,  & p\mid a,\\
    1,  & (p\nmid a) \land ((\exists x\in\mathbf{Z}),~~a\equiv x^2\pmod p),\\
    -1, & \text{otherwise}.\\
\end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><p>即对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(a,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，</p><ul><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次剩余当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left(\dfrac{a}{p}\right)=1." aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex=\left(\dfrac{a}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1. space=4><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left(\dfrac{a}{p}\right)=1." xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{p} displaystyle=true><mfrac><mi data-latex=a>a</mi><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mn data-latex=1.>1.</mn></math></mjx-assistive-mml><img title="\left(\dfrac{a}{p}\right)=1." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次非剩余当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left(\dfrac{a}{p}\right)=-1." aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex=\left(\dfrac{a}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1.><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left(\dfrac{a}{p}\right)=-1." xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{p} displaystyle=true><mfrac><mi data-latex=a>a</mi><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=->−</mo><mn data-latex=1.>1.</mn></math></mjx-assistive-mml><img title="\left(\dfrac{a}{p}\right)=-1." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li></ul><p>下表为部分 Legendre 符号的值（From <a href=https://en.wikipedia.org/wiki/Legendre_symbol#Table_of_values target=_blank>Wikipedia</a>）</p><p><img alt src=../images/quad_residue.png></p><h3 id=性质>性质<a title="Permanent link" class=headerlink href=#性质></a></h3><ol><li><p>对任意整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
a^{\frac{p-1}{2}}\equiv \left(\frac{a}{p}\right)\pmod p.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=a^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="a^{\frac{p-1}{2}}\equiv \left(\frac{a}{p}\right)\pmod p." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mrow data-latex=\left(\frac{a}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a}{p}><mi data-latex=a>a</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
a^{\frac{p-1}{2}}\equiv \left(\frac{a}{p}\right)\pmod p.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>进一步，我们有推论：</p> <ul><li><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
    \left(\dfrac{1}{p}\right)=1.
    " aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\dfrac{1}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1. space=4><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\dfrac{1}{p}\right)=1." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\dfrac{1}{p}><mn data-latex=1>1</mn><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mn data-latex=1.>1.</mn></math></mjx-assistive-mml><img title="
    \left(\dfrac{1}{p}\right)=1.
    " src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
    \left(\dfrac{-1}{p}\right)=(-1)^{\frac{p-1}{2}}=\begin{cases}
        1,  & p\equiv 1\pmod 4,\\
        -1, & p\equiv 3\pmod 4.
        \end{cases}
    " aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\dfrac{-1}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{-1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=-1><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:9.281em><mjx-table><mjx-itable><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=4 space=2><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=3 space=4><mjx-c class=mjx-c33>3</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=4 space=2><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\dfrac{-1}{p}\right)=(-1)^{\frac{p-1}{2}}=\begin{cases}1,  & p\equiv 1\pmod 4,\\-1, & p\equiv 3\pmod 4.\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{-1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\dfrac{-1}{p}><mrow data-latex=-1><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex="=">=</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=4>4</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mn data-latex=3>3</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=4>4</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
    \left(\dfrac{-1}{p}\right)=(-1)^{\frac{p-1}{2}}=\begin{cases}
        1,  & p\equiv 1\pmod 4,\\
        -1, & p\equiv 3\pmod 4.
        \end{cases}
    " src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li></ul></li><li><p><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_1\equiv a_2\pmod p\implies \left(\dfrac{a_1}{p}\right)=\left(\dfrac{a_2}{p}\right)." aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msub data-latex=a_2 space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-break size=4> </mjx-break><mjx-mo data-latex=\Longrightarrow><mjx-c class=mjx-c27F9>⟹</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mrow data-latex=\left(\dfrac{a_1}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_1}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\dfrac{a_2}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_2}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_1\equiv a_2\pmod p\implies \left(\dfrac{a_1}{p}\right)=\left(\dfrac{a_2}{p}\right)." xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\equiv>≡</mo><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longrightarrow stretchy=false>⟹</mo><mspace data-latex=\; width=0.278em></mspace><mrow data-latex=\left(\dfrac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_1}{p} displaystyle=true><mfrac><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mrow data-latex=\left(\dfrac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_2}{p} displaystyle=true><mfrac><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="a_1\equiv a_2\pmod p\implies \left(\dfrac{a_1}{p}\right)=\left(\dfrac{a_2}{p}\right)." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></p></li><li><p>（<a href=../basic/#积性函数>完全积性</a>）对任意整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a_1,a_2><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_2 space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a_1,a_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a_1,a_2></mjx-container>，</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{a_1a_2}{p}\right)=\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right).
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{a_1a_2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="a_1 a_2"><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a_1}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(\frac{a_2}{p}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{a_1a_2}{p}\right)=\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{a_1a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1a_2}{p}><mrow data-latex="a_1 a_2"><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mrow data-latex=\left(\frac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1}{p}><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(\frac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_2}{p}><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{a_1a_2}{p}\right)=\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>我们有推论：对整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\nmid b" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\nmid><mjx-c class=mjx-c2224>∤</mjx-c></mjx-mo><mjx-mi data-latex=b space=4><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\nmid b" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=\nmid>∤</mo><mi data-latex=b>b</mi></math></mjx-assistive-mml><img title="p\nmid b" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{ab^2}{p}\right)=\left(\frac{a}{p}\right).
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{ab^2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S6">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{ab^2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=ab^2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S6">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{ab^2}{p}\right)=\left(\frac{a}{p}\right)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{ab^2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{ab^2}{p}><mrow data-latex=ab^2><mi data-latex=a>a</mi><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mrow data-latex=\left(\frac{a}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a}{p}><mi data-latex=a>a</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{ab^2}{p}\right)=\left(\frac{a}{p}\right).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
    \left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}
            1,  & p\equiv \pm 1\pmod 8, \\
            -1, & p\equiv \pm 3\pmod 8. \\
        \end{cases}
    " aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\frac{p^2-1}{8}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p^2-1}{8}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p^2-1}{8}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex="p^2 -1" size=s><mjx-msup data-latex=p^2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=8 size=s><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:10.059em><mjx-table><mjx-itable><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=\pm space=4><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=8 space=2><mjx-c class=mjx-c38>8</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=\pm space=4><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=3><mjx-c class=mjx-c33>3</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=8 space=2><mjx-c class=mjx-c38>8</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}1,  & p\equiv \pm 1\pmod 8, \\-1, & p\equiv \pm 3\pmod 8. \\\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{2}{p}><mn data-latex=2>2</mn><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\frac{p^2-1}{8}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p^2-1}{8}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p^2-1}{8}><mrow data-latex="p^2 -1"><msup data-latex=p^2><mi data-latex=p>p</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=8>8</mn></mfrac></mrow></msup><mo data-latex="=">=</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=8>8</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mo data-latex=\pm>±</mo><mn data-latex=3>3</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=8>8</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
    \left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}
            1,  & p\equiv \pm 1\pmod 8, \\
            -1, & p\equiv \pm 3\pmod 8. \\
        \end{cases}
    " src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li></ol><details class=note><summary>证明</summary> <ol><li>由 <a href=#legendre-符号>Legendre 符号的定义</a> 和 <a href=#euler-判别法>Euler 判别法</a> 易得．</li><li><p>注意到</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
a_1\equiv a_2\pmod p\implies \left(\frac{a_1}{p}\right)\equiv\left(\frac{a_2}{p}\right)\pmod p,
" aria-hidden=true class=NCM-N display=true><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msub data-latex=a_2 space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longrightarrow space=4><mjx-c class=mjx-c27F9>⟹</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mrow data-latex=\left(\frac{a_1}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a_2}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="a_1\equiv a_2\pmod p\implies \left(\frac{a_1}{p}\right)\equiv\left(\frac{a_2}{p}\right)\pmod p," display=block xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\equiv>≡</mo><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longrightarrow stretchy=false>⟹</mo><mspace data-latex=\; width=0.278em></mspace><mrow data-latex=\left(\frac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1}{p}><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\equiv>≡</mo><mrow data-latex=\left(\frac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_2}{p}><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
a_1\equiv a_2\pmod p\implies \left(\frac{a_1}{p}\right)\equiv\left(\frac{a_2}{p}\right)\pmod p,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left|\left(\dfrac{a_1}{p}\right)-\left(\dfrac{a_2}{p}\right)\right|\leq 2" aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex=\left|\left(\dfrac{a_1}{p}\right)-\left(\dfrac{a_2}{p}\right)\right|><mjx-mo data-latex=\left|><mjx-c class="mjx-c2223 NCM-S4">∣</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\dfrac{a_1}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_1}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\dfrac{a_2}{p}\right) space=3><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_2}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right|><mjx-c class="mjx-c2223 NCM-S4">∣</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left|\left(\dfrac{a_1}{p}\right)-\left(\dfrac{a_2}{p}\right)\right|\leq 2" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left|\left(\dfrac{a_1}{p}\right)-\left(\dfrac{a_2}{p}\right)\right| data-mjx-texclass=INNER><mo data-latex=\left| data-mjx-texclass=OPEN>|</mo><mrow data-latex=\left(\dfrac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_1}{p} displaystyle=true><mfrac><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=->−</mo><mrow data-latex=\left(\dfrac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_2}{p} displaystyle=true><mfrac><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\right| data-mjx-texclass=CLOSE>|</mo></mrow><mo data-latex=\leq>≤</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="\left|\left(\dfrac{a_1}{p}\right)-\left(\dfrac{a_2}{p}\right)\right|\leq 2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p>2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p>2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=">">></mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="p>2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，故：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
a_1\equiv a_2\pmod p\implies \left(\frac{a_1}{p}\right)=\left(\frac{a_2}{p}\right).
" aria-hidden=true class=NCM-N display=true><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msub data-latex=a_2 space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longrightarrow space=4><mjx-c class=mjx-c27F9>⟹</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mrow data-latex=\left(\frac{a_1}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a_2}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="a_1\equiv a_2\pmod p\implies \left(\frac{a_1}{p}\right)=\left(\frac{a_2}{p}\right)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\equiv>≡</mo><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longrightarrow stretchy=false>⟹</mo><mspace data-latex=\; width=0.278em></mspace><mrow data-latex=\left(\frac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1}{p}><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mrow data-latex=\left(\frac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_2}{p}><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
a_1\equiv a_2\pmod p\implies \left(\frac{a_1}{p}\right)=\left(\frac{a_2}{p}\right).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><p>由 1 得</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{a_1a_2}{p}\right)\equiv a_1^{\frac{p-1}{2}}a_2^{\frac{p-1}{2}}\equiv\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right)\pmod p.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{a_1a_2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="a_1 a_2"><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msubsup data-latex=a_1^{\frac{p-1}{2}} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msubsup data-latex=a_2^{\frac{p-1}{2}}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a_1}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(\frac{a_2}{p}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{a_1a_2}{p}\right)\equiv a_1^{\frac{p-1}{2}}a_2^{\frac{p-1}{2}}\equiv\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right)\pmod p." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{a_1a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1a_2}{p}><mrow data-latex="a_1 a_2"><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\equiv>≡</mo><msubsup data-latex=a_1^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msubsup><msubsup data-latex=a_2^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mn data-latex=2>2</mn><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msubsup><mo data-latex=\equiv>≡</mo><mrow data-latex=\left(\frac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1}{p}><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(\frac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_2}{p}><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{a_1a_2}{p}\right)\equiv a_1^{\frac{p-1}{2}}a_2^{\frac{p-1}{2}}\equiv\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right)\pmod p.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left|\left(\dfrac{a_1a_2}{p}\right)-\left(\dfrac{a_1}{p}\right)\left(\dfrac{a_2}{p}\right)\right|\leq 2" aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex=\left|\left(\dfrac{a_1a_2}{p}\right)-\left(\dfrac{a_1}{p}\right)\left(\dfrac{a_2}{p}\right)\right|><mjx-mo data-latex=\left|><mjx-c class="mjx-c2223 NCM-S4">∣</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\dfrac{a_1a_2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_1a_2}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="a_1 a_2"><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\dfrac{a_1}{p}\right) space=3><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_1}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(\dfrac{a_2}{p}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a_2}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\right|><mjx-c class="mjx-c2223 NCM-S4">∣</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left|\left(\dfrac{a_1a_2}{p}\right)-\left(\dfrac{a_1}{p}\right)\left(\dfrac{a_2}{p}\right)\right|\leq 2" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left|\left(\dfrac{a_1a_2}{p}\right)-\left(\dfrac{a_1}{p}\right)\left(\dfrac{a_2}{p}\right)\right| data-mjx-texclass=INNER><mo data-latex=\left| data-mjx-texclass=OPEN>|</mo><mrow data-latex=\left(\dfrac{a_1a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_1a_2}{p} displaystyle=true><mfrac><mrow data-latex="a_1 a_2"><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub></mrow><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=->−</mo><mrow data-latex=\left(\dfrac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_1}{p} displaystyle=true><mfrac><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(\dfrac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a_2}{p} displaystyle=true><mfrac><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=\right| data-mjx-texclass=CLOSE>|</mo></mrow><mo data-latex=\leq>≤</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="\left|\left(\dfrac{a_1a_2}{p}\right)-\left(\dfrac{a_1}{p}\right)\left(\dfrac{a_2}{p}\right)\right|\leq 2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p>2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p>2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=">">></mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="p>2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，故</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{a_1a_2}{p}\right)=\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right).
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{a_1a_2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="a_1 a_2"><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex=\left(\frac{a_1}{p}\right) space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_1}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(\frac{a_2}{p}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a_2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-msub data-latex=a_2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{a_1a_2}{p}\right)=\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{a_1a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1a_2}{p}><mrow data-latex="a_1 a_2"><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mrow data-latex=\left(\frac{a_1}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_1}{p}><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(\frac{a_2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a_2}{p}><msub data-latex=a_2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msub><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{a_1a_2}{p}\right)=\left(\frac{a_1}{p}\right)\left(\frac{a_2}{p}\right).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li><p>参见 <a href=#二次互反律>二次互反律</a></p></li></ol></details><p>基于如上性质，若对任意奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=q><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=q></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{p}{q}\right)><mjx-mrow data-latex=\left(\dfrac{p}{q}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p}{q}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{p}{q}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{p}{q}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{p}{q} displaystyle=true><mfrac><mi data-latex=p>p</mi><mi data-latex=q>q</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{p}{q}\right)></mjx-container> 的值均可计算，则我们就可以对任意合法情况计算 Legendre 符号的值．接下来我们有一个优美的定理，这个定理巧妙地在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{p}{q}\right)><mjx-mrow data-latex=\left(\dfrac{p}{q}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p}{q}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{p}{q}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{p}{q}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{p}{q} displaystyle=true><mfrac><mi data-latex=p>p</mi><mi data-latex=q>q</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{p}{q}\right)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{q}{p}\right)><mjx-mrow data-latex=\left(\dfrac{q}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{q}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{q}{p}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{q}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{q}{p} displaystyle=true><mfrac><mi data-latex=q>q</mi><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{q}{p}\right)></mjx-container> 之间建立起了联系，使得我们能用类似 <a href=../gcd/#欧几里得算法>辗转相除法</a> 的思路完成计算．</p><h3 id=二次互反律>二次互反律<a title="Permanent link" class=headerlink href=#二次互反律></a></h3><details class=note open><summary>二次互反律</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=q><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=q xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=q>q</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=q></mjx-container> 是两个不同的奇素数，则</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=(-1)^{\frac{p-1}{2}\frac{q-1}{2}}.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{p}{q}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p}{q}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(\frac{q}{p}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{q}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\frac{p-1}{2}\frac{q-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}\frac{q-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mfrac data-latex=\frac{q-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=q-1 size=s><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=(-1)^{\frac{p-1}{2}\frac{q-1}{2}}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{p}{q}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{p}{q}><mi data-latex=p>p</mi><mi data-latex=q>q</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(\frac{q}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{q}{p}><mi data-latex=q>q</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\frac{p-1}{2}\frac{q-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}\frac{q-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac><mfrac data-latex=\frac{q-1}{2}><mrow data-latex=q-1><mi data-latex=q>q</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=(-1)^{\frac{p-1}{2}\frac{q-1}{2}}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><p>证明方式很多<sup id=fnref:ref5><a class=footnote-ref href=#fn:ref5>1</a></sup>．一种证明方式是基于如下引理<sup id=fnref:ref6><a class=footnote-ref href=#fn:ref6>2</a></sup>：</p><details class=note open><summary>Gauss 引理</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 是奇素数，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(n,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(n,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(n,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，对整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="k~\left(1\leq k\leq (p-1)/2\right)" aria-hidden=true class=NCM-N><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mtext data-latex=~><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mrow data-latex="\left(1\leq k\leq (p-1)/2\right)" space=2><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\leq space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=k space=4><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\leq space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="k~\left(1\leq k\leq (p-1)/2\right)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mtext data-latex=~> </mtext><mrow data-latex="\left(1\leq k\leq (p-1)/2\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=1>1</mn><mo data-latex=\leq>≤</mo><mi data-latex=k>k</mi><mo data-latex=\leq>≤</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img title="k~\left(1\leq k\leq (p-1)/2\right)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="r_k=nk\bmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=r_k><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="r_k=nk\bmod p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub><mo data-latex="=">=</mo><mi data-latex=n>n</mi><mi data-latex=k>k</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="r_k=nk\bmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="A=\{r_k:r_k < p/2\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=r_k><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msub data-latex=r_k space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="A=\{r_k:r_k < p/2\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=A>A</mi><mo data-latex="=">=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub><mo data-latex=:>:</mo><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mn data-latex=2>2</mn><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="A=\{r_k:r_k < p/2\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="B=\{r_k:r_k > p/2\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=r_k><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msub data-latex=r_k space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="B=\{r_k:r_k > p/2\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=B>B</mi><mo data-latex="=">=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub><mo data-latex=:>:</mo><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub><mo data-latex=">">></mo><mi data-latex=p>p</mi><mo data-latex=/>/</mo><mn data-latex=2>2</mn><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="B=\{r_k:r_k > p/2\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{n}{p}\right)=(-1)^{|B|}.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{n}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{n}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{|B|}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={|B|} size=s texclass=ORD><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{n}{p}\right)=(-1)^{|B|}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{n}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{n}{p}><mi data-latex=n>n</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{|B|}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={|B|} data-mjx-texclass=ORD><mo data-latex=| data-mjx-texclass=ORD>|</mo><mi data-latex=B>B</mi><mo data-latex=| data-mjx-texclass=ORD>|</mo></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{n}{p}\right)=(-1)^{|B|}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note><summary>证明</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda=|A|" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=| space=4><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda=|A|" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex="=">=</mo><mo data-latex=| data-mjx-texclass=ORD>|</mo><mi data-latex=A>A</mi><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo></math></mjx-assistive-mml><img title="\lambda=|A|" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mu=|B|" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=| space=4><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mu=|B|" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\mu>μ</mi><mo data-latex="=">=</mo><mo data-latex=| data-mjx-texclass=ORD>|</mo><mi data-latex=B>B</mi><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo></math></mjx-assistive-mml><img title="\mu=|B|" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，显然 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda+\mu=(p-1)/2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\mu space=3><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda+\mu=(p-1)/2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=+>+</mo><mi data-latex=\mu>μ</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="\lambda+\mu=(p-1)/2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
n^{\frac{p-1}{2}}\left(\frac{p-1}{2}\right)!=\prod_{k=1}^{\frac{p-1}{2}} nk\equiv\prod_{a\in A}a\prod_{b\in B}b\pmod{p}.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=n^{\frac{p-1}{2}}><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mrow data-latex=\left(\frac{p-1}{2}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=! space=2><mjx-c class=mjx-c21>!</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\prod_{k=1}^{\frac{p-1}{2}}" space=4><mjx-over style=padding-bottom:.111em;padding-left:.038em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\prod><mjx-c class="mjx-c220F NCM-LO">∏</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.003em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-munder data-latex="\prod_{a\in A}" space=4><mjx-row><mjx-base style=padding-left:.049em><mjx-mo data-latex=\prod><mjx-c class="mjx-c220F NCM-LO">∏</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{a\in A}" size=s texclass=ORD><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-munder data-latex="\prod_{b\in B}" space=2><mjx-row><mjx-base style=padding-left:.017em><mjx-mo data-latex=\prod><mjx-c class="mjx-c220F NCM-LO">∏</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="n^{\frac{p-1}{2}}\left(\frac{p-1}{2}\right)!=\prod_{k=1}^{\frac{p-1}{2}} nk\equiv\prod_{a\in A}a\prod_{b\in B}b\pmod{p}." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=n^{\frac{p-1}{2}}><mi data-latex=n>n</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mrow data-latex=\left(\frac{p-1}{2}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=!>!</mo><mo data-latex="=">=</mo><munderover data-latex="\prod_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\prod>∏</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mi data-latex=n>n</mi><mi data-latex=k>k</mi><mo data-latex=\equiv>≡</mo><munder data-latex="\prod_{a\in A}"><mo data-latex=\prod>∏</mo><mrow data-latex="{a\in A}" data-mjx-texclass=ORD><mi data-latex=a>a</mi><mo data-latex=\in>∈</mo><mi data-latex=A>A</mi></mrow></munder><mi data-latex=a>a</mi><munder data-latex="\prod_{b\in B}"><mo data-latex=\prod>∏</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mi data-latex=b>b</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
n^{\frac{p-1}{2}}\left(\frac{p-1}{2}\right)!=\prod_{k=1}^{\frac{p-1}{2}} nk\equiv\prod_{a\in A}a\prod_{b\in B}b\pmod{p}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>我们知道对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=B><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=B xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=B>B</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=B></mjx-container> 中任意元素 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=b><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=b></mjx-container>，有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\dfrac{p}{2} < b < p" aria-hidden=true breakable=true class=NCM-N><mjx-mstyle data-latex=\dfrac{p}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=b space=4><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\dfrac{p}{2} < b < p" xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p}{2} displaystyle=true><mfrac><mi data-latex=p>p</mi><mn data-latex=2>2</mn></mfrac></mstyle><mo data-latex="<">&lt;</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="\dfrac{p}{2} < b < p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="0 < p-b < \dfrac{p}{2}" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p}{2} space=4><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="0 < p-b < \dfrac{p}{2}" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mstyle data-latex=\dfrac{p}{2} displaystyle=true><mfrac><mi data-latex=p>p</mi><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img title="0 < p-b < \dfrac{p}{2}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，进一步，对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=B><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=B xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=B>B</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=B></mjx-container> 中任意元素 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=b><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=b></mjx-container>，我们有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p-b\notin A" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\notin><mjx-c class=mjx-c2209>∉</mjx-c></mjx-mo><mjx-mi data-latex=A space=4><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p-b\notin A" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=\notin>∉</mo><mi data-latex=A>A</mi></math></mjx-assistive-mml><img title="p-b\notin A" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，否则若 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=A,B><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=A,B xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=A,B></mjx-container> 中分别存在元素 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a,b><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a,b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a,b></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a=p-b" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a=p-b" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex="=">=</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi></math></mjx-assistive-mml><img title="a=p-b" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则存在整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="0 < k_1,k_2 < (p-1)/2" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=4><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="0 < k_1,k_2 < (p-1)/2" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn><mo data-latex="<">&lt;</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex="<">&lt;</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="0 < k_1,k_2 < (p-1)/2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a=nk_1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a=nk_1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img title="a=nk_1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b=nk_2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msub data-latex=k_2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b=nk_2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex="=">=</mo><mi data-latex=n>n</mi><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img title="b=nk_2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\mid n(k_1+k_2)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\mid><mjx-c class=mjx-c2223>∣</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\mid n(k_1+k_2)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=\mid>∣</mo><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="p\mid n(k_1+k_2)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，由于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(n,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(n,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(n,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\mid (k_1+k_2)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\mid><mjx-c class=mjx-c2223>∣</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\mid (k_1+k_2)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=\mid>∣</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="p\mid (k_1+k_2)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，注意到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="0 < k_1+k_2 < p" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=4><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="0 < k_1+k_2 < p" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn><mo data-latex="<">&lt;</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex="<">&lt;</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="0 < k_1+k_2 < p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以产生矛盾．因此</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
n^{\frac{p-1}{2}}\left(\frac{p-1}{2}\right)!\equiv(-1)^{\mu}\prod_{a\in A}a\prod_{b\in B}(p-b)=(-1)^{\mu}\left(\frac{p-1}{2}\right)!\pmod{p},
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=n^{\frac{p-1}{2}}><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mrow data-latex=\left(\frac{p-1}{2}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=! space=2><mjx-c class=mjx-c21>!</mjx-c></mjx-mo><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\mu}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\mu} size=s texclass=ORD><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-munder data-latex="\prod_{a\in A}" space=2><mjx-row><mjx-base style=padding-left:.049em><mjx-mo data-latex=\prod><mjx-c class="mjx-c220F NCM-LO">∏</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{a\in A}" size=s texclass=ORD><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-munder data-latex="\prod_{b\in B}" space=2><mjx-row><mjx-base style=padding-left:.017em><mjx-mo data-latex=\prod><mjx-c class="mjx-c220F NCM-LO">∏</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\mu}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\mu} size=s texclass=ORD><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-mrow data-latex=\left(\frac{p-1}{2}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=! space=2><mjx-c class=mjx-c21>!</mjx-c></mjx-mo><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="n^{\frac{p-1}{2}}\left(\frac{p-1}{2}\right)!\equiv(-1)^{\mu}\prod_{a\in A}a\prod_{b\in B}(p-b)=(-1)^{\mu}\left(\frac{p-1}{2}\right)!\pmod{p}," display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=n^{\frac{p-1}{2}}><mi data-latex=n>n</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mrow data-latex=\left(\frac{p-1}{2}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=!>!</mo><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\mu}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\mu} data-mjx-texclass=ORD><mi data-latex=\mu>μ</mi></mrow></msup><munder data-latex="\prod_{a\in A}"><mo data-latex=\prod>∏</mo><mrow data-latex="{a\in A}" data-mjx-texclass=ORD><mi data-latex=a>a</mi><mo data-latex=\in>∈</mo><mi data-latex=A>A</mi></mrow></munder><mi data-latex=a>a</mi><munder data-latex="\prod_{b\in B}"><mo data-latex=\prod>∏</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\mu}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\mu} data-mjx-texclass=ORD><mi data-latex=\mu>μ</mi></mrow></msup><mrow data-latex=\left(\frac{p-1}{2}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=!>!</mo><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
n^{\frac{p-1}{2}}\left(\frac{p-1}{2}\right)!\equiv(-1)^{\mu}\prod_{a\in A}a\prod_{b\in B}(p-b)=(-1)^{\mu}\left(\frac{p-1}{2}\right)!\pmod{p},
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>即</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
n^{\frac{p-1}{2}}\equiv(-1)^{\mu}\pmod{p}.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=n^{\frac{p-1}{2}}><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\mu}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\mu} size=s texclass=ORD><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=n^{\frac{p-1}{2}}\equiv(-1)^{\mu}\pmod{p}. display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=n^{\frac{p-1}{2}}><mi data-latex=n>n</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\mu}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\mu} data-mjx-texclass=ORD><mi data-latex=\mu>μ</mi></mrow></msup><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
n^{\frac{p-1}{2}}\equiv(-1)^{\mu}\pmod{p}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>从而由 Legendre 符号的 <a href=#性质>性质 1</a> 即得证．</p></details><details class=tip><summary>推广</summary> <p>Gauss 引理可做如下推广<sup id=fnref:ref7><a class=footnote-ref href=#fn:ref7>7</a></sup>：</p> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 是奇素数，令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=I\subset\mathbf{Z}_p^*><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\subset><mjx-c class=mjx-c2282>⊂</mjx-c></mjx-mo><mjx-msubsup data-latex=\mathbf{Z}_p^* space=4><mjx-texatom data-latex=\mathbf{Z} texclass=ORD><mjx-mi data-latex=Z><mjx-c class=mjx-c1D419>𝐙</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-spacer style=margin-top:.325em></mjx-spacer><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=I\subset\mathbf{Z}_p^* xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=I>I</mi><mo data-latex=\subset>⊂</mo><msubsup data-latex=\mathbf{Z}_p^*><mrow data-latex=\mathbf{Z} data-mjx-texclass=ORD><mi data-latex=Z mathvariant=bold>Z</mi></mrow><mi data-latex=p>p</mi><mo data-latex=*>∗</mo></msubsup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=I\subset\mathbf{Z}_p^*></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="I\cup -I=\mathbf{Z}_p^*" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msubsup data-latex=\mathbf{Z}_p^* space=4><mjx-texatom data-latex=\mathbf{Z} texclass=ORD><mjx-mi data-latex=Z><mjx-c class=mjx-c1D419>𝐙</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-spacer style=margin-top:.325em></mjx-spacer><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="I\cup -I=\mathbf{Z}_p^*" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=I>I</mi><mo data-latex=\cup>∪</mo><mo data-latex=->−</mo><mi data-latex=I>I</mi><mo data-latex="=">=</mo><msubsup data-latex=\mathbf{Z}_p^*><mrow data-latex=\mathbf{Z} data-mjx-texclass=ORD><mi data-latex=Z mathvariant=bold>Z</mi></mrow><mi data-latex=p>p</mi><mo data-latex=*>∗</mo></msubsup></math></mjx-assistive-mml><img title="I\cup -I=\mathbf{Z}_p^*" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="I\cap -I=\varnothing" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cap><mjx-c class=mjx-c2229>∩</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\varnothing space=4><mjx-c class="mjx-c2205 NCM-V">∅</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="I\cap -I=\varnothing" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=I>I</mi><mo data-latex=\cap>∩</mo><mo data-latex=->−</mo><mi data-latex=I>I</mi><mo data-latex="=">=</mo><mi data-latex=\varnothing data-mjx-alternate=1>∅</mi></math></mjx-assistive-mml><img title="I\cap -I=\varnothing" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="-I:=\{-i:i\in I\}" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=":="><mjx-c class=mjx-c3A>:</mjx-c><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=i space=4><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=I space=4><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="-I:=\{-i:i\in I\}" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mi data-latex=I>I</mi><mo data-latex=":=" data-mjx-texclass=REL>:=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=->−</mo><mi data-latex=i>i</mi><mo data-latex=:>:</mo><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mi data-latex=I>I</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="-I:=\{-i:i\in I\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则对任意与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 互质的整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container>，</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{n}{p}\right)=(-1)^{|J|},
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{n}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{n}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{|J|}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={|J|} size=s texclass=ORD><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=J><mjx-c class=mjx-c1D43D>𝐽</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{n}{p}\right)=(-1)^{|J|}," display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{n}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{n}{p}><mi data-latex=n>n</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{|J|}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={|J|} data-mjx-texclass=ORD><mo data-latex=| data-mjx-texclass=ORD>|</mo><mi data-latex=J>J</mi><mo data-latex=| data-mjx-texclass=ORD>|</mo></mrow></msup><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
\left(\frac{n}{p}\right)=(-1)^{|J|},
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="J=\{j\in I:nj\in -I\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=J><mjx-c class=mjx-c1D43D>𝐽</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=I space=4><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="J=\{j\in I:nj\in -I\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=J>J</mi><mo data-latex="=">=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=j>j</mi><mo data-latex=\in>∈</mo><mi data-latex=I>I</mi><mo data-latex=:>:</mo><mi data-latex=n>n</mi><mi data-latex=j>j</mi><mo data-latex=\in>∈</mo><mo data-latex=->−</mo><mi data-latex=I>I</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="J=\{j\in I:nj\in -I\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</p> <p>不难发现取 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="I=\{1,2,\dots,(p-1)/2\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=I><mjx-c class=mjx-c1D43C>𝐼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo space=2><mjx-c class=mjx-c2026>…</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="I=\{1,2,\dots,(p-1)/2\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=I>I</mi><mo data-latex="=">=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mo>…</mo><mo data-latex=,>,</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="I=\{1,2,\dots,(p-1)/2\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 即可得到 Gauss 引理．证明方法和 Gauss 引理的证明基本相同，故省略．</p></details><p>容易得到如下推论：</p><details class=note open><summary>推论</summary> <p>对奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container>，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}
        1,  & p\equiv \pm 1\pmod 8, \\
        -1, & p\equiv \pm 3\pmod 8. \\
    \end{cases}
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{2}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{2}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^{\frac{p^2-1}{8}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p^2-1}{8}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p^2-1}{8}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex="p^2 -1" size=s><mjx-msup data-latex=p^2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=8 size=s><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:10.059em><mjx-table><mjx-itable><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=\pm space=4><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=8 space=2><mjx-c class=mjx-c38>8</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=\pm space=4><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=3><mjx-c class=mjx-c33>3</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=8 space=2><mjx-c class=mjx-c38>8</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}1,  & p\equiv \pm 1\pmod 8, \\-1, & p\equiv \pm 3\pmod 8. \\\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{2}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{2}{p}><mn data-latex=2>2</mn><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=)^{\frac{p^2-1}{8}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p^2-1}{8}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p^2-1}{8}><mrow data-latex="p^2 -1"><msup data-latex=p^2><mi data-latex=p>p</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=8>8</mn></mfrac></mrow></msup><mo data-latex="=">=</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=8>8</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mo data-latex=\pm>±</mo><mn data-latex=3>3</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=8>8</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
\left(\frac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}
        1,  & p\equiv \pm 1\pmod 8, \\
        -1, & p\equiv \pm 3\pmod 8. \\
    \end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>对奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container>，奇数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(n,p)=1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(n,p)=1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="(n,p)=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{n}{p}\right)=(-1)^{\sum_{i=1}^{(p-1)/2}\lfloor ni/p \rfloor}.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{n}{p}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{n}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=")^{\sum_{i=1}^{(p-1)/2}\lfloor n i/p\rfloor}"><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{\sum_{i=1}^{(p-1)/2}\lfloor n i/p\rfloor}" size=s texclass=ORD><mjx-munderover data-latex="\sum_{i=1}^{(p-1)/2}" limits=false><mjx-mo data-latex=\sum><mjx-c class=mjx-c2211>∑</mjx-c></mjx-mo><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={(p-1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-munderover><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{n}{p}\right)=(-1)^{\sum_{i=1}^{(p-1)/2}\lfloor ni/p \rfloor}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{n}{p}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{n}{p}><mi data-latex=n>n</mi><mi data-latex=p>p</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><msup data-latex=")^{\sum_{i=1}^{(p-1)/2}\lfloor n i/p\rfloor}"><mo data-latex=) stretchy=false>)</mo><mrow data-latex="{\sum_{i=1}^{(p-1)/2}\lfloor n i/p\rfloor}" data-mjx-texclass=ORD><munderover data-latex="\sum_{i=1}^{(p-1)/2}"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={(p-1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></munderover><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=n>n</mi><mi data-latex=i>i</mi><mo data-latex=/>/</mo><mi data-latex=p>p</mi><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{n}{p}\right)=(-1)^{\sum_{i=1}^{(p-1)/2}\lfloor ni/p \rfloor}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note><summary>证明</summary> <p>对 Gauss 引理中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n,k,r_k,A,B,\lambda,\mu><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=k space=2><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=r_k space=2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=A space=2><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=2><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\mu space=2><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n,k,r_k,A,B,\lambda,\mu xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub><mo data-latex=,>,</mo><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi><mo data-latex=,>,</mo><mi data-latex=\lambda>λ</mi><mo data-latex=,>,</mo><mi data-latex=\mu>μ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n,k,r_k,A,B,\lambda,\mu></mjx-container>，有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="nk=p\left\lfloor\dfrac{nk}{p}\right\rfloor+r_k" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{nk}{p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=r_k space=3><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="nk=p\left\lfloor\dfrac{nk}{p}\right\rfloor+r_k" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mi data-latex=p>p</mi><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mstyle data-latex=\dfrac{nk}{p} displaystyle=true><mfrac><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><msub data-latex=r_k><mi data-latex=r>r</mi><mi data-latex=k>k</mi></msub></math></mjx-assistive-mml><img title="nk=p\left\lfloor\dfrac{nk}{p}\right\rfloor+r_k" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，进而</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
    n\cdot\frac{p^2-1}{8}=\sum_{k=1}^{\frac{p-1}{2}}nk&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}b\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}(p-b)+2\sum_{b\in B}b-p\mu\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{k=1}^{\frac{p-1}{2}}k+2\sum_{b\in B}b-p\mu\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\frac{p^2-1}{8}+2\sum_{b\in B}b-p\mu,
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
    n\cdot\frac{p^2-1}{8}=\sum_{k=1}^{\frac{p-1}{2}}nk&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}b\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}(p-b)+2\sum_{b\in B}b-p\mu\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{k=1}^{\frac{p-1}{2}}k+2\sum_{b\in B}b-p\mu\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\frac{p^2-1}{8}+2\sum_{b\in B}b-p\mu,
\end{aligned}" style=min-width:29.993em><mjx-table><mjx-itable><mjx-mtr data-latex="
    " style=height:3.329em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p^2-1}{8} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="p^2 -1"><mjx-msup data-latex=p^2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=8><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=4><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=2><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{nk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{a\in A}" space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.034em><mjx-texatom data-latex="{a\in A}" size=s texclass=ORD><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{b\in B}" space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.066em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
    " style=height:3.329em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=2><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{nk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{a\in A}" space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.034em><mjx-texatom data-latex="{a\in A}" size=s texclass=ORD><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=a space=2><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{b\in B}" space=3><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.066em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munder data-latex="\sum_{b\in B}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.066em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=p space=3><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
    " style=height:3.314em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=2><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{nk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=3><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi data-latex=k space=2><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munder data-latex="\sum_{b\in B}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.066em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=p space=3><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
    " style=height:3.314em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=2><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{nk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p^2-1}{8} space=3><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="p^2 -1"><mjx-msup data-latex=p^2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=8><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munder data-latex="\sum_{b\in B}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.066em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=p space=3><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}n\cdot\frac{p^2-1}{8}=\sum_{k=1}^{\frac{p-1}{2}}nk&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}b\\&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}(p-b)+2\sum_{b\in B}b-p\mu\\&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{k=1}^{\frac{p-1}{2}}k+2\sum_{b\in B}b-p\mu\\&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\frac{p^2-1}{8}+2\sum_{b\in B}b-p\mu,\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}n\cdot\frac{p^2-1}{8}=\sum_{k=1}^{\frac{p-1}{2}}nk&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}b\\&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}(p-b)+2\sum_{b\in B}b-p\mu\\&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{k=1}^{\frac{p-1}{2}}k+2\sum_{b\in B}b-p\mu\\&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\frac{p^2-1}{8}+2\sum_{b\in B}b-p\mu,\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=n>n</mi><mo data-latex=\cdot>⋅</mo><mfrac data-latex=\frac{p^2-1}{8}><mrow data-latex="p^2 -1"><msup data-latex=p^2><mi data-latex=p>p</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=8>8</mn></mfrac><mo data-latex="=">=</mo><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=p>p</mi><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{nk}{p}><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><munder data-latex="\sum_{a\in A}"><mo data-latex=\sum>∑</mo><mrow data-latex="{a\in A}" data-mjx-texclass=ORD><mi data-latex=a>a</mi><mo data-latex=\in>∈</mo><mi data-latex=A>A</mi></mrow></munder><mi data-latex=a>a</mi><mo data-latex=+>+</mo><munder data-latex="\sum_{b\in B}"><mo data-latex=\sum>∑</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mi data-latex=b>b</mi></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=p>p</mi><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{nk}{p}><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><munder data-latex="\sum_{a\in A}"><mo data-latex=\sum>∑</mo><mrow data-latex="{a\in A}" data-mjx-texclass=ORD><mi data-latex=a>a</mi><mo data-latex=\in>∈</mo><mi data-latex=A>A</mi></mrow></munder><mi data-latex=a>a</mi><mo data-latex=+>+</mo><munder data-latex="\sum_{b\in B}"><mo data-latex=\sum>∑</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mn data-latex=2>2</mn><munder data-latex="\sum_{b\in B}"><mo data-latex=\sum>∑</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mi data-latex=b>b</mi><mo data-latex=->−</mo><mi data-latex=p>p</mi><mi data-latex=\mu>μ</mi></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=p>p</mi><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{nk}{p}><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mi data-latex=k>k</mi><mo data-latex=+>+</mo><mn data-latex=2>2</mn><munder data-latex="\sum_{b\in B}"><mo data-latex=\sum>∑</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mi data-latex=b>b</mi><mo data-latex=->−</mo><mi data-latex=p>p</mi><mi data-latex=\mu>μ</mi></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=p>p</mi><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{nk}{p}><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mfrac data-latex=\frac{p^2-1}{8}><mrow data-latex="p^2 -1"><msup data-latex=p^2><mi data-latex=p>p</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=8>8</mn></mfrac><mo data-latex=+>+</mo><mn data-latex=2>2</mn><munder data-latex="\sum_{b\in B}"><mo data-latex=\sum>∑</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mi data-latex=b>b</mi><mo data-latex=->−</mo><mi data-latex=p>p</mi><mi data-latex=\mu>μ</mi><mo data-latex=,>,</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
    n\cdot\frac{p^2-1}{8}=\sum_{k=1}^{\frac{p-1}{2}}nk&=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}b\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{a\in A}a+\sum_{b\in B}(p-b)+2\sum_{b\in B}b-p\mu\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\sum_{k=1}^{\frac{p-1}{2}}k+2\sum_{b\in B}b-p\mu\\
    &=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+\frac{p^2-1}{8}+2\sum_{b\in B}b-p\mu,
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
(n-1)\frac{p^2-1}{8}=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+2\sum_{b\in B}b-p\mu.
" aria-hidden=true class=NCM-N display=true><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{p^2-1}{8}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="p^2 -1"><mjx-msup data-latex=p^2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=8><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=p space=4><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=2><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{nk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-munder data-latex="\sum_{b\in B}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.066em><mjx-texatom data-latex="{b\in B}" size=s texclass=ORD><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=b space=2><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=p space=3><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=\mu><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="(n-1)\frac{p^2-1}{8}=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+2\sum_{b\in B}b-p\mu." display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mfrac data-latex=\frac{p^2-1}{8}><mrow data-latex="p^2 -1"><msup data-latex=p^2><mi data-latex=p>p</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=8>8</mn></mfrac><mo data-latex="=">=</mo><mi data-latex=p>p</mi><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{nk}{p}><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mn data-latex=2>2</mn><munder data-latex="\sum_{b\in B}"><mo data-latex=\sum>∑</mo><mrow data-latex="{b\in B}" data-mjx-texclass=ORD><mi data-latex=b>b</mi><mo data-latex=\in>∈</mo><mi data-latex=B>B</mi></mrow></munder><mi data-latex=b>b</mi><mo data-latex=->−</mo><mi data-latex=p>p</mi><mi data-latex=\mu>μ</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
(n-1)\frac{p^2-1}{8}=p\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor+2\sum_{b\in B}b-p\mu.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>若 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="n=2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="n=2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mo data-latex="=">=</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="n=2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="0 < \dfrac{nk}{p}\leq\dfrac{p-1}{p} < 1" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{nk}{p} space=4><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p-1}{p} space=4><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="0 < \dfrac{nk}{p}\leq\dfrac{p-1}{p} < 1" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn><mo data-latex="<">&lt;</mo><mstyle data-latex=\dfrac{nk}{p} displaystyle=true><mfrac><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex=\leq>≤</mo><mstyle data-latex=\dfrac{p-1}{p} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mi data-latex=p>p</mi></mfrac></mstyle><mo data-latex="<">&lt;</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="0 < \dfrac{nk}{p}\leq\dfrac{p-1}{p} < 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，从而有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\frac{p^2-1}{8}\equiv\mu\pmod{2}.
" aria-hidden=true class=NCM-N display=true><mjx-mfrac data-latex=\frac{p^2-1}{8}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="p^2 -1"><mjx-msup data-latex=p^2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=8><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=\mu space=4><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=\frac{p^2-1}{8}\equiv\mu\pmod{2}. display=block xmlns=http://www.w3.org/1998/Math/MathML><mfrac data-latex=\frac{p^2-1}{8}><mrow data-latex="p^2 -1"><msup data-latex=p^2><mi data-latex=p>p</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=8>8</mn></mfrac><mo data-latex=\equiv>≡</mo><mi data-latex=\mu>μ</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=2>2</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\frac{p^2-1}{8}\equiv\mu\pmod{2}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>若 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="2\nmid n" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex=\nmid><mjx-c class=mjx-c2224>∤</mjx-c></mjx-mo><mjx-mi data-latex=n space=4><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="2\nmid n" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn><mo data-latex=\nmid>∤</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="2\nmid n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor\equiv\mu\pmod{2}.
" aria-hidden=true class=NCM-N display=true><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{nk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=nk><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=\mu space=4><mjx-c class=mjx-c1D707>𝜇</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor\equiv\mu\pmod{2}." display=block xmlns=http://www.w3.org/1998/Math/MathML><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{nk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{nk}{p}><mrow data-latex=nk><mi data-latex=n>n</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=\equiv>≡</mo><mi data-latex=\mu>μ</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=2>2</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{nk}{p}\right\rfloor\equiv\mu\pmod{2}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><p>根据如上推论，证明二次互反律只需验证</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\frac{p-1}{2}\frac{q-1}{2}=\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{qk}{p}\right\rfloor+\sum_{k=1}^{\frac{q-1}{2}}\left\lfloor\dfrac{pk}{q}\right\rfloor.
" aria-hidden=true class=NCM-N display=true><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mfrac data-latex=\frac{q-1}{2}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=q-1><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}" space=4><mjx-over style=padding-bottom:.111em;padding-left:.121em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{qk}{p}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{qk}{p}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=qk><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{k=1}^{\frac{q-1}{2}}" space=3><mjx-over style=padding-bottom:.111em;padding-left:.134em><mjx-texatom data-latex={\frac{q-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{q-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=q-1 size=s><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.086em><mjx-texatom data-latex="{k=1}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\left\lfloor\dfrac{pk}{q}\right\rfloor space=2><mjx-mo data-latex=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{pk}{q}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=pk><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=. space=2><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\frac{p-1}{2}\frac{q-1}{2}=\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{qk}{p}\right\rfloor+\sum_{k=1}^{\frac{q-1}{2}}\left\lfloor\dfrac{pk}{q}\right\rfloor." display=block xmlns=http://www.w3.org/1998/Math/MathML><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac><mfrac data-latex=\frac{q-1}{2}><mrow data-latex=q-1><mi data-latex=q>q</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac><mo data-latex="=">=</mo><munderover data-latex="\sum_{k=1}^{\frac{p-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{qk}{p}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{qk}{p}><mrow data-latex=qk><mi data-latex=q>q</mi><mi data-latex=k>k</mi></mrow><mi data-latex=p>p</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><munderover data-latex="\sum_{k=1}^{\frac{q-1}{2}}"><mo data-latex=\sum>∑</mo><mrow data-latex="{k=1}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mrow data-latex={\frac{q-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{q-1}{2}><mrow data-latex=q-1><mi data-latex=q>q</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></munderover><mrow data-latex=\left\lfloor\dfrac{pk}{q}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{pk}{q}><mrow data-latex=pk><mi data-latex=p>p</mi><mi data-latex=k>k</mi></mrow><mi data-latex=q>q</mi></mfrac><mo data-latex=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\frac{p-1}{2}\frac{q-1}{2}=\sum_{k=1}^{\frac{p-1}{2}}\left\lfloor\dfrac{qk}{p}\right\rfloor+\sum_{k=1}^{\frac{q-1}{2}}\left\lfloor\dfrac{pk}{q}\right\rfloor.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p>考虑由点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(px,qy)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=q space=2><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(px,qy) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=q>q</mi><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(px,qy)></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="1\leq x\leq \dfrac{q-1}{2},1\leq y\leq \dfrac{p-1}{2}" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{q-1}{2} space=4><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=q-1><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\leq><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p-1}{2} space=4><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="1\leq x\leq \dfrac{q-1}{2},1\leq y\leq \dfrac{p-1}{2}" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn><mo data-latex=\leq>≤</mo><mi data-latex=x>x</mi><mo data-latex=\leq>≤</mo><mstyle data-latex=\dfrac{q-1}{2} displaystyle=true><mfrac><mrow data-latex=q-1><mi data-latex=q>q</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=\leq>≤</mo><mi data-latex=y>y</mi><mo data-latex=\leq>≤</mo><mstyle data-latex=\dfrac{p-1}{2} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img title="1\leq x\leq \dfrac{q-1}{2},1\leq y\leq \dfrac{p-1}{2}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 构成的集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container>，将其根据 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=px><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=px xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=px></mjx-container> 与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=qy><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=qy xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=q>q</mi><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=qy></mjx-container> 的大小关系分成两部分（显然 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="px\neq qy" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\neq><mjx-c class=mjx-c2260>≠</mjx-c></mjx-mo><mjx-mi data-latex=q space=4><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="px\neq qy" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mi data-latex=x>x</mi><mo data-latex=\neq>≠</mo><mi data-latex=q>q</mi><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="px\neq qy" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>），分别验证三个集合的大小即可．</p><p>二次互反律不仅能用于判断数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 是否是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次剩余，还能用于确定使数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 为二次剩余的模数的结构．</p><details class=example open><summary>Example</summary> <ul><li>使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=5><mjx-mn data-latex=5><mjx-c class=mjx-c35>5</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=5 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=5>5</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=5></mjx-container> 为二次剩余的奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\equiv \pm 1\pmod 5." aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=5 space=2><mjx-c class=mjx-c35>5</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\equiv \pm 1\pmod 5." xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=5>5</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="p\equiv \pm 1\pmod 5." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li>使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-3><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=3><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-3 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mn data-latex=3>3</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-3></mjx-container> 为二次剩余的奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\equiv 1\pmod 3." aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=3 space=2><mjx-c class=mjx-c33>3</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\equiv 1\pmod 3." xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=3>3</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="p\equiv 1\pmod 3." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li><li>使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-2><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-2 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-2></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=3><mjx-mn data-latex=3><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=3 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=3>3</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=3></mjx-container> 同时为二次剩余的奇素数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\equiv 11\pmod{24}." aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=11 space=4><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c31 style=padding-top:.666em>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mn data-latex=24 space=2><mjx-c class=mjx-c32 noic=true style=padding-top:.677em>2</mjx-c><mjx-c class=mjx-c34 style=padding-top:.677em>4</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\equiv 11\pmod{24}." xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=\equiv>≡</mo><mn data-latex=11>11</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mn data-latex=24>24</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="p\equiv 11\pmod{24}." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></li></ul></details><p>另外，我们还可以证明诸如「形如 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=4k+1><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=4k+1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=4>4</mn><mi data-latex=k>k</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=4k+1></mjx-container> 的素数有无限多个」之类的结论，这一类结论实际上是 <a href=https://en.wikipedia.org/wiki/Dirichlet%27s_theorem_on_arithmetic_progressions target=_blank>Dirichlet 定理</a> 的简单推论．</p><h2 id=jacobi-符号>Jacobi 符号<a title="Permanent link" class=headerlink href=#jacobi-符号></a></h2><p>根据二次互反律，我们可以很自然地想到一种推广 Legendre 符号的方法：</p><details class=abstract open><summary>Jacobi 符号</summary> <p>对 <strong>正奇数</strong> <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m=p_1^{\alpha_1}\dots p_k^{\alpha_k}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msubsup data-latex=p_1^{\alpha_1} space=4><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={\alpha_1} size=s texclass=ORD><mjx-msub data-latex=\alpha_1><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo space=2><mjx-c class=mjx-c2026>…</mjx-c></mjx-mo><mjx-msubsup data-latex=p_k^{\alpha_k} space=2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.317em;margin-left:0><mjx-texatom data-latex={\alpha_k} size=s texclass=ORD><mjx-msub data-latex=\alpha_k><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m=p_1^{\alpha_1}\dots p_k^{\alpha_k}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex="=">=</mo><msubsup data-latex=p_1^{\alpha_1}><mi data-latex=p>p</mi><mn data-latex=1>1</mn><mrow data-latex={\alpha_1} data-mjx-texclass=ORD><msub data-latex=\alpha_1><mi data-latex=\alpha>α</mi><mn data-latex=1>1</mn></msub></mrow></msubsup><mo>…</mo><msubsup data-latex=p_k^{\alpha_k}><mi data-latex=p>p</mi><mi data-latex=k>k</mi><mrow data-latex={\alpha_k} data-mjx-texclass=ORD><msub data-latex=\alpha_k><mi data-latex=\alpha>α</mi><mi data-latex=k>k</mi></msub></mrow></msubsup></math></mjx-assistive-mml><img title="m=p_1^{\alpha_1}\dots p_k^{\alpha_k}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p_1,\dots,p_k><mjx-msub data-latex=p_1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo space=2><mjx-c class=mjx-c2026>…</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=p_k space=2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p_1,\dots,p_k xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=p_1><mi data-latex=p>p</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><mo>…</mo><mo data-latex=,>,</mo><msub data-latex=p_k><mi data-latex=p>p</mi><mi data-latex=k>k</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p_1,\dots,p_k></mjx-container> 是素数，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\alpha_1,\dots,\alpha_k><mjx-msub data-latex=\alpha_1><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo space=2><mjx-c class=mjx-c2026>…</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=\alpha_k space=2><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\alpha_1,\dots,\alpha_k xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\alpha_1><mi data-latex=\alpha>α</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><mo>…</mo><mo data-latex=,>,</mo><msub data-latex=\alpha_k><mi data-latex=\alpha>α</mi><mi data-latex=k>k</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\alpha_1,\dots,\alpha_k></mjx-container> 是正整数，定义 Jacobi 符号如下：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(\frac{a}{m}\right):=\prod_{i=1}^k\left(\frac{a}{p_i}\right)^{\alpha_i}.
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex=\left(\frac{a}{m}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{m}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=":=" space=4><mjx-c class=mjx-c3A>:</mjx-c><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\prod_{i=1}^k" space=4><mjx-over style=padding-bottom:.192em;padding-left:.455em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\prod><mjx-c class="mjx-c220F NCM-LO">∏</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.065em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msup data-latex=\left(\frac{a}{p_i}\right)^{\alpha_i} space=2><mjx-mrow data-latex=\left(\frac{a}{p_i}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{p_i}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-msub data-latex=p_i><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.023em><mjx-texatom data-latex={\alpha_i} size=s texclass=ORD><mjx-msub data-latex=\alpha_i><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(\frac{a}{m}\right):=\prod_{i=1}^k\left(\frac{a}{p_i}\right)^{\alpha_i}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{a}{m}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a}{m}><mi data-latex=a>a</mi><mi data-latex=m>m</mi></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=":=" data-mjx-texclass=REL>:=</mo><munderover data-latex="\prod_{i=1}^k"><mo data-latex=\prod>∏</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=k>k</mi></munderover><msup data-latex=\left(\frac{a}{p_i}\right)^{\alpha_i}><mrow data-latex=\left(\frac{a}{p_i}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a}{p_i}><mi data-latex=a>a</mi><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={\alpha_i} data-mjx-texclass=ORD><msub data-latex=\alpha_i><mi data-latex=\alpha>α</mi><mi data-latex=i>i</mi></msub></mrow></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(\frac{a}{m}\right):=\prod_{i=1}^k\left(\frac{a}{p_i}\right)^{\alpha_i}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>其中等式右端的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\frac{a}{p_i}\right)><mjx-mrow data-latex=\left(\frac{a}{p_i}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S3">(</mjx-c></mjx-mo><mjx-mfrac data-latex=\frac{a}{p_i}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi data-latex=a size=s><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-msub data-latex=p_i size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S3">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\frac{a}{p_i}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\frac{a}{p_i}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mfrac data-latex=\frac{a}{p_i}><mi data-latex=a>a</mi><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub></mfrac><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\frac{a}{p_i}\right)></mjx-container> 为 <a href=#legendre-符号>Legendre 符号</a>．另外对整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left(\dfrac{a}{1}\right)=1." aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex=\left(\dfrac{a}{1}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{1}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1. space=4><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left(\dfrac{a}{1}\right)=1." xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{1}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{1} displaystyle=true><mfrac><mi data-latex=a>a</mi><mn data-latex=1>1</mn></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mn data-latex=1.>1.</mn></math></mjx-assistive-mml><img title="\left(\dfrac{a}{1}\right)=1." src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></p></details><details class=warning open><summary>Warning</summary> <p>我们一般不区分 Legendre 符号和 Jacobi 符号，因为由完全积性可知 Jacobi 符号具有和 Legendre 符号一样的性质，所以这两种符号的计算方法是一致的．但是有一点需要注意：当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> <strong>不是奇素数</strong> 时，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{a}{m}\right)><mjx-mrow data-latex=\left(\dfrac{a}{m}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{m}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{a}{m}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{m}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{m} displaystyle=true><mfrac><mi data-latex=a>a</mi><mi data-latex=m>m</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{a}{m}\right)></mjx-container> 的值与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是否是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的二次剩余 <strong>无关</strong>，但是若 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left(\dfrac{a}{m}\right)=-1" aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex=\left(\dfrac{a}{m}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{m}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left(\dfrac{a}{m}\right)=-1" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{m}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{m} displaystyle=true><mfrac><mi data-latex=a>a</mi><mi data-latex=m>m</mi></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex="=">=</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="\left(\dfrac{a}{m}\right)=-1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，则说明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 至少存在一个（实际上是奇数个）素因子 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次非剩余，从而此时 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的二次非剩余．</p></details><p>我们还可以把模数进一步推广为 <strong>整数</strong>（只需补充 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{a}{-1}\right)><mjx-mrow data-latex=\left(\dfrac{a}{-1}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{-1}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=-1><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{a}{-1}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{-1}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{-1} displaystyle=true><mfrac><mi data-latex=a>a</mi><mrow data-latex=-1><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{a}{-1}\right)></mjx-container>、<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{a}{0}\right)><mjx-mrow data-latex=\left(\dfrac{a}{0}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{0}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{a}{0}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{0}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{0} displaystyle=true><mfrac><mi data-latex=a>a</mi><mn data-latex=0>0</mn></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{a}{0}\right)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\left(\dfrac{a}{2}\right)><mjx-mrow data-latex=\left(\dfrac{a}{2}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S4">(</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{a}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S4">)</mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\left(\dfrac{a}{2}\right) xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\left(\dfrac{a}{2}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mstyle data-latex=\dfrac{a}{2} displaystyle=true><mfrac><mi data-latex=a>a</mi><mn data-latex=2>2</mn></mfrac></mstyle><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\left(\dfrac{a}{2}\right)></mjx-container> 的定义），这样就得到了 <a href=https://en.wikipedia.org/wiki/Kronecker_symbol target=_blank>Kronecker 符号</a>．</p><h2 id=模意义下开平方>模意义下开平方<a title="Permanent link" class=headerlink href=#模意义下开平方></a></h2><p>本节讨论模意义下开平方的算法．特别地，本节主要介绍素数模的情形．对于一般模数的情形，可以参考 <a href=../residue/#模意义下开方>模意义下开高次方</a> 的讨论．</p><h3 id=特殊情况时的算法>特殊情况时的算法<a title="Permanent link" class=headerlink href=#特殊情况时的算法></a></h3><p>对于同余方程 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^2\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^2\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^2\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 为奇素数且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为二次剩余在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\bmod 4=3" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=3 space=4><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\bmod 4=3" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mn data-latex=4>4</mn><mo data-latex="=">=</mo><mn data-latex=3>3</mn></math></mjx-assistive-mml><img title="p\bmod 4=3" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时有更简单的解法，考虑</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\left(a^{(p+1)/4}\right)^2&\equiv a^{(p+1)/2}&\pmod p\\
&\equiv x^{p+1}&\pmod p\\
&\equiv \left(x^2\right)\left(x^{p-1}\right)&\pmod p\\
&\equiv x^2&\pmod p&\quad (\because{\text{Fermat's little theorem}})
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)&\quad (\because{\text{Fermat's little theorem}})
\end{aligned}" style=min-width:30.269em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.642em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msup data-latex=\left(a^{(p+1)/4}\right)^2><mjx-mrow data-latex=\left(a^{(p+1)/4}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S3">(</mjx-c></mjx-mo><mjx-msup data-latex=a^{(p+1)/4}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={(p+1)/4} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S3">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.699em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^{(p+1)/2} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={(p+1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-left:1em;padding-right:0><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=x^{p+1} space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p+1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:right;padding:.15em 0 .15em 1em"><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.231em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mrow data-latex="\left(x^2 \right)" space=4><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow><mjx-mrow data-latex=\left(x^{p-1}\right) space=2><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-msup data-latex=x^{p-1}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p-1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:right;padding:.15em 0 .15em 1em"><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=x^2 space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-left:1em;padding-right:0><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\quad style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\because><mjx-c class=mjx-c2235>∵</mjx-c></mjx-mo><mjx-texatom data-latex="{\text{Fermat's little theorem}}" space=4 texclass=ORD><mjx-mtext data-latex="\text{Fermat's little theorem}"><mjx-c class=mjx-c46 noic=true style=padding-top:.705em>F</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.705em>e</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.705em>r</mjx-c><mjx-c class=mjx-c6D noic=true style=padding-top:.705em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.705em>a</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.705em>t</mjx-c><mjx-c class=mjx-c27 noic=true style=padding-top:.705em>'</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.705em>s</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.705em> </mjx-c><mjx-c class=mjx-c6C noic=true style=padding-top:.705em>l</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.705em>i</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.705em>t</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.705em>t</mjx-c><mjx-c class=mjx-c6C noic=true style=padding-top:.705em>l</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.705em>e</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.705em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.705em>t</mjx-c><mjx-c class=mjx-c68 noic=true style=padding-top:.705em>h</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.705em>e</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.705em>o</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.705em>r</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.705em>e</mjx-c><mjx-c class=mjx-c6D style=padding-top:.705em>m</mjx-c></mjx-mtext></mjx-texatom><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\left(a^{(p+1)/4}\right)^2&\equiv a^{(p+1)/2}&\pmod p\\&\equiv x^{p+1}&\pmod p\\&\equiv \left(x^2\right)\left(x^{p-1}\right)&\pmod p\\&\equiv x^2&\pmod p&\quad (\because{\text{Fermat's little theorem}})\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left right left" columnspacing="0em 2em 0em" data-break-align="bottom top bottom top" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)&\quad (\because{\text{Fermat's little theorem}})\end{aligned}" displaystyle=true rowspacing=3pt><mtr data-latex><mtd><msup data-latex=\left(a^{(p+1)/4}\right)^2><mrow data-latex=\left(a^{(p+1)/4}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=a^{(p+1)/4}><mi data-latex=a>a</mi><mrow data-latex={(p+1)/4} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=4>4</mn></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=a^{(p+1)/2}><mi data-latex=a>a</mi><mrow data-latex={(p+1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=x^{p+1}><mi data-latex=x>x</mi><mrow data-latex={p+1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mrow data-latex="\left(x^2 \right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex=\left(x^{p-1}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=x^{p-1}><mi data-latex=x>x</mi><mrow data-latex={p-1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\quad width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mo data-latex=\because>∵</mo><mrow data-latex="{\text{Fermat's little theorem}}" data-mjx-texclass=ORD><mtext data-latex="\text{Fermat's little theorem}">Fermat's little theorem</mtext></mrow><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\left(a^{(p+1)/4}\right)^2&\equiv a^{(p+1)/2}&\pmod p\\
&\equiv x^{p+1}&\pmod p\\
&\equiv \left(x^2\right)\left(x^{p-1}\right)&\pmod p\\
&\equiv x^2&\pmod p&\quad (\because{\text{Fermat's little theorem}})
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p>那么 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^{(p+1)/4}\bmod p" aria-hidden=true class=NCM-N><mjx-msup data-latex=a^{(p+1)/4}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(p+1)/4} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^{(p+1)/4}\bmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^{(p+1)/4}><mi data-latex=a>a</mi><mrow data-latex={(p+1)/4} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=4>4</mn></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="a^{(p+1)/4}\bmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为一个解．</p><h4 id=atkin-算法>Atkin 算法<a title="Permanent link" class=headerlink href=#atkin-算法></a></h4><p>仍然考虑上述同余方程，此时 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p\bmod 8=5" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mn data-latex=8><mjx-c class=mjx-c38>8</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=5 space=4><mjx-c class=mjx-c35>5</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p\bmod 8=5" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mn data-latex=8>8</mn><mo data-latex="=">=</mo><mn data-latex=5>5</mn></math></mjx-assistive-mml><img title="p\bmod 8=5" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b\equiv (2a)^{(p-5)/8}\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=)^{(p-5)/8}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(p-5)/8} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=5><mjx-c class=mjx-c35>5</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=8><mjx-c class=mjx-c38>8</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b\equiv (2a)^{(p-5)/8}\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><msup data-latex=)^{(p-5)/8}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={(p-5)/8} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=5>5</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=8>8</mn></mrow></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="b\equiv (2a)^{(p-5)/8}\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathrm{i}\equiv 2ab^2\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathrm{i}\equiv 2ab^2\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mo data-latex=\equiv>≡</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\mathrm{i}\equiv 2ab^2\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 那么此时 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathrm{i}^2\equiv -1\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=\mathrm{i}^2><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathrm{i}^2\equiv -1\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\mathrm{i}^2><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\mathrm{i}^2\equiv -1\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="ab(\mathrm{i}-1)\bmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="ab(\mathrm{i}-1)\bmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mi data-latex=b>b</mi><mo data-latex=( stretchy=false>(</mo><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="ab(\mathrm{i}-1)\bmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为一个解．</p><details class=note open><summary>证明</summary> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\mathrm{i}^2&\equiv\left(2ab^2\right)^2&\pmod p\\
&\equiv \left(2a\cdot \left(2a\right)^{(p-5)/4}\right)^2&\pmod p\\
&\equiv \left(\left(2a\right)^{(p-1)/4}\right)^2&\pmod p\\
&\equiv \left(2a\right)^{\frac{p-1}{2}}&\pmod p\\
&\equiv -1&\pmod p
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)
\end{aligned}" style=min-width:16.358em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.429em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msup data-latex=\mathrm{i}^2><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex="\left(2ab^2 \right)^2" space=4><mjx-mrow data-latex="\left(2ab^2 \right)"><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.611em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.675em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex="\left(2a\cdot \left(2a\right)^{(p-5)/4}\right)^2" space=4><mjx-mrow data-latex="\left(2a\cdot \left(2a\right)^{(p-5)/4}\right)"><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S3">(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msup data-latex=\left(2a\right)^{(p-5)/4} space=3><mjx-mrow data-latex=\left(2a\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.475em><mjx-texatom data-latex={(p-5)/4} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=5><mjx-c class=mjx-c35>5</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S3">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.732em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.675em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=\left(\left(2a\right)^{(p-1)/4}\right)^2 space=4><mjx-mrow data-latex=\left(\left(2a\right)^{(p-1)/4}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S3">(</mjx-c></mjx-mo><mjx-msup data-latex=\left(2a\right)^{(p-1)/4}><mjx-mrow data-latex=\left(2a\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.475em><mjx-texatom data-latex={(p-1)/4} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S3">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.732em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.393em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=\left(2a\right)^{\frac{p-1}{2}} space=4><mjx-mrow data-latex=\left(2a\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.475em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\mathrm{i}^2&\equiv\left(2ab^2\right)^2&\pmod p\\&\equiv \left(2a\cdot \left(2a\right)^{(p-5)/4}\right)^2&\pmod p\\&\equiv \left(\left(2a\right)^{(p-1)/4}\right)^2&\pmod p\\&\equiv \left(2a\right)^{\frac{p-1}{2}}&\pmod p\\&\equiv -1&\pmod p\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left right" columnspacing="0em 2em" data-break-align="bottom top bottom" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)\end{aligned}" displaystyle=true rowspacing=3pt><mtr data-latex><mtd><msup data-latex=\mathrm{i}^2><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mn data-latex=2>2</mn></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex="\left(2ab^2 \right)^2"><mrow data-latex="\left(2ab^2 \right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex="\left(2a\cdot \left(2a\right)^{(p-5)/4}\right)^2"><mrow data-latex="\left(2a\cdot \left(2a\right)^{(p-5)/4}\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><mo data-latex=\cdot>⋅</mo><msup data-latex=\left(2a\right)^{(p-5)/4}><mrow data-latex=\left(2a\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={(p-5)/4} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=5>5</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=4>4</mn></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=\left(\left(2a\right)^{(p-1)/4}\right)^2><mrow data-latex=\left(\left(2a\right)^{(p-1)/4}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=\left(2a\right)^{(p-1)/4}><mrow data-latex=\left(2a\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={(p-1)/4} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=4>4</mn></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=\left(2a\right)^{\frac{p-1}{2}}><mrow data-latex=\left(2a\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\mathrm{i}^2&\equiv\left(2ab^2\right)^2&\pmod p\\
&\equiv \left(2a\cdot \left(2a\right)^{(p-5)/4}\right)^2&\pmod p\\
&\equiv \left(\left(2a\right)^{(p-1)/4}\right)^2&\pmod p\\
&\equiv \left(2a\right)^{\frac{p-1}{2}}&\pmod p\\
&\equiv -1&\pmod p
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>那么</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\left(ab(\mathrm{i}-1)\right)^2&\equiv a^2\cdot \left(2a\right)^{(p-5)/4}\cdot (-2\mathrm{i})&\pmod p\\
&\equiv a\cdot (-\mathrm{i})\cdot \left(2a\right)^{(p-1)/4}&\pmod p\\
&\equiv a&\pmod p
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)
\end{aligned}" style=min-width:22.105em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.253em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msup data-latex=\left(ab(\mathrm{i}-1)\right)^2><mjx-mrow data-latex=\left(ab(\mathrm{i}-1)\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.475em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^2 space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msup data-latex=\left(2a\right)^{(p-5)/4} space=3><mjx-mrow data-latex=\left(2a\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.475em><mjx-texatom data-latex={(p-5)/4} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=5><mjx-c class=mjx-c35>5</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.253em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-texatom data-latex=\mathrm{i} texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c69>i</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msup data-latex=\left(2a\right)^{(p-1)/4} space=3><mjx-mrow data-latex=\left(2a\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.475em><mjx-texatom data-latex={(p-1)/4} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=4><mjx-c class=mjx-c34>4</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\left(ab(\mathrm{i}-1)\right)^2&\equiv a^2\cdot \left(2a\right)^{(p-5)/4}\cdot (-2\mathrm{i})&\pmod p\\&\equiv a\cdot (-\mathrm{i})\cdot \left(2a\right)^{(p-1)/4}&\pmod p\\&\equiv a&\pmod p\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left right" columnspacing="0em 2em" data-break-align="bottom top bottom" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)\end{aligned}" displaystyle=true rowspacing=3pt><mtr data-latex><mtd><msup data-latex=\left(ab(\mathrm{i}-1)\right)^2><mrow data-latex=\left(ab(\mathrm{i}-1)\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=a>a</mi><mi data-latex=b>b</mi><mo data-latex=( stretchy=false>(</mo><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=a^2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msup><mo data-latex=\cdot>⋅</mo><msup data-latex=\left(2a\right)^{(p-5)/4}><mrow data-latex=\left(2a\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={(p-5)/4} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=5>5</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=4>4</mn></mrow></msup><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mn data-latex=2>2</mn><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mo data-latex=) stretchy=false>)</mo></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mrow data-latex=\mathrm{i} data-mjx-texclass=ORD><mi data-latex=i mathvariant=normal>i</mi></mrow><mo data-latex=) stretchy=false>)</mo><mo data-latex=\cdot>⋅</mo><msup data-latex=\left(2a\right)^{(p-1)/4}><mrow data-latex=\left(2a\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mn data-latex=2>2</mn><mi data-latex=a>a</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={(p-1)/4} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=4>4</mn></mrow></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\left(ab(\mathrm{i}-1)\right)^2&\equiv a^2\cdot \left(2a\right)^{(p-5)/4}\cdot (-2\mathrm{i})&\pmod p\\
&\equiv a\cdot (-\mathrm{i})\cdot \left(2a\right)^{(p-1)/4}&\pmod p\\
&\equiv a&\pmod p
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><h3 id=cipolla-算法>Cipolla 算法<a title="Permanent link" class=headerlink href=#cipolla-算法></a></h3><p>Cipolla 算法用于求解同余方程 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y^2\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=y^2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y^2\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=y^2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="y^2\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 为奇素数且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为二次剩余．</p><p>本节考虑 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathbf{F}_p\lbrack x\rbrack /(x^2-g)" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=\mathbf{F}_p><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\lbrack><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\rbrack><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathbf{F}_p\lbrack x\rbrack /(x^2-g)" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub><mo data-latex=\lbrack fence=false stretchy=false>[</mo><mi data-latex=x>x</mi><mo data-latex=\rbrack fence=false stretchy=false>]</mo><mo data-latex=/>/</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=g>g</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\mathbf{F}_p\lbrack x\rbrack /(x^2-g)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 中的运算，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g \in \mathbf{F}_p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=4><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g \in \mathbf{F}_p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=\in>∈</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub></math></mjx-assistive-mml><img title="g \in \mathbf{F}_p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p><details class=note><summary>计算方法</summary> <p>不熟悉 <a href=../../algebra/ring-theory/#多项式环>多项式环</a> 的读者，可以简单理解为该集合的元素都具有形式 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=a_0+a_1x><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a_0+a_1x xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a_0+a_1x></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_0,a_1\in\mathbf F_p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex="\mathbf F_p" space=4><mjx-texatom data-latex="\mathbf F" texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_0,a_1\in\mathbf F_p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=,>,</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\in>∈</mo><msub data-latex="\mathbf F_p"><mrow data-latex="\mathbf F" data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub></math></mjx-assistive-mml><img title="a_0,a_1\in\mathbf F_p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，且遵循如下运算法则：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
(a_0+a_1x)+(b_0+b_1x) &\equiv (a_0+b_0)+(a_1+b_1)x &\pmod{(x^2-g)}\\
(a_0+a_1x)(b_0+b_1x) &\equiv (a_0b_0+a_1b_1g)+(a_1b_0+a_0b_1)x &\pmod{(x^2-g)}
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu (x^2 -g))
\end{aligned}" style=min-width:34.446em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=b_0><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=b_0 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=b_0><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=b_1 space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=b_0><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=b_1><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=b_0><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_0 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=b_1><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}(a_0+a_1x)+(b_0+b_1x) &\equiv (a_0+b_0)+(a_1+b_1)x &\pmod{(x^2-g)}\\(a_0+a_1x)(b_0+b_1x) &\equiv (a_0b_0+a_1b_1g)+(a_1b_0+a_0b_1)x &\pmod{(x^2-g)}\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left right" columnspacing="0em 2em" data-break-align="bottom top bottom" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu (x^2 -g))\end{aligned}" displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=b_0><mi data-latex=b>b</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=b_0><mi data-latex=b>b</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mi data-latex=x>x</mi></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=g>g</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=b_0><mi data-latex=b>b</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><msub data-latex=b_0><mi data-latex=b>b</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mi data-latex=g>g</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><msub data-latex=b_0><mi data-latex=b>b</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><msub data-latex=b_1><mi data-latex=b>b</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mi data-latex=x>x</mi></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=g>g</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
(a_0+a_1x)+(b_0+b_1x) &\equiv (a_0+b_0)+(a_1+b_1)x &\pmod{(x^2-g)}\\
(a_0+a_1x)(b_0+b_1x) &\equiv (a_0b_0+a_1b_1g)+(a_1b_0+a_0b_1)x &\pmod{(x^2-g)}
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>需要注意的是，此处的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 并不是一个具体的数，而是表示多项式中的形式记号．运算中一个关键的点在于利用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^2 \equiv g \pmod{(x^2-g)}" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=g space=4><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^2 \equiv g \pmod{(x^2-g)}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=g>g</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=g>g</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^2 \equiv g \pmod{(x^2-g)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 将二次项转化为一次项和常数项．另外，所有整数运算都需要对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 取模．</p> <p>关于该结构的更多内容，请参见 <a href=../../poly/intro/>多项式</a> 和 <a href=../../algebra/field-theory/>域论</a> 等页面．</p></details><p>该算法的第一步为找到一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=r^2-a><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r^2-a xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r^2-a></mjx-container> 为二次非剩余．当然对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a \equiv 0 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a \equiv 0 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a \equiv 0 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 不可能找到这样的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container>，需要进行特判．下文只讨论 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a \not\equiv 0 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2262>≢</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a \not\equiv 0 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex=\equiv>≢</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a \not\equiv 0 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情况．此时可随机一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 然后判断，期望可以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=2><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=2 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=2></mjx-container> 步找到．于是，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(r-x)^{\frac{p+1}{2}}\bmod (x^2-(r^2-a))" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p+1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p+1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p+1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p+1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(r-x)^{\frac{p+1}{2}}\bmod (x^2-(r^2-a))" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^{\frac{p+1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p+1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p+1}{2}><mrow data-latex=p+1><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(r-x)^{\frac{p+1}{2}}\bmod (x^2-(r^2-a))" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为一个解，可以通过快速幂求值．</p><details class=note><summary>为什么期望只需要两步</summary> <p>考虑 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=r^2-a><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r^2-a xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r^2-a></mjx-container> 为二次剩余的情况，则存在一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="r^2-a \equiv x^2 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=x^2 space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="r^2-a \equiv x^2 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=\equiv>≡</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="r^2-a \equiv x^2 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，移项可得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(r+x)(r-x) \equiv a \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(r+x)(r-x) \equiv a \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(r+x)(r-x) \equiv a \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，不难发现每一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(r+x) \in [1, p-1]" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=[ space=4><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(r+x) \in [1, p-1]" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mo data-latex=[ stretchy=false>[</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img title="(r+x) \in [1, p-1]" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都一一对应于一组 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(r,x)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(r,x) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=,>,</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(r,x)></mjx-container> 的解，所以使原方程成立的解一共有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p-1></mjx-container> 组．我们分类讨论 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x \equiv 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x \equiv 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="x \equiv 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x \not\equiv 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2262>≢</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x \not\equiv 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\equiv>≢</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="x \not\equiv 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 两种情况．对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x \equiv 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x \equiv 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="x \equiv 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，由于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是二次剩余，对应了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=2><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=2 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=2></mjx-container> 种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 的取值；对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x \not\equiv 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2262>≢</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x \not\equiv 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\equiv>≢</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="x \not\equiv 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=p-1-2><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p-1-2 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p-1-2></mjx-container> 种情况，每一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 对应其中两种，一共有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\dfrac{p-3}{2}><mjx-mstyle data-latex=\dfrac{p-3}{2}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-3><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=3 space=3><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\dfrac{p-3}{2} xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p-3}{2} displaystyle=true><mfrac><mrow data-latex=p-3><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=3>3</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\dfrac{p-3}{2}></mjx-container> 种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 的取值．综上，一共有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="2+\dfrac{p-3}{2}=\dfrac{p+1}{2}" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p-3}{2} space=3><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-3><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=3 space=3><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mstyle data-latex=\dfrac{p+1}{2} space=4><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p+1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="2+\dfrac{p-3}{2}=\dfrac{p+1}{2}" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn><mo data-latex=+>+</mo><mstyle data-latex=\dfrac{p-3}{2} displaystyle=true><mfrac><mrow data-latex=p-3><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=3>3</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle><mo data-latex="=">=</mo><mstyle data-latex=\dfrac{p+1}{2} displaystyle=true><mfrac><mrow data-latex=p+1><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mstyle></math></mjx-assistive-mml><img title="2+\dfrac{p-3}{2}=\dfrac{p+1}{2}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 种情况使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=r^2-a><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r^2-a xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r^2-a></mjx-container> 为二次剩余，所以每随机一次得到二次非剩余的概率就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\dfrac{p-1}{2p}><mjx-mstyle data-latex=\dfrac{p-1}{2p}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=2p><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\dfrac{p-1}{2p} xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{p-1}{2p} displaystyle=true><mfrac><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mrow data-latex=2p><mn data-latex=2>2</mn><mi data-latex=p>p</mi></mrow></mfrac></mstyle></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\dfrac{p-1}{2p}></mjx-container>，期望步数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\dfrac{2p}{p-1} \approx 2" aria-hidden=true breakable=true class=NCM-N><mjx-mstyle data-latex=\dfrac{2p}{p-1}><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=2p><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=p-1><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex=\approx><mjx-c class=mjx-c2248>≈</mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\dfrac{2p}{p-1} \approx 2" xmlns=http://www.w3.org/1998/Math/MathML><mstyle data-latex=\dfrac{2p}{p-1} displaystyle=true><mfrac><mrow data-latex=2p><mn data-latex=2>2</mn><mi data-latex=p>p</mi></mrow><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></mfrac></mstyle><mo data-latex=\approx>≈</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="\dfrac{2p}{p-1} \approx 2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p></details><details class=note open><summary>证明</summary> <p>为了方便，首先令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)=x^2-(r^2-a)\in\mathbf{F}_p\lbrack x\rbrack" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=x^2 space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=4><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\lbrack><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\rbrack><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)=x^2-(r^2-a)\in\mathbf{F}_p\lbrack x\rbrack" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub><mo data-latex=\lbrack fence=false stretchy=false>[</mo><mi data-latex=x>x</mi><mo data-latex=\rbrack fence=false stretchy=false>]</mo></math></mjx-assistive-mml><img title="f(x)=x^2-(r^2-a)\in\mathbf{F}_p\lbrack x\rbrack" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p> <p>需要证明的是，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(r-x)^{\frac{p+1}{2}} \bmod f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p+1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p+1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p+1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p+1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(r-x)^{\frac{p+1}{2}} \bmod f(x)" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^{\frac{p+1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p+1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p+1}{2}><mrow data-latex=p+1><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(r-x)^{\frac{p+1}{2}} \bmod f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是原式的解，并且它属于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\mathbf{F}_p><mjx-msub data-latex=\mathbf{F}_p><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\mathbf{F}_p xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\mathbf{F}_p></mjx-container>．首先考虑证明前者，即证明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(r-x)^{p+1}\equiv a\pmod {f(x)}" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^{p+1}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={p+1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(r-x)^{p+1}\equiv a\pmod {f(x)}" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^{p+1}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={p+1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(r-x)^{p+1}\equiv a\pmod {f(x)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．为此，我们需要先证明两个引理：</p> <p><strong>引理 1：</strong> <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^p \equiv -x \pmod {f(x)}" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^p><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^p \equiv -x \pmod {f(x)}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^p><mi data-latex=x>x</mi><mi data-latex=p>p</mi></msup><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mi data-latex=x>x</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^p \equiv -x \pmod {f(x)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></p> <p>证明：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
x^p&= x(x^2)^{\frac{p-1}{2}}\\
&\equiv x(r^2-a)^{\frac{p-1}{2}}&\pmod{f(x)}&\quad (\because{x^2\equiv r^2-a\pmod{f(x)}})\\
&\equiv -x&\pmod{f(x)}&\quad (\because{r^2-a}\text{ is quadratic non-residue})
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu f(x))&\quad (\because{r^2 -a}\text{ is quadratic non-residue})
\end{aligned}" style=min-width:31.717em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.331em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msup data-latex=x^p><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.331em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:right;padding:.15em 0 .15em 1em"><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\quad style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\because><mjx-c class=mjx-c2235>∵</mjx-c></mjx-mo><mjx-texatom data-latex="{x^2\equiv r^2-a\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu f(x))}" space=4 texclass=ORD><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=r^2 space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-left:1em;padding-right:0><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mspace data-latex=\quad style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\because><mjx-c class=mjx-c2235>∵</mjx-c></mjx-mo><mjx-texatom data-latex={r^2-a} space=4 texclass=ORD><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-texatom><mjx-mtext data-latex="\text{ is quadratic non-residue}"><mjx-c class=mjx-cA0 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c71 noic=true style=padding-top:.694em>q</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.694em>a</mjx-c><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.694em>r</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.694em>a</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c6E noic=true style=padding-top:.694em>n</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c6E noic=true style=padding-top:.694em>n</mjx-c><mjx-c class=mjx-c2D noic=true style=padding-top:.694em>-</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.694em>r</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c65 style=padding-top:.694em>e</mjx-c></mjx-mtext><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}x^p&= x(x^2)^{\frac{p-1}{2}}\\&\equiv x(r^2-a)^{\frac{p-1}{2}}&\pmod{f(x)}&\quad (\because{x^2\equiv r^2-a\pmod{f(x)}})\\&\equiv -x&\pmod{f(x)}&\quad (\because{r^2-a}\text{ is quadratic non-residue})\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left right left" columnspacing="0em 2em 0em" data-break-align="bottom top bottom top" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu f(x))&\quad (\because{r^2 -a}\text{ is quadratic non-residue})\end{aligned}" displaystyle=true rowspacing=3pt><mtr data-latex><mtd><msup data-latex=x^p><mi data-latex=x>x</mi><mi data-latex=p>p</mi></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=x>x</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mi data-latex=x>x</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\quad width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mo data-latex=\because>∵</mo><mrow data-latex="{x^2\equiv r^2-a\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu f(x))}" data-mjx-texclass=ORD><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mrow><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mi data-latex=x>x</mi></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mspace data-latex=\quad width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mo data-latex=\because>∵</mo><mrow data-latex={r^2-a} data-mjx-texclass=ORD><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></mrow><mtext data-latex="\text{ is quadratic non-residue}"> is quadratic non-residue</mtext><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
x^p&= x(x^2)^{\frac{p-1}{2}}\\
&\equiv x(r^2-a)^{\frac{p-1}{2}}&\pmod{f(x)}&\quad (\because{x^2\equiv r^2-a\pmod{f(x)}})\\
&\equiv -x&\pmod{f(x)}&\quad (\because{r^2-a}\text{ is quadratic non-residue})
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p><strong>引理 2：</strong><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a+b)^p \equiv a^p+b^p \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=)^p><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^p space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=b^p space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a+b)^p \equiv a^p+b^p \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><msup data-latex=)^p><mo data-latex=) stretchy=false>)</mo><mi data-latex=p>p</mi></msup><mo data-latex=\equiv>≡</mo><msup data-latex=a^p><mi data-latex=a>a</mi><mi data-latex=p>p</mi></msup><mo data-latex=+>+</mo><msup data-latex=b^p><mi data-latex=b>b</mi><mi data-latex=p>p</mi></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a+b)^p \equiv a^p+b^p \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></p> <p>使用二项式定理容易发现，除了第一项和最后一项，分子上的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 无法消掉，于是只剩下 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=a^p+b^p><mjx-msup data-latex=a^p><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=b^p space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a^p+b^p xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^p><mi data-latex=a>a</mi><mi data-latex=p>p</mi></msup><mo data-latex=+>+</mo><msup data-latex=b^p><mi data-latex=b>b</mi><mi data-latex=p>p</mi></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a^p+b^p></mjx-container>．</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
(a+b)^p&=\sum_{i=0}^p\binom{p}{i}a^ib^{p-i}\\
&=\sum_{i=0}^p\frac{p!}{i!(p-i)!}a^ib^{p-i}\\
&\equiv a^p+b^p\pmod p
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)
\end{aligned}" style=min-width:13.048em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:2.814em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=)^p><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^p" space=4><mjx-over style=padding-bottom:.111em;padding-left:.544em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow data-latex=\binom{p}{i} space=2><mjx-texatom data-latex="\biggl (" texclass=OPEN><mjx-mo><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo></mjx-texatom><mjx-mfrac><mjx-frac atop=true delims=true style=vertical-align:-.686em type=d><mjx-num style=padding-bottom:.507em><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-num><mjx-den><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-den></mjx-frac></mjx-mfrac><mjx-texatom data-latex="\biggr )" texclass=CLOSE><mjx-mo><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-texatom></mjx-mrow><mjx-msup data-latex=a^i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex=b^{p-i}><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p-i} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:2.814em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=0}^p" space=4><mjx-over style=padding-bottom:.111em;padding-left:.544em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=0}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mfrac data-latex=\frac{p!}{i!(p-i)!} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex=p!><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=!><mjx-c class=mjx-c21>!</mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=i!(p-i)!><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=!><mjx-c class=mjx-c21>!</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=i space=3><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=!><mjx-c class=mjx-c21>!</mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msup data-latex=a^i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex=b^{p-i}><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p-i} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^p space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=b^p space=3><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}(a+b)^p&=\sum_{i=0}^p\binom{p}{i}a^ib^{p-i}\\&=\sum_{i=0}^p\frac{p!}{i!(p-i)!}a^ib^{p-i}\\&\equiv a^p+b^p\pmod p\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu p)\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><msup data-latex=)^p><mo data-latex=) stretchy=false>)</mo><mi data-latex=p>p</mi></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^p"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=p>p</mi></munderover><mrow data-latex=\binom{p}{i} data-mjx-texclass=ORD><mrow data-latex="\biggl (" data-mjx-texclass=OPEN><mo maxsize=2.047em minsize=2.047em>(</mo></mrow><mfrac linethickness=0><mi data-latex=p>p</mi><mi data-latex=i>i</mi></mfrac><mrow data-latex="\biggr )" data-mjx-texclass=CLOSE><mo maxsize=2.047em minsize=2.047em>)</mo></mrow></mrow><msup data-latex=a^i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msup><msup data-latex=b^{p-i}><mi data-latex=b>b</mi><mrow data-latex={p-i} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=i>i</mi></mrow></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=0}^p"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=0}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mrow><mi data-latex=p>p</mi></munderover><mfrac data-latex=\frac{p!}{i!(p-i)!}><mrow data-latex=p!><mi data-latex=p>p</mi><mo data-latex=!>!</mo></mrow><mrow data-latex=i!(p-i)!><mi data-latex=i>i</mi><mo data-latex=!>!</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=i>i</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=!>!</mo></mrow></mfrac><msup data-latex=a^i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msup><msup data-latex=b^{p-i}><mi data-latex=b>b</mi><mrow data-latex={p-i} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mi data-latex=i>i</mi></mrow></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=a^p><mi data-latex=a>a</mi><mi data-latex=p>p</mi></msup><mo data-latex=+>+</mo><msup data-latex=b^p><mi data-latex=b>b</mi><mi data-latex=p>p</mi></msup><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
(a+b)^p&=\sum_{i=0}^p\binom{p}{i}a^ib^{p-i}\\
&=\sum_{i=0}^p\frac{p!}{i!(p-i)!}a^ib^{p-i}\\
&\equiv a^p+b^p\pmod p
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>有了这两个引理，我们再来考虑证明原式：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
(r-x)^{p+1}
&= (r-x)^p(r-x)\\
&\equiv (r^p-x^p)(r-x)&\pmod{f(x)}\\
&\equiv (r+x)(r-x)&\pmod{f(x)}\\
&= r^2-x^2\\
&\equiv r^2-(r^2-a)&\pmod{f(x)}\\
&= a\\
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu f(x))\\
&= a\\
\end{aligned}" style=min-width:20.692em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^{p+1}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p+1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^p><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=r^p><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=x^p space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.967em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=r^2 space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=x^2 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.132em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align:left;padding:.15em 1em .15em 0"><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=r^2 space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-left:1em><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.453em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0;padding-right:1em><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd extra=true></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}(r-x)^{p+1}&= (r-x)^p(r-x)\\&\equiv (r^p-x^p)(r-x)&\pmod{f(x)}\\&\equiv (r+x)(r-x)&\pmod{f(x)}\\&= r^2-x^2\\&\equiv r^2-(r^2-a)&\pmod{f(x)}\\&= a\\\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left right" columnspacing="0em 2em" data-break-align="bottom top bottom" data-latex="\mathchoice{\kern18mu}{\kern8mu}{\kern8mu}{\kern8mu}(\mmlToken{mi}{mod}\kern 6mu f(x))\\&= a\\\end{aligned}" displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^{p+1}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={p+1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msup></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^p><mo data-latex=) stretchy=false>)</mo><mi data-latex=p>p</mi></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=r^p><mi data-latex=r>r</mi><mi data-latex=p>p</mi></msup><mo data-latex=->−</mo><msup data-latex=x^p><mi data-latex=x>x</mi><mi data-latex=p>p</mi></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\equiv>≡</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd><mtd><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=a>a</mi></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
(r-x)^{p+1}
&= (r-x)^p(r-x)\\
&\equiv (r^p-x^p)(r-x)&\pmod{f(x)}\\
&\equiv (r+x)(r-x)&\pmod{f(x)}\\
&= r^2-x^2\\
&\equiv r^2-(r^2-a)&\pmod{f(x)}\\
&= a\\
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>下面通过反证法证明我们求出的解属于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\mathbf{F}_p><mjx-msub data-latex=\mathbf{F}_p><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\mathbf{F}_p xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\mathbf{F}_p></mjx-container>，即其 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 的系数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>．</p> <p>假设存在一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a_0+a_1x)^2 \equiv a \pmod {f(x)}" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^2><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a_0+a_1x)^2 \equiv a \pmod {f(x)}" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><msup data-latex=)^2><mo data-latex=) stretchy=false>)</mo><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a_0+a_1x)^2 \equiv a \pmod {f(x)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_1 \not\equiv 0 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2262>≢</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_1 \not\equiv 0 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\equiv>≢</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_1 \not\equiv 0 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，即 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_0^2+2a_0a_1x+a_1^2x^2 \equiv a \pmod {f(x)}" aria-hidden=true breakable=true class=NCM-N><mjx-msubsup data-latex=a_0^2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.288em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msubsup data-latex=a_1^2 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.288em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_0^2+2a_0a_1x+a_1^2x^2 \equiv a \pmod {f(x)}" xmlns=http://www.w3.org/1998/Math/MathML><msubsup data-latex=a_0^2><mi data-latex=a>a</mi><mn data-latex=0>0</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=+>+</mo><mn data-latex=2>2</mn><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msubsup data-latex=a_1^2><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mn data-latex=2>2</mn></msubsup><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_0^2+2a_0a_1x+a_1^2x^2 \equiv a \pmod {f(x)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，移项并化简可得：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
a_0^2+a_1^2(r^2-a)-a \equiv -2a_0a_1x \pmod {f(x)}
" aria-hidden=true class=NCM-N display=true><mjx-msubsup data-latex=a_0^2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.189em></mjx-spacer><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msubsup data-latex=a_1^2 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.247em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.189em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="a_0^2+a_1^2(r^2-a)-a \equiv -2a_0a_1x \pmod {f(x)}" display=block xmlns=http://www.w3.org/1998/Math/MathML><msubsup data-latex=a_0^2><mi data-latex=a>a</mi><mn data-latex=0>0</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=+>+</mo><msubsup data-latex=a_1^2><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=( stretchy=false>(</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=2>2</mn><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
a_0^2+a_1^2(r^2-a)-a \equiv -2a_0a_1x \pmod {f(x)}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>式子左边的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 的系数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>，所以右边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 的系数也为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>，即 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_0a_1 \equiv 0 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_0a_1 \equiv 0 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_0a_1 \equiv 0 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，由于我们令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_1 \not\equiv 0 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2262>≢</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_1 \not\equiv 0 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=\equiv>≢</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_1 \not\equiv 0 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以一定有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_0 \equiv 0 \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_0 \equiv 0 \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_0 \equiv 0 \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，于是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(a_1x)^2 \equiv a \pmod {f(x)}" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^2><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(a_1x)^2 \equiv a \pmod {f(x)}" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><msup data-latex=)^2><mo data-latex=) stretchy=false>)</mo><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="(a_1x)^2 \equiv a \pmod {f(x)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 即 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="r^2-a \equiv aa_1^{-2} \pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msubsup data-latex=a_1^{-2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={-2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="r^2-a \equiv aa_1^{-2} \pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><msubsup data-latex=a_1^{-2}><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mrow data-latex={-2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=2>2</mn></mrow></msubsup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="r^2-a \equiv aa_1^{-2} \pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p> <p>由于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a_1^{-2}><mjx-msubsup data-latex="a_1 ^{-2}"><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={-2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a_1^{-2} xmlns=http://www.w3.org/1998/Math/MathML><msubsup data-latex="a_1 ^{-2}"><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mrow data-latex={-2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=2>2</mn></mrow></msubsup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a_1^{-2}></mjx-container> 都是二次剩余，由 Legendre 符号的积性可知 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=aa_1^{-2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msubsup data-latex=a_1^{-2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={-2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=aa_1^{-2} xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><msubsup data-latex=a_1^{-2}><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mrow data-latex={-2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=2>2</mn></mrow></msubsup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=aa_1^{-2}></mjx-container> 也是二次剩余，这与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=r^2-a><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r^2-a xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r^2-a></mjx-container> 是二次非剩余矛盾．于是原式不存在一个解使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 的系数非 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>，我们求出的解的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 的系数也必定为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>．</p></details><details class=example><summary>模板题 <a href=https://www.luogu.com.cn/problem/P5491 target=_blank>洛谷 P5491【模板】二次剩余</a></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;random></span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>;</span><span class=w>  </span><span class=c1>// 分别是模数和 r^2 - a 的值</span>

<span class=k>struct</span><span class=w> </span><span class=nc>Poly</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>;</span>

<span class=w>  </span><span class=n>Poly</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>_a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>_b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>_a</span><span class=p>),</span><span class=w> </span><span class=n>b</span><span class=p>(</span><span class=n>_b</span><span class=p>)</span><span class=w> </span><span class=p>{}</span>
<span class=p>};</span>

<span class=n>Poly</span><span class=w> </span><span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Poly</span><span class=o>&</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>Poly</span><span class=o>&</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// 重载乘法，可以参考上面有关运算性质的说明</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>Poly</span><span class=p>((</span><span class=n>x</span><span class=p>.</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>.</span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=n>b</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>.</span><span class=n>b</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>))</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>,</span>
<span class=w>              </span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>.</span><span class=n>b</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=p>.</span><span class=n>b</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>y</span><span class=p>.</span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>);</span>
<span class=p>}</span>

<span class=c1>// 多项式的快速幂，用于计算答案</span>
<span class=n>Poly</span><span class=w> </span><span class=n>modpow</span><span class=p>(</span><span class=n>Poly</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>Poly</span><span class=w> </span><span class=nf>res</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>&</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
<span class=w>    </span><span class=n>b</span><span class=w> </span><span class=o>>>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=c1>// 普通的快速幂，用于判断二次非剩余</span>
<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>modpow</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=w> </span><span class=o>&</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>;</span>
<span class=w>    </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>;</span>
<span class=w>    </span><span class=n>b</span><span class=w> </span><span class=o>>>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=p>}</span>

<span class=c1>// 用于生成随机数</span>
<span class=n>std</span><span class=o>::</span><span class=n>mt19937</span><span class=w> </span><span class=n>rng</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>random_device</span><span class=p>{}());</span>

<span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=nf>cipolla</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>_p</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_p</span><span class=p>;</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>  </span><span class=c1>// 特判一下 0 的情况</span>
<span class=w>  </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>modpow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span><span class=w>  </span><span class=c1>// 判断二次非剩余，此时无解</span>
<span class=w>  </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// 随机 r，使得 r^2 - a 是一个二次非剩余</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>r</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rng</span><span class=p>()</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>;;</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rng</span><span class=p>()</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>modpow</span><span class=p>((</span><span class=n>r</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>break</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>modpow</span><span class=p>(</span><span class=n>Poly</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>).</span><span class=n>a</span><span class=p>;</span><span class=w>  </span><span class=c1>// 根据结论式计算结果</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>t</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>t</span><span class=o>--</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>p</span><span class=p>;</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>ans</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cipolla</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>ans</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>"Hola!"</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>    </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>ans</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>    </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=c1>// 相反数是另一个解</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>ans2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ans</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>p</span><span class=p>;</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>ans2</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>ans</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>ans</span><span class=p>,</span><span class=w> </span><span class=n>ans2</span><span class=p>);</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>ans</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>" "</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>ans2</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><h3 id=bostanmori-算法>Bostan–Mori 算法<a title="Permanent link" class=headerlink href=#bostanmori-算法></a></h3><p>该算法基于 Cipolla 算法，我们将问题转换为 <a href=../../poly/linear-recurrence/>常系数齐次线性递推</a> 再应用 Bostan–Mori 算法．考虑另一种常见的 Cipolla 算法的描述：<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b=x^{\left(p+1\right)/2}\bmod{\left(x^2-tx+a\right)}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=x^{\left(p+1\right)/2} space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\left(p+1\right)/2} size=s texclass=ORD><mjx-mrow data-latex=\left(p+1\right)><mjx-mo data-latex=\left(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-texatom data-latex="{\left(x^2 -tx+a\right)}" texclass=ORD><mjx-mrow data-latex="\left(x^2 -tx+a\right)"><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-SO">(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=t space=3><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-SO">)</mjx-c></mjx-mo></mjx-mrow></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b=x^{\left(p+1\right)/2}\bmod{\left(x^2-tx+a\right)}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex="=">=</mo><msup data-latex=x^{\left(p+1\right)/2}><mi data-latex=x>x</mi><mrow data-latex={\left(p+1\right)/2} data-mjx-texclass=ORD><mrow data-latex=\left(p+1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mrow data-latex="{\left(x^2 -tx+a\right)}" data-mjx-texclass=ORD><mrow data-latex="\left(x^2 -tx+a\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=t>t</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=a>a</mi><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mrow></math></mjx-assistive-mml><img title="b=x^{\left(p+1\right)/2}\bmod{\left(x^2-tx+a\right)}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b^2\equiv a\pmod{p}" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b^2\equiv a\pmod{p}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="b^2\equiv a\pmod{p}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的一个解<sup id=fnref:ref3><a class=footnote-ref href=#fn:ref3>3</a></sup>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^2-tx+a\in \mathbf{F}_p\lbrack x\rbrack" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=t space=3><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=4><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\lbrack><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\rbrack><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^2-tx+a\in \mathbf{F}_p\lbrack x\rbrack" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=t>t</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=a>a</mi><mo data-latex=\in>∈</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub><mo data-latex=\lbrack fence=false stretchy=false>[</mo><mi data-latex=x>x</mi><mo data-latex=\rbrack fence=false stretchy=false>]</mo></math></mjx-assistive-mml><img title="x^2-tx+a\in \mathbf{F}_p\lbrack x\rbrack" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为不可约多项式．系数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=t><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=t xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=t></mjx-container> 的选取同样使用随机方法．证明过程略．参考 Bostan 和 Mori 论文<sup id=fnref:ref4><a class=footnote-ref href=#fn:ref4>4</a></sup>中的算法我们可以发现问题可转化为求解形式幂级数的乘法逆元的某一项系数：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
b=\left\lbrack x^{(p+1)/2}\right\rbrack\dfrac{1}{1-tx+ax^2}
" aria-hidden=true class=NCM-N display=true><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex="\left\lbrack x^{(p+1)/2}\right\rbrack" space=4><mjx-mo data-latex="\left\lbrack "><mjx-c class="mjx-c5B NCM-S3">[</mjx-c></mjx-mo><mjx-msup data-latex=x^{(p+1)/2}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={(p+1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right\rbrack><mjx-c class="mjx-c5D NCM-S3">]</mjx-c></mjx-mo></mjx-mrow><mjx-mfrac data-latex=\dfrac{1}{1-tx+ax^2} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=1-tx+ax^2><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=t space=3><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="b=\left\lbrack x^{(p+1)/2}\right\rbrack\dfrac{1}{1-tx+ax^2}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex="=">=</mo><mrow data-latex="\left\lbrack x^{(p+1)/2}\right\rbrack" data-mjx-texclass=INNER><mo data-latex="\left\lbrack " data-mjx-texclass=OPEN>[</mo><msup data-latex=x^{(p+1)/2}><mi data-latex=x>x</mi><mrow data-latex={(p+1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=p>p</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\right\rbrack data-mjx-texclass=CLOSE>]</mo></mrow><mfrac data-latex=\dfrac{1}{1-tx+ax^2}><mn data-latex=1>1</mn><mrow data-latex=1-tx+ax^2><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=t>t</mi><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=a>a</mi><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mrow></mfrac></math></mjx-assistive-mml><img title="
b=\left\lbrack x^{(p+1)/2}\right\rbrack\dfrac{1}{1-tx+ax^2}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p>且</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left\lbrack x^n\right\rbrack\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}=
\begin{cases}
\left\lbrack x^{(n-1)/2}\right\rbrack\dfrac{k_1-k_0k_2+k_1k_3x}{1+(2k_3-k_2^2)x+k_3^2x^2},&\text{if }n\bmod 2=1\\
\left\lbrack x^{n/2}\right\rbrack\dfrac{k_0+(k_0k_3-k_1k_2)x}{1+(2k_3-k_2^2)x+k_3^2x^2},&\text{else if }n\neq 0
\end{cases}
" aria-hidden=true class=NCM-N display=true><mjx-mrow data-latex="\left\lbrack x^n\right\rbrack"><mjx-mo data-latex="\left\lbrack "><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-msup data-latex=x^n><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=\right\rbrack><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-mrow><mjx-mfrac data-latex=\dfrac{k_0+k_1x}{1+k_2x+k_3x^2} space=2><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="k_0 +k_1 x"><mjx-msub data-latex=k_0><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="1+k_2 x+k_3 x^2"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_3 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-stretchy-v class=mjx-c7B style=vertical-align:-2.36em;height:5.221em><mjx-beg>⎧</mjx-beg><mjx-ext class=NCM-EM><mjx-spacer>{ { {</mjx-spacer></mjx-ext><mjx-mid>⎨</mjx-mid><mjx-ext class=NCM-EM><mjx-spacer>{ { {</mjx-spacer></mjx-ext><mjx-end>⎩</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=min-width:22.152em><mjx-table><mjx-itable><mjx-mtr style=height:2.467em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mrow data-latex="\left\lbrack x^{(n-1)/2}\right\rbrack"><mjx-mo data-latex="\left\lbrack "><mjx-c class="mjx-c5B NCM-LO">[</mjx-c></mjx-mo><mjx-msup data-latex=x^{(n-1)/2}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(n-1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right\rbrack><mjx-c class="mjx-c5D NCM-LO">]</mjx-c></mjx-mo></mjx-mrow><mjx-mstyle data-latex=\dfrac{k_1-k_0k_2+k_1k_3x}{1+(2k_3-k_2^2)x+k_3^2x^2} space=2><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="k_1 -k_0 k_2 +k_1 k_3 x"><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=k_0 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=k_2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=k_3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="1+(2k_3 -k_2 ^2 )x+k_3 ^2 x^2"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=k_3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msubsup data-latex=k_2^2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msubsup data-latex=k_3^2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mtext data-latex="\text{if }"><mjx-c class=mjx-c69 noic=true style=padding-top:.705em>i</mjx-c><mjx-c class=mjx-c66 noic=true style=padding-top:.705em>f</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.705em> </mjx-c></mjx-mtext><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:2.553em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mrow data-latex="\left\lbrack x^{n/2}\right\rbrack"><mjx-mo data-latex="\left\lbrack "><mjx-c class="mjx-c5B NCM-LO">[</mjx-c></mjx-mo><mjx-msup data-latex=x^{n/2}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n/2} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right\rbrack><mjx-c class="mjx-c5D NCM-LO">]</mjx-c></mjx-mo></mjx-mrow><mjx-mstyle data-latex=\dfrac{k_0+(k_0k_3-k_1k_2)x}{1+(2k_3-k_2^2)x+k_3^2x^2} space=2><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="k_0 +(k_0 k_3 -k_1 k_2 )x"><mjx-msub data-latex=k_0><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=k_0><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=k_3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=k_2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="1+(2k_3 -k_2 ^2 )x+k_3 ^2 x^2"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=k_3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msubsup data-latex=k_2^2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msubsup data-latex=k_3^2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mtext data-latex="\text{else if }"><mjx-c class=mjx-c65 noic=true style=padding-top:.705em>e</mjx-c><mjx-c class=mjx-c6C noic=true style=padding-top:.705em>l</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.705em>s</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.705em>e</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.705em> </mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.705em>i</mjx-c><mjx-c class=mjx-c66 noic=true style=padding-top:.705em>f</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.705em> </mjx-c></mjx-mtext><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=\neq space=4><mjx-c class=mjx-c2260>≠</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left\lbrack x^n\right\rbrack\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}=\begin{cases}\left\lbrack x^{(n-1)/2}\right\rbrack\dfrac{k_1-k_0k_2+k_1k_3x}{1+(2k_3-k_2^2)x+k_3^2x^2},&\text{if }n\bmod 2=1\\\left\lbrack x^{n/2}\right\rbrack\dfrac{k_0+(k_0k_3-k_1k_2)x}{1+(2k_3-k_2^2)x+k_3^2x^2},&\text{else if }n\neq 0\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\left\lbrack x^n\right\rbrack" data-mjx-texclass=INNER><mo data-latex="\left\lbrack " data-mjx-texclass=OPEN>[</mo><msup data-latex=x^n><mi data-latex=x>x</mi><mi data-latex=n>n</mi></msup><mo data-latex=\right\rbrack data-mjx-texclass=CLOSE>]</mo></mrow><mfrac data-latex=\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}><mrow data-latex="k_0 +k_1 x"><msub data-latex=k_0><mi data-latex=k>k</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi></mrow><mrow data-latex="1+k_2 x+k_3 x^2"><mn data-latex=1>1</mn><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msub data-latex=k_3><mi data-latex=k>k</mi><mn data-latex=3>3</mn></msub><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mrow></mfrac><mo data-latex="=">=</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mrow data-latex="\left\lbrack x^{(n-1)/2}\right\rbrack" data-mjx-texclass=INNER><mo data-latex="\left\lbrack " data-mjx-texclass=OPEN>[</mo><msup data-latex=x^{(n-1)/2}><mi data-latex=x>x</mi><mrow data-latex={(n-1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\right\rbrack data-mjx-texclass=CLOSE>]</mo></mrow><mstyle data-latex=\dfrac{k_1-k_0k_2+k_1k_3x}{1+(2k_3-k_2^2)x+k_3^2x^2} displaystyle=true><mfrac><mrow data-latex="k_1 -k_0 k_2 +k_1 k_3 x"><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><msub data-latex=k_0><mi data-latex=k>k</mi><mn data-latex=0>0</mn></msub><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><msub data-latex=k_3><mi data-latex=k>k</mi><mn data-latex=3>3</mn></msub><mi data-latex=x>x</mi></mrow><mrow data-latex="1+(2k_3 -k_2 ^2 )x+k_3 ^2 x^2"><mn data-latex=1>1</mn><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><msub data-latex=k_3><mi data-latex=k>k</mi><mn data-latex=3>3</mn></msub><mo data-latex=->−</mo><msubsup data-latex=k_2^2><mi data-latex=k>k</mi><mn data-latex=2>2</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=) stretchy=false>)</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msubsup data-latex=k_3^2><mi data-latex=k>k</mi><mn data-latex=3>3</mn><mn data-latex=2>2</mn></msubsup><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mrow></mfrac></mstyle><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex="\text{if }">if </mtext><mi data-latex=n>n</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mn data-latex=2>2</mn><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mtd></mtr><mtr><mtd><mrow data-latex="\left\lbrack x^{n/2}\right\rbrack" data-mjx-texclass=INNER><mo data-latex="\left\lbrack " data-mjx-texclass=OPEN>[</mo><msup data-latex=x^{n/2}><mi data-latex=x>x</mi><mrow data-latex={n/2} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\right\rbrack data-mjx-texclass=CLOSE>]</mo></mrow><mstyle data-latex=\dfrac{k_0+(k_0k_3-k_1k_2)x}{1+(2k_3-k_2^2)x+k_3^2x^2} displaystyle=true><mfrac><mrow data-latex="k_0 +(k_0 k_3 -k_1 k_2 )x"><msub data-latex=k_0><mi data-latex=k>k</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=k_0><mi data-latex=k>k</mi><mn data-latex=0>0</mn></msub><msub data-latex=k_3><mi data-latex=k>k</mi><mn data-latex=3>3</mn></msub><mo data-latex=->−</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mi data-latex=x>x</mi></mrow><mrow data-latex="1+(2k_3 -k_2 ^2 )x+k_3 ^2 x^2"><mn data-latex=1>1</mn><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><msub data-latex=k_3><mi data-latex=k>k</mi><mn data-latex=3>3</mn></msub><mo data-latex=->−</mo><msubsup data-latex=k_2^2><mi data-latex=k>k</mi><mn data-latex=2>2</mn><mn data-latex=2>2</mn></msubsup><mo data-latex=) stretchy=false>)</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msubsup data-latex=k_3^2><mi data-latex=k>k</mi><mn data-latex=3>3</mn><mn data-latex=2>2</mn></msubsup><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mrow></mfrac></mstyle><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex="\text{else if }">else if </mtext><mi data-latex=n>n</mi><mo data-latex=\neq>≠</mo><mn data-latex=0>0</mn></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
\left\lbrack x^n\right\rbrack\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}=
\begin{cases}
\left\lbrack x^{(n-1)/2}\right\rbrack\dfrac{k_1-k_0k_2+k_1k_3x}{1+(2k_3-k_2^2)x+k_3^2x^2},&\text{if }n\bmod 2=1\\
\left\lbrack x^{n/2}\right\rbrack\dfrac{k_0+(k_0k_3-k_1k_2)x}{1+(2k_3-k_2^2)x+k_3^2x^2},&\text{else if }n\neq 0
\end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14726 data-original-document-start=14588>而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="n=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="n=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="n=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时显然有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left\lbrack x^0\right\rbrack\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}=k_0" aria-hidden=true breakable=true class=NCM-N><mjx-mrow data-latex="\left\lbrack x^0 \right\rbrack"><mjx-mo data-latex="\left\lbrack "><mjx-c class="mjx-c5B NCM-SO">[</mjx-c></mjx-mo><mjx-msup data-latex=x^0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=\right\rbrack><mjx-c class="mjx-c5D NCM-SO">]</mjx-c></mjx-mo></mjx-mrow><mjx-mstyle data-latex=\dfrac{k_0+k_1x}{1+k_2x+k_3x^2} space=2><mjx-mfrac><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mrow data-latex="k_0 +k_1 x"><mjx-msub data-latex=k_0><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex="1+k_2 x+k_3 x^2"><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_3 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=k_0 space=4><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left\lbrack x^0\right\rbrack\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}=k_0" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\left\lbrack x^0 \right\rbrack" data-mjx-texclass=INNER><mo data-latex="\left\lbrack " data-mjx-texclass=OPEN>[</mo><msup data-latex=x^0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msup><mo data-latex=\right\rbrack data-mjx-texclass=CLOSE>]</mo></mrow><mstyle data-latex=\dfrac{k_0+k_1x}{1+k_2x+k_3x^2} displaystyle=true><mfrac><mrow data-latex="k_0 +k_1 x"><msub data-latex=k_0><mi data-latex=k>k</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi></mrow><mrow data-latex="1+k_2 x+k_3 x^2"><mn data-latex=1>1</mn><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mi data-latex=x>x</mi><mo data-latex=+>+</mo><msub data-latex=k_3><mi data-latex=k>k</mi><mn data-latex=3>3</mn></msub><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup></mrow></mfrac></mstyle><mo data-latex="=">=</mo><msub data-latex=k_0><mi data-latex=k>k</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img title="\left\lbrack x^0\right\rbrack\dfrac{k_0+k_1x}{1+k_2x+k_3x^2}=k_0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，该算法乘法次数相较于 Cipolla 算法更少．其他相关乘法次数较少的算法可见 Müller 的文章<sup id=fnref:ref2><a class=footnote-ref href=#fn:ref2>5</a></sup>．</p><h3 data-original-document-end=14743 data-original-document-start=14728 id=legendre-算法>Legendre 算法<a title="Permanent link" class=headerlink href=#legendre-算法></a></h3><p>对于同余方程 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^2\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^2\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^2\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 为奇素数且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为二次剩余．Legendre 算法可描述为找到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=r^2-a><mjx-msup data-latex=r^2><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r^2-a xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r^2-a></mjx-container> 为二次非剩余，令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_0+a_1x=(r-x)^{\frac{p-1}{2}}\bmod (x^2-a)" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_0+a_1x=(r-x)^{\frac{p-1}{2}}\bmod (x^2-a)" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_0+a_1x=(r-x)^{\frac{p-1}{2}}\bmod (x^2-a)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_0\equiv 0\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_0\equiv 0\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=\equiv>≡</mo><mn data-latex=0>0</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_0\equiv 0\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a_1^{-2}\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msubsup data-latex=a_1^{-2}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.297em;margin-left:0><mjx-texatom data-latex={-2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a_1^{-2}\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msubsup data-latex=a_1^{-2}><mi data-latex=a>a</mi><mn data-latex=1>1</mn><mrow data-latex={-2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=2>2</mn></mrow></msubsup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a_1^{-2}\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</p><details class=note data-original-document-end=15571 data-original-document-start=15111 open><summary>证明</summary> <p>考虑选择一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=b><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=b></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b^2\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b^2\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="b^2\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(r-b)(r+b)=r^2-a" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=r^2 space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(r-b)(r+b)=r^2-a" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=r^2><mi data-latex=r>r</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi></math></mjx-assistive-mml><img title="(r-b)(r+b)=r^2-a" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为二次非剩余，所以</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
(r-b)^{\frac{p-1}{2}}(r+b)^{\frac{p-1}{2}}\equiv -1\pmod p
" aria-hidden=true class=NCM-N display=true><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="(r-b)^{\frac{p-1}{2}}(r+b)^{\frac{p-1}{2}}\equiv -1\pmod p" display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
(r-b)^{\frac{p-1}{2}}(r+b)^{\frac{p-1}{2}}\equiv -1\pmod p
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>存在环态射</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\phi:\mathbf{F}_p\lbrack x\rbrack/(x^2-a)&\to \mathbf{F}_p\times \mathbf{F}_p\\
x&\mapsto (b,-b)
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
\phi:\mathbf{F}_p\lbrack x\rbrack/(x^2 -a)&\to \mathbf{F}_p\times \mathbf{F}_p\\
x&\mapsto (b,-b)
\end{aligned}" style=min-width:12.862em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:1.171em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=\phi><mjx-c class=mjx-c1D719>𝜙</mjx-c></mjx-mi><mjx-mo data-latex=: space=4><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=4><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\lbrack><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\rbrack><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\to space=4><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=4><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\times space=3><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=3><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\mapsto space=4><mjx-c class=mjx-c21A6>↦</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=- space=2><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\phi:\mathbf{F}_p\lbrack x\rbrack/(x^2-a)&\to \mathbf{F}_p\times \mathbf{F}_p\\x&\mapsto (b,-b)\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\phi:\mathbf{F}_p\lbrack x\rbrack/(x^2 -a)&\to \mathbf{F}_p\times \mathbf{F}_p\\x&\mapsto (b,-b)\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mi data-latex=\phi>ϕ</mi><mo data-latex=:>:</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub><mo data-latex=\lbrack fence=false stretchy=false>[</mo><mi data-latex=x>x</mi><mo data-latex=\rbrack fence=false stretchy=false>]</mo><mo data-latex=/>/</mo><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo accent=false data-latex=\to stretchy=false>→</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub><mo data-latex=\times>×</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub></mstyle></mtd></mtr><mtr data-latex><mtd><mi data-latex=x>x</mi></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\mapsto stretchy=false>↦</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\phi:\mathbf{F}_p\lbrack x\rbrack/(x^2-a)&\to \mathbf{F}_p\times \mathbf{F}_p\\
x&\mapsto (b,-b)
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>那么</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
(a_0+a_1b,a_0-a_1b)&=\phi(a_0+a_1x)\\
&=\phi(r-x)^{\frac{p-1}{2}}\\
&=((r-b)^{\frac{p-1}{2}},(r+b)^{\frac{p-1}{2}})\\
&=(\pm 1,\mp 1)
\end{aligned}
" aria-hidden=true class=NCM-N display=true><mjx-mtable data-latex="\begin{aligned}
(a_0 +a_1 b,a_0 -a_1 b)&=\phi(a_0 +a_1 x)\\
&=\phi(r-x)^{\frac{p-1}{2}}\\
&=((r-b)^{\frac{p-1}{2}},(r+b)^{\frac{p-1}{2}})\\
&=(\pm 1,\mp 1)
\end{aligned}" style=min-width:19.274em><mjx-table><mjx-itable><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_0 space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\phi space=4><mjx-c class=mjx-c1D719>𝜙</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.331em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\phi space=4><mjx-c class=mjx-c1D719>𝜙</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:1.331em><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=( space=2><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=)^{\frac{p-1}{2}}><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" style=height:.996em><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\mp space=2><mjx-c class=mjx-c2213>∓</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}(a_0+a_1b,a_0-a_1b)&=\phi(a_0+a_1x)\\&=\phi(r-x)^{\frac{p-1}{2}}\\&=((r-b)^{\frac{p-1}{2}},(r+b)^{\frac{p-1}{2}})\\&=(\pm 1,\mp 1)\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}(a_0 +a_1 b,a_0 -a_1 b)&=\phi(a_0 +a_1 x)\\&=\phi(r-x)^{\frac{p-1}{2}}\\&=((r-b)^{\frac{p-1}{2}},(r+b)^{\frac{p-1}{2}})\\&=(\pm 1,\mp 1)\end{aligned}" columnspacing=0em displaystyle=true rowspacing=3pt><mtr data-latex><mtd><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=b>b</mi><mo data-latex=,>,</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=b>b</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=\phi>ϕ</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=\phi>ϕ</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=x>x</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=->−</mo><mi data-latex=b>b</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=,>,</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><msup data-latex=)^{\frac{p-1}{2}}><mo data-latex=) stretchy=false>)</mo><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\mp>∓</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
(a_0+a_1b,a_0-a_1b)&=\phi(a_0+a_1x)\\
&=\phi(r-x)^{\frac{p-1}{2}}\\
&=((r-b)^{\frac{p-1}{2}},(r+b)^{\frac{p-1}{2}})\\
&=(\pm 1,\mp 1)
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>所以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="2a_0=(\pm 1)+(\mp 1)=0" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\mp><mjx-c class=mjx-c2213>∓</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="2a_0=(\pm 1)+(\mp 1)=0" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=\mp>∓</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="2a_0=(\pm 1)+(\mp 1)=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="2a_1b=(\pm 1)-(\mp 1)=\pm 2" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=a_1><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\mp><mjx-c class=mjx-c2213>∓</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="2a_1b=(\pm 1)-(\mp 1)=\pm 2" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mi data-latex=b>b</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=\mp>∓</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=\pm>±</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="2a_1b=(\pm 1)-(\mp 1)=\pm 2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</p></details><h3 data-original-document-end=15594 data-original-document-start=15573 id=tonellishanks-算法>Tonelli–Shanks 算法<a title="Permanent link" class=headerlink href=#tonellishanks-算法></a></h3><p>Tonelli–Shanks 算法是基于离散对数求解同余方程 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^2\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^2\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^2\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的算法<sup id=fnref:ref1><a class=footnote-ref href=#fn:ref1>6</a></sup>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 为奇素数且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的二次剩余．</p><p>令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="p-1=m2^n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-msup data-latex=2^n><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="p-1=m2^n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex="=">=</mo><mi data-latex=m>m</mi><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup></math></mjx-assistive-mml><img title="p-1=m2^n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 为奇数．仍然使用随机方法寻找 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=r\in\mathbf{F}_p><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex=\mathbf{F}_p space=4><mjx-texatom data-latex=\mathbf{F} texclass=ORD><mjx-mi data-latex=F><mjx-c class=mjx-c1D405>𝐅</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=p size=s><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r\in\mathbf{F}_p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi><mo data-latex=\in>∈</mo><msub data-latex=\mathbf{F}_p><mrow data-latex=\mathbf{F} data-mjx-texclass=ORD><mi data-latex=F mathvariant=bold>F</mi></mrow><mi data-latex=p>p</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r\in\mathbf{F}_p></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 为二次非剩余．令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g\equiv r^m\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=r^m space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g\equiv r^m\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=\equiv>≡</mo><msup data-latex=r^m><mi data-latex=r>r</mi><mi data-latex=m>m</mi></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="g\equiv r^m\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="b\equiv a^{(m-1)/2}\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^{(m-1)/2} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(m-1)/2} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="b\equiv a^{(m-1)/2}\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi><mo data-latex=\equiv>≡</mo><msup data-latex=a^{(m-1)/2}><mi data-latex=a>a</mi><mrow data-latex={(m-1)/2} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="b\equiv a^{(m-1)/2}\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么存在整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e\in\lbrace 0,1,2,\dots ,2^n-1\rbrace" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=\lbrace space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo space=2><mjx-c class=mjx-c2026>…</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=2^n space=2><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\rbrace><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e\in\lbrace 0,1,2,\dots ,2^n-1\rbrace" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi><mo data-latex=\in>∈</mo><mo data-latex=\lbrace fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mo>…</mo><mo data-latex=,>,</mo><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=\rbrace fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="e\in\lbrace 0,1,2,\dots ,2^n-1\rbrace" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="ab^2\equiv g^e\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=g^e space=4><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=e size=s><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="ab^2\equiv g^e\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><msup data-latex=g^e><mi data-latex=g>g</mi><mi data-latex=e>e</mi></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="ab^2\equiv g^e\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．若 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 为二次剩余，那么 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container> 为偶数且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\left(abg^{-e/2}\right)^2\equiv a\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=\left(abg^{-e/2}\right)^2><mjx-mrow data-latex=\left(abg^{-e/2}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-LO">(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=g^{-e/2}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={-e/2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-LO">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.62em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\left(abg^{-e/2}\right)^2\equiv a\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\left(abg^{-e/2}\right)^2><mrow data-latex=\left(abg^{-e/2}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=a>a</mi><mi data-latex=b>b</mi><msup data-latex=g^{-e/2}><mi data-latex=g>g</mi><mrow data-latex={-e/2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mi data-latex=e>e</mi><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\left(abg^{-e/2}\right)^2\equiv a\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>.</p><details class=note data-original-document-end=16341 data-original-document-start=16065 open><summary>证明</summary> <p>根据费马小定理可知</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
g^{2^n} \equiv r^{m2^n} = r^{p-1} \equiv 1 \pmod p.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=g^{2^n}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={2^n} size=s texclass=ORD><mjx-msup data-latex=2^n><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=r^{m2^n} space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={m2^n} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-msup data-latex=2^n><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=r^{p-1} space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={p-1} size=s texclass=ORD><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="g^{2^n} \equiv r^{m2^n} = r^{p-1} \equiv 1 \pmod p." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=g^{2^n}><mi data-latex=g>g</mi><mrow data-latex={2^n} data-mjx-texclass=ORD><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup></mrow></msup><mo data-latex=\equiv>≡</mo><msup data-latex=r^{m2^n}><mi data-latex=r>r</mi><mrow data-latex={m2^n} data-mjx-texclass=ORD><mi data-latex=m>m</mi><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup></mrow></msup><mo data-latex="=">=</mo><msup data-latex=r^{p-1}><mi data-latex=r>r</mi><mrow data-latex={p-1} data-mjx-texclass=ORD><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
g^{2^n} \equiv r^{m2^n} = r^{p-1} \equiv 1 \pmod p.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>又由于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 是二次非剩余，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
g^{2^{n-1}} \equiv r^{m2^{n-1}} = r^{\frac{p-1}{2}} \equiv -1 \pmod p.  
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=g^{2^{n-1}}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={2^{n-1}} size=s texclass=ORD><mjx-msup data-latex=2^{n-1}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=r^{m2^{n-1}} space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={m2^{n-1}} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-msup data-latex=2^{n-1}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=r^{\frac{p-1}{2}} space=4><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="g^{2^{n-1}} \equiv r^{m2^{n-1}} = r^{\frac{p-1}{2}} \equiv -1 \pmod p.  " display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=g^{2^{n-1}}><mi data-latex=g>g</mi><mrow data-latex={2^{n-1}} data-mjx-texclass=ORD><msup data-latex=2^{n-1}><mn data-latex=2>2</mn><mrow data-latex={n-1} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup></mrow></msup><mo data-latex=\equiv>≡</mo><msup data-latex=r^{m2^{n-1}}><mi data-latex=r>r</mi><mrow data-latex={m2^{n-1}} data-mjx-texclass=ORD><mi data-latex=m>m</mi><msup data-latex=2^{n-1}><mn data-latex=2>2</mn><mrow data-latex={n-1} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup></mrow></msup><mo data-latex="=">=</mo><msup data-latex=r^{\frac{p-1}{2}}><mi data-latex=r>r</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
g^{2^{n-1}} \equiv r^{m2^{n-1}} = r^{\frac{p-1}{2}} \equiv -1 \pmod p.  
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>所以，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g></mjx-container> 模 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=p>p</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p></mjx-container> 的阶是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=2^n><mjx-msup data-latex=2^n><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=2^n xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=2^n></mjx-container>．又因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="ab^2\equiv a^m\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^m space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="ab^2\equiv a^m\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mo data-latex=\equiv>≡</mo><msup data-latex=a^m><mi data-latex=a>a</mi><mi data-latex=m>m</mi></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="ab^2\equiv a^m\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^{2^n}\equiv 1\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^{2^n}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={2^n} size=s texclass=ORD><mjx-msup data-latex=2^n><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^{2^n}\equiv 1\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^{2^n}><mi data-latex=x>x</mi><mrow data-latex={2^n} data-mjx-texclass=ORD><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^{2^n}\equiv 1\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的解，所以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a^m><mjx-msup data-latex=a^m><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a^m xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^m><mi data-latex=a>a</mi><mi data-latex=m>m</mi></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a^m></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g></mjx-container> 的幂次．记 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a^m\equiv g^e\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=a^m><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=g^e space=4><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=e size=s><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a^m\equiv g^e\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=a^m><mi data-latex=a>a</mi><mi data-latex=m>m</mi></msup><mo data-latex=\equiv>≡</mo><msup data-latex=g^e><mi data-latex=g>g</mi><mi data-latex=e>e</mi></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a^m\equiv g^e\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．</p> <p>因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是二次剩余，所以</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
g^{e2^{n-1}} \equiv a^{m2^{n-1}} = a^{\frac{p-1}{2}} \equiv 1 \pmod p.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=g^{e2^{n-1}}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={e2^{n-1}} size=s texclass=ORD><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-msup data-latex=2^{n-1}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^{m2^{n-1}} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={m2^{n-1}} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-msup data-latex=2^{n-1}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=a^{\frac{p-1}{2}} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={\frac{p-1}{2}} size=s texclass=ORD><mjx-mfrac data-latex=\frac{p-1}{2}><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow data-latex=p-1 size=s><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="g^{e2^{n-1}} \equiv a^{m2^{n-1}} = a^{\frac{p-1}{2}} \equiv 1 \pmod p." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=g^{e2^{n-1}}><mi data-latex=g>g</mi><mrow data-latex={e2^{n-1}} data-mjx-texclass=ORD><mi data-latex=e>e</mi><msup data-latex=2^{n-1}><mn data-latex=2>2</mn><mrow data-latex={n-1} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup></mrow></msup><mo data-latex=\equiv>≡</mo><msup data-latex=a^{m2^{n-1}}><mi data-latex=a>a</mi><mrow data-latex={m2^{n-1}} data-mjx-texclass=ORD><mi data-latex=m>m</mi><msup data-latex=2^{n-1}><mn data-latex=2>2</mn><mrow data-latex={n-1} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup></mrow></msup><mo data-latex="=">=</mo><msup data-latex=a^{\frac{p-1}{2}}><mi data-latex=a>a</mi><mrow data-latex={\frac{p-1}{2}} data-mjx-texclass=ORD><mfrac data-latex=\frac{p-1}{2}><mrow data-latex=p-1><mi data-latex=p>p</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow><mn data-latex=2>2</mn></mfrac></mrow></msup><mo data-latex=\equiv>≡</mo><mn data-latex=1>1</mn><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
g^{e2^{n-1}} \equiv a^{m2^{n-1}} = a^{\frac{p-1}{2}} \equiv 1 \pmod p.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>由阶的性质可知，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="2^n\mid e2^{n-1}" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=2^n><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\mid><mjx-c class=mjx-c2223>∣</mjx-c></mjx-mo><mjx-mi data-latex=e space=4><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-msup data-latex=2^{n-1}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="2^n\mid e2^{n-1}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=2^n><mn data-latex=2>2</mn><mi data-latex=n>n</mi></msup><mo data-latex=\mid>∣</mo><mi data-latex=e>e</mi><msup data-latex=2^{n-1}><mn data-latex=2>2</mn><mrow data-latex={n-1} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup></math></mjx-assistive-mml><img title="2^n\mid e2^{n-1}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container> 是偶数．因此，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="abg^{-e/2}\bmod p" aria-hidden=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=g^{-e/2}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={-e/2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="abg^{-e/2}\bmod p" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mi data-latex=b>b</mi><msup data-latex=g^{-e/2}><mi data-latex=g>g</mi><mrow data-latex={-e/2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mi data-latex=e>e</mi><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="abg^{-e/2}\bmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是良定义的，且</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(abg^{-e/2}\right)^2 = a^2b^2g^{-e} \equiv a^{m+1}g^{-e} \equiv a \pmod p.
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex=\left(abg^{-e/2}\right)^2><mjx-mrow data-latex=\left(abg^{-e/2}\right)><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S3">(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-msup data-latex=g^{-e/2}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-e/2} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S3">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.699em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=a^2 space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-msup data-latex=g^{-e}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-e} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex=a^{m+1} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={m+1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-msup data-latex=g^{-e}><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={-e} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mspace data-latex=\kern18mu style=width:1em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(abg^{-e/2}\right)^2 = a^2b^2g^{-e} \equiv a^{m+1}g^{-e} \equiv a \pmod p." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\left(abg^{-e/2}\right)^2><mrow data-latex=\left(abg^{-e/2}\right) data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><mi data-latex=a>a</mi><mi data-latex=b>b</mi><msup data-latex=g^{-e/2}><mi data-latex=g>g</mi><mrow data-latex={-e/2} data-mjx-texclass=ORD><mo data-latex=->−</mo><mi data-latex=e>e</mi><mo data-latex=/>/</mo><mn data-latex=2>2</mn></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex="=">=</mo><msup data-latex=a^2><mi data-latex=a>a</mi><mn data-latex=2>2</mn></msup><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><msup data-latex=g^{-e}><mi data-latex=g>g</mi><mrow data-latex={-e} data-mjx-texclass=ORD><mo data-latex=->−</mo><mi data-latex=e>e</mi></mrow></msup><mo data-latex=\equiv>≡</mo><msup data-latex=a^{m+1}><mi data-latex=a>a</mi><mrow data-latex={m+1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msup><msup data-latex=g^{-e}><mi data-latex=g>g</mi><mrow data-latex={-e} data-mjx-texclass=ORD><mo data-latex=->−</mo><mi data-latex=e>e</mi></mrow></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><mspace data-latex=\kern18mu linebreak=nobreak width=1em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\left(abg^{-e/2}\right)^2 = a^2b^2g^{-e} \equiv a^{m+1}g^{-e} \equiv a \pmod p.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><p data-original-document-end=16789 data-original-document-start=16618>剩下的问题是如何计算 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container>．Tonelli 和 Shanks 提出一次确定 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container> 的一个二进制位．令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container> 在二进制下表示为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e=e_0+2e_1+4e_2+\cdots" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=e_0 space=4><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-msub data-latex=e_1><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=4 space=3><mjx-c class=mjx-c34>4</mjx-c></mjx-mn><mjx-msub data-latex=e_2><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=3><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e=e_0+2e_1+4e_2+\cdots" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi><mo data-latex="=">=</mo><msub data-latex=e_0><mi data-latex=e>e</mi><mn data-latex=0>0</mn></msub><mo data-latex=+>+</mo><mn data-latex=2>2</mn><msub data-latex=e_1><mi data-latex=e>e</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mn data-latex=4>4</mn><msub data-latex=e_2><mi data-latex=e>e</mi><mn data-latex=2>2</mn></msub><mo data-latex=+>+</mo><mo data-latex=\cdots>⋯</mo></math></mjx-assistive-mml><img title="e=e_0+2e_1+4e_2+\cdots" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e_k\in\lbrace 0,1\rbrace" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=e_k><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=\lbrace space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\rbrace><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e_k\in\lbrace 0,1\rbrace" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=e_k><mi data-latex=e>e</mi><mi data-latex=k>k</mi></msub><mo data-latex=\in>∈</mo><mo data-latex=\lbrace fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=\rbrace fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="e_k\in\lbrace 0,1\rbrace" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>．因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 是二次剩余，所以开始时 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e_0=0" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=e_0><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e_0=0" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=e_0><mi data-latex=e>e</mi><mn data-latex=0>0</mn></msub><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="e_0=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，然后利用如下性质逐位确定 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e_k><mjx-msub data-latex=e_k><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e_k xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=e_k><mi data-latex=e>e</mi><mi data-latex=k>k</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e_k></mjx-container> 的取值：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\left(g^eg^{-(e\bmod 2^k)}\right)^{2^{n-1-k}}\equiv g^{2^{n-1}\cdot e_k}\equiv 
\begin{cases}
1\pmod p,&\text{if }e_k=0\\
-1\pmod p,&\text{if }e_k=1
\end{cases}
" aria-hidden=true class=NCM-N display=true><mjx-msup data-latex='\leftken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}\right)^{2^{n-1-k}}'><mjx-mrow data-latex='\leftken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}\right)'><mjx-mo data-latex=\left(><mjx-c class="mjx-c28 NCM-S3">(</mjx-c></mjx-mo><mjx-msup data-latex=g^e><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mi data-latex=e size=s><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex='g^{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}'><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex='{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}' size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-msup data-latex=2^k><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\right)><mjx-c class="mjx-c29 NCM-S3">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:.744em><mjx-texatom data-latex={2^{n-1-k}} size=s texclass=ORD><mjx-msup data-latex=2^{n-1-k}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1-k} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-msup data-latex="g^{2^{n-1}\cdot e_k}" space=4><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex="{2^{n-1}\cdot e_k}" size=s texclass=ORD><mjx-msup data-latex=2^{n-1}><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={n-1} size=s texclass=ORD><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=e_k><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=\equiv space=4><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mrow data-latex={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:10.337em><mjx-table><mjx-itable><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mtext data-latex="\text{if }"><mjx-c class=mjx-c69 noic=true style=padding-top:.705em>i</mjx-c><mjx-c class=mjx-c66 noic=true style=padding-top:.705em>f</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.705em> </mjx-c></mjx-mtext><mjx-msub data-latex=e_k><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style=height:.996em><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mtext data-latex="\text{if }"><mjx-c class=mjx-c69 noic=true style=padding-top:.705em>i</mjx-c><mjx-c class=mjx-c66 noic=true style=padding-top:.705em>f</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.705em> </mjx-c></mjx-mtext><mjx-msub data-latex=e_k><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\left(g^eg^{-(e\bmod 2^k)}\right)^{2^{n-1-k}}\equiv g^{2^{n-1}\cdot e_k}\equiv \begin{cases}1\pmod p,&\text{if }e_k=0\\-1\pmod p,&\text{if }e_k=1\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex='\leftken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}\right)^{2^{n-1-k}}'><mrow data-latex='\leftken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}\right)' data-mjx-texclass=INNER><mo data-latex=\left( data-mjx-texclass=OPEN>(</mo><msup data-latex=g^e><mi data-latex=g>g</mi><mi data-latex=e>e</mi></msup><msup data-latex='g^{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}'><mi data-latex=g>g</mi><mrow data-latex='{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}' data-mjx-texclass=ORD><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=e>e</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><msup data-latex=2^k><mn data-latex=2>2</mn><mi data-latex=k>k</mi></msup><mo data-latex=) stretchy=false>)</mo></mrow></msup><mo data-latex=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mrow data-latex={2^{n-1-k}} data-mjx-texclass=ORD><msup data-latex=2^{n-1-k}><mn data-latex=2>2</mn><mrow data-latex={n-1-k} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=k>k</mi></mrow></msup></mrow></msup><mo data-latex=\equiv>≡</mo><msup data-latex="g^{2^{n-1}\cdot e_k}"><mi data-latex=g>g</mi><mrow data-latex="{2^{n-1}\cdot e_k}" data-mjx-texclass=ORD><msup data-latex=2^{n-1}><mn data-latex=2>2</mn><mrow data-latex={n-1} data-mjx-texclass=ORD><mi data-latex=n>n</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mo data-latex=\cdot>⋅</mo><msub data-latex=e_k><mi data-latex=e>e</mi><mi data-latex=k>k</mi></msub></mrow></msup><mo data-latex=\equiv>≡</mo><mrow data-latex={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex="\text{if }">if </mtext><msub data-latex=e_k><mi data-latex=e>e</mi><mi data-latex=k>k</mi></msub><mo data-latex="=">=</mo><mn data-latex=0>0</mn></mtd></mtr><mtr><mtd><mo data-latex=->−</mo><mn data-latex=1>1</mn><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex="\text{if }">if </mtext><msub data-latex=e_k><mi data-latex=e>e</mi><mi data-latex=k>k</mi></msub><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
\left(g^eg^{-(e\bmod 2^k)}\right)^{2^{n-1-k}}\equiv g^{2^{n-1}\cdot e_k}\equiv 
\begin{cases}
1\pmod p,&\text{if }e_k=0\\
-1\pmod p,&\text{if }e_k=1
\end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=17098 data-original-document-start=16959>其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g^e\equiv ab^2\pmod p" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=g^e><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=e size=s><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-msup data-latex=b^2><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mspace data-latex=\kern8mu style=width:.444em></mjx-mspace><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\mmlToken{mi}{mod}><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mi><mjx-mspace data-latex="\kern 6mu" style=width:.333em></mjx-mspace><mjx-mi data-latex=p space=2><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g^e\equiv ab^2\pmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=g^e><mi data-latex=g>g</mi><mi data-latex=e>e</mi></msup><mo data-latex=\equiv>≡</mo><mi data-latex=a>a</mi><msup data-latex=b^2><mi data-latex=b>b</mi><mn data-latex=2>2</mn></msup><mspace data-latex=\kern8mu linebreak=nobreak width=0.444em></mspace><mo data-latex=( stretchy=false>(</mo><mi data-latex=\mmlToken{mi}{mod}>mod</mi><mspace data-latex="\kern 6mu" linebreak=nobreak width=0.333em></mspace><mi data-latex=p>p</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="g^e\equiv ab^2\pmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 已知，而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e\bmod 2^k" aria-hidden=true class=NCM-N><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-msup data-latex=2^k><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e\bmod 2^k" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><msup data-latex=2^k><mn data-latex=2>2</mn><mi data-latex=k>k</mi></msup></math></mjx-assistive-mml><img title="e\bmod 2^k" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的取值可以由之前的数位 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e_0,e_1,\cdots,e_{k-1}><mjx-msub data-latex=e_0><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=e_1 space=2><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=e_{k-1} space=2><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={k-1} size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e_0,e_1,\cdots,e_{k-1} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=e_0><mi data-latex=e>e</mi><mn data-latex=0>0</mn></msub><mo data-latex=,>,</mo><msub data-latex=e_1><mi data-latex=e>e</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><msub data-latex=e_{k-1}><mi data-latex=e>e</mi><mrow data-latex={k-1} data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e_0,e_1,\cdots,e_{k-1}></mjx-container> 计算得到．当然，实现算法时，只需要直接维护乘积 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g^eg^{-(e\bmod 2^k)}\bmod p" aria-hidden=true class=NCM-N><mjx-msup data-latex=g^e><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mi data-latex=e size=s><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msup data-latex='g^{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}'><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex='{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}' size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-msup data-latex=2^k><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-script style=vertical-align:.363em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g^eg^{-(e\bmod 2^k)}\bmod p" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=g^e><mi data-latex=g>g</mi><mi data-latex=e>e</mi></msup><msup data-latex='g^{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}'><mi data-latex=g>g</mi><mrow data-latex='{-(e\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}2^k)}' data-mjx-texclass=ORD><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=e>e</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><msup data-latex=2^k><mn data-latex=2>2</mn><mi data-latex=k>k</mi></msup><mo data-latex=) stretchy=false>)</mo></mrow></msup><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mi data-latex=p>p</mi></math></mjx-assistive-mml><img title="g^eg^{-(e\bmod 2^k)}\bmod p" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 即可．</p><h2 data-original-document-end=17105 data-original-document-start=17100 id=习题>习题<a title="Permanent link" class=headerlink href=#习题></a></h2><ul data-original-document-end=17251 data-original-document-start=17107><li><a href=https://www.luogu.com.cn/problem/P5491 target=_blank>洛谷 P5491【模板】二次剩余</a></li><li><a href="https://acm.timus.ru/problem.aspx?space=1&num=1132" target=_blank>「Timus 1132」Square Root</a></li></ul><h2 data-original-document-end=17263 data-original-document-start=17253 id=参考资料与注释>参考资料与注释<a title="Permanent link" class=headerlink href=#参考资料与注释></a></h2><ol data-original-document-end=18302 data-original-document-start=17265><li><a href=https://en.wikipedia.org/wiki/Quadratic_residue target=_blank>Quadratic residue - Wikipedia</a></li><li><a href=https://en.wikipedia.org/wiki/Euler%27s_criterion target=_blank>Euler's criterion - Wikipedia</a></li></ol><div class=footnote><hr><ol><li id=fn:ref5><p><a href=https://en.wikipedia.org/wiki/Proofs_of_quadratic_reciprocity target=_blank>Proofs of quadratic reciprocity - Wikipedia</a> <a title="Jump back to footnote 1 in the text" class=footnote-backref href=#fnref:ref5>↩</a></p></li><li id=fn:ref6><p>Carl Friedrich Gauss. Untersuchungen über höhere Arithmetik, 1965. Page 458-462. <a title="Jump back to footnote 2 in the text" class=footnote-backref href=#fnref:ref6>↩</a></p></li><li id=fn:ref3><p>A. Menezes, P. van Oorschot and S. Vanstone. Handbook of Applied Cryptography, 1996. <a title="Jump back to footnote 3 in the text" class=footnote-backref href=#fnref:ref3>↩</a></p></li><li id=fn:ref4><p>Alin Bostan, Ryuhei Mori. A Simple and Fast Algorithm for Computing the N-th Term of a Linearly Recurrent Sequence. Available at <a href=https://arxiv.org/abs/2008.08822 target=_blank>https://arxiv.org/abs/2008.08822</a>. <a title="Jump back to footnote 4 in the text" class=footnote-backref href=#fnref:ref4>↩</a></p></li><li id=fn:ref2><p>S. Müller, On the computation of square roots in finite fields, Design, Codes and Cryptography, Vol.31, pp. 301-312, 2004. <a title="Jump back to footnote 5 in the text" class=footnote-backref href=#fnref:ref2>↩</a></p></li><li id=fn:ref1><p>Daniel. J. Bernstein. Faster Square Roots in Annoying Finite Fields. <a title="Jump back to footnote 6 in the text" class=footnote-backref href=#fnref:ref1>↩</a></p></li><li id=fn:ref7><p>Kobi Kremnizer.<a href=https://courses.maths.ox.ac.uk/pluginfile.php/29788/mod_resource/content/1/numbertheory-2022.pdf target=_blank>Lectures in number theory 2022</a>. Proposition 4.3. <a title="Jump back to footnote 7 in the text" class=footnote-backref href=#fnref:ref7>↩</a></p></li></ol></div><hr><blockquote class=page-copyright><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"></path></svg></i>本页面最近更新：</span><span class=facts_modified>2026/1/7 08:56:54</span>，<a class=edit_history href=https://github.com/OI-wiki/OI-wiki/commits/master/docs/math/number-theory/quad-residue.md target=_blank>更新历史</a><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"></path></svg></i>发现错误？想一起完善？ <a href="https://oi-wiki.org/edit-landing/?ref=/math/number-theory/quad-residue.md" class=page_edit_url title=edit.link.title>在 GitHub 上编辑此页！</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M16 17v2H2v-2s0-4 7-4 7 4 7 4m-3.5-9.5A3.5 3.5 0 1 0 9 11a3.5 3.5 0 0 0 3.5-3.5m3.44 5.5A5.32 5.32 0 0 1 18 17v2h4v-2s0-3.63-6.06-4M15 4a3.4 3.4 0 0 0-1.93.59 5 5 0 0 1 0 5.82A3.4 3.4 0 0 0 15 11a3.5 3.5 0 0 0 0-7"></path></svg></i>本页面贡献者：</span><span class=page_contributors><a href=https://github.com/Tiphereth-A target=_blank>Tiphereth-A</a>, <a href=https://github.com/c-forrest target=_blank>c-forrest</a>, <a href=https://github.com/ShaoChenHeng target=_blank>ShaoChenHeng</a>, <a href=https://github.com/hly1204 target=_blank>hly1204</a>, <a href=https://github.com/StudyingFather target=_blank>StudyingFather</a>, <a href=https://github.com/Great-designer target=_blank>Great-designer</a>, <a href=https://github.com/TachikakaMin target=_blank>TachikakaMin</a>, <a href=https://github.com/Xeonacid target=_blank>Xeonacid</a>, <a href=https://github.com/Enter-tainer target=_blank>Enter-tainer</a>, <a href=https://github.com/sshwy target=_blank>sshwy</a>, <a href=https://github.com/Chrogeek target=_blank>Chrogeek</a>, <a href=https://github.com/iamtwz target=_blank>iamtwz</a>, <a href=https://github.com/marscheng1 target=_blank>marscheng1</a>, <a href=https://github.com/monkeysui target=_blank>monkeysui</a>, <a href=https://github.com/nanmenyangde target=_blank>nanmenyangde</a>, <a href=https://github.com/xyf007 target=_blank>xyf007</a>, <a href=https://github.com/rgw2010 target=_blank>rgw2010</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10.08 10.86c.05-.33.16-.62.3-.86.3-.56.81-.85 1.5-.86.45 0 .86.2 1.15.49.28.31.47.74.47 1.17h1.8c-.02-.47-.11-.9-.3-1.3-.15-.38-.38-.72-.68-1-1.45-1.34-4.14-1.15-5.37.37-1.29 1.67-1.32 4.59-.01 6.26 1.21 1.49 3.86 1.7 5.3.37.31-.25.56-.56.76-.92.16-.36.27-.74.28-1.15H13.5c0 .21-.07.4-.16.57-.09.19-.21.34-.34.47-.33.26-.72.4-1.14.4-.36-.01-.66-.08-.89-.23a1.4 1.4 0 0 1-.59-.64c-.5-.9-.42-2.15-.3-3.14M12 2C6.5 2 2 6.5 2 12c.53 13.27 19.5 13.26 20 0 0-5.5-4.5-10-10-10m0 18c-4.41 0-8-3.59-8-8 .44-10.61 15.56-10.61 16 0 0 4.41-3.59 8-8 8"></path></svg></i>本页面的全部内容在 <strong><a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh target=_blank>CC BY-SA 4.0</a> 和 <a href=https://github.com/zTrix/sata-license target=_blank>SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span></blockquote><div class=giscus data-no-instant id=__comments></div><div id=__comments_script></div><script>var comments=document.createElement("script"),commentsTheme="slate"===document.body.dataset.mdColorScheme?"dark":"light";Object.entries({async:!0,src:"https://giscus.app/client.js",crossOrigin:"anonymous","data-repo":"OI-wiki/gitment","data-repo-id":"MDEwOlJlcG9zaXRvcnkxNDQzODg5NjU=","data-category":"评论","data-category-id":"DIC_kwDOCJszZc4CS54y","data-mapping":"specific","data-term":"二次剩余","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":commentsTheme,"data-lang":"zh-CN","data-loading":"lazy"}).forEach((e=>comments.setAttribute(e[0],e[1]))),document.getElementById("__comments_script").replaceWith(comments)</script></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><script>function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script><button class=data-tip-left data-tip=回到顶部 id=myBtn onclick=topFunction()><svg class="Zi Zi--BackToTop data-tip-left" viewbox="0 0 24 24" data-tip=回到顶部 fill=currentColor height=24 width=24><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight>Copyright © 2016 - 2026 OI Wiki Team</div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs <div id=miitbeian></div> </a></div><div class=build_date_utc style=float:right><a href=https://github.com/OI-wiki/OI-wiki target=_blank> 最近更新：1b96d637c, 2026-02-25 </a></div><script>"oi-wiki.com"!=window.location.hostname&&"www.oi-wiki.com"!=window.location.hostname||(document.getElementById("miitbeian").innerHTML='<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>'),console.log("%c OI Wiki %c 1b96d637c %c","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),console.log("少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org")</script></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../../..", "features": ["content.action.edit", "navigation.tabs", "navigation.instant", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.931a43a5.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script><script src=../../../assets/javascripts/bundle.73202423.min.js></script><script src="../../../assets/javascripts/oiwiki-feedback-sys-frontend.js?v=5b99436423505efd4a4e01c1b294beee"></script><script src="../../../_static/js/oiwiki-feedback-sys-frontend.js?v=9c84250724ffe2e409ef6df0cac8900b"></script><script>"use strict";"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then((function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)})).catch((function(e){console.log("PWA Registration failed with "+e)}))</script></body></html>