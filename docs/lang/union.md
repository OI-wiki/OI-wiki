**联合体**（union）在某种程度上是类似 [结构体](./struct.md)（struct）的一种数据结构，它的所有成员公用一份内存空间，只保留一个成员的数据，即可以在任意时刻作为任意类型的成员来赋值使用。同时也为一个变量开辟了若干不同的访问途径。

联合体在 2023 年正式被加入 NOI 大纲入门级中。

## 定义联合体

```cpp
union MyUnion {
  int x;
  long long y;
} x;
```

联合体的定义与结构体类似。按照上述定义，`Union` 同样可以当作一种自定义类型使用。名称 `MyUnion` 可以省略。

## 访问/修改成员元素

与结构体类似，同样可以使用 `变量名.成员元素名` 进行访问。

联合体中所有成员 **共用一份空间**，一个联合体所占用的空间大小为其成员中占用空间 **最大的元素** 的大小。当一个元素被赋值，上一次赋值将被覆盖。

## 联合体的用处

联合体可以节约内存空间。例如使用要存储三个不同类型的值，但是往往只有一个值有效，那么使用结构体将额外花费两倍的空间。

联合体可以用于查看二进制表示。

```cpp
union {
  int n;
  unsigned char bits[4];
} a;

int main() {
  int x;
  scanf("%d", &x);
  a.n = x;
  for (int i = 0; i < 4; i++) cout << bitset<8>(a.bits[i]) << " ";
  return 0;
}
```

使用上面的程序，可以便捷地查看一个 `int` 类型的二进制表示。值得注意的是，输出的结果的字节顺序可能与系统大小端有关，我们可以使用联合体来 **检测处理器是大端模式还是小端模式**。

此外，联合体在实际应用场景中，可以解决如下类似问题：要用同一种数据结构存储老师和学生的信息，只需要记录老师的姓名和学生的学号。若数据规模较大，我们就可以使用联合体来大大节省空间。

## 参考资料

-   [联合体声明](https://zh.cppreference.com/w/cpp/language/union)
