author: tsagaanbar

## 变量的地址、指针

在程序中，我们的数据都有其存储的地址。在程序每次的实际运行过程中，变量的存储位置不尽相同。不过，我们仍能够在编程时，通过一定的语句，来取得数据的地址。

地址也是数据。存放地址所用的变量类型有一个特殊的名字，叫做“指针变量”，有时也简称做“指针”。

地址只是一个刻度一般的数据，为了针对不同类型的数据，“指针变量”也有不同的类型，比如，可以有 `int` 类型的指针变量，其中存储的地址（即指针变量存储的数值）对应一块大小为 32 位的空间的起始地址；有 `char` 类型的指针变量，其中存储的地址对应一块 8 位的空间的起始地址。

假如用户自定义了一个结构体：

```cpp
struct ThreeInt {
    int a;
    int b;
    int c;
};
```

则 `ThreeInt` 类型的指针变量，对应着一块 3 × 32 = 96 bit 的空间。

C/C++ 中，指针变量的类型为类型名后加上一个星号 `*`。比如，`int` 类型的指针变量的类型名即为 `int*`。

我们可以使用 `&` 符号取得一个变量的地址。

要想访问指针变量地址所对应的空间（又称指针所**指向**的空间），需要对指针变量进行**解引用**（dereference），使用 `*` 符号。

```cpp
int main() {
    int a = 123; // a: 123
    int * pa = &a;
    *pa = 321; // a: 321
}
```

对结构体变量也是类似。有一点需要注意，在编写代码使用“箭头”运算符 `->` 以通过指针来访问结构中的成员。

```cpp
struct ThreeInt {
    int a;
    int b;
    int c;
};

int main() {
    ThreeInt x{1,2,3}, y{6,7,8};
    ThreeInt * px = &x;
    (*px) = y;   // x: {6,7,8}
    (*px).a = 4; // x: {4,7,8}
    px->b = 5;   // x: {4,5,8}
}
```

指针变量也可以**和整数**进行加减操作。对于 `int` 型指针，每加 1（递增 1），其指向的地址偏移 32 位；若加 2，则指向的地址偏移 \\(2 \times 32 = 64\\) 位。同理，对于 `char` 型指针，每次递增，其指向的地址偏移 8 位。

我们前面说过，数组是一块连续的存储空间。而在 C/C++ 中，直接使用数组名，得到的是数组的起始地址。

```cpp
int main() {
    int a[3] = {1, 2, 3};
    int * p = a; // p 指向 a[0]
    *p = 4;      // a: [4, 2, 3]
    p = p + 1;   // p 指向 a[1]
    *p = 5;      // a: [4, 5, 3]
    p++;         // p 指向 a[2]
    *p = 6;      // a: [4, 5, 6]
}
```

现在，假如我们要存储一个数组的数组（即二维数组）的首地址。这个数组的数组中，存放的若干数组的地址，也就是若干指针变量。因此，我们需要一个“指向指针的指针”，有时也称作“二重指针”。如果读者明白了指针的含义，那么应该也能轻松地理解所谓“指向指针的指针”。

