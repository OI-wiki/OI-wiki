前置知识：[抽象代数基本概念](./basic.md)、[置换与排列](../permutation.md)

## 引入

**群论**（group theory）主要研究群这个代数结构。

为了研究群的结构，需要掌握一些基本工具，这包括子群、群同态和群作用。算法竞赛中，主要涉及到的群是数论相关的群（比如模 $n$ 的整数乘法单位群 $(\mathbf Z/n\mathbf Z)^\times$）以及置换群，本文将着重介绍相关的概念。本文未涉及的群论部分，比如有限群的结构理论和群的线性表示理论，有兴趣的读者应当参考专业书籍。

在不引起歧义时，本文可能会将 $g\cdot h$ 写作 $gh$，也可能会将群 $(G,\cdot)$ 写作群 $G$。

理解抽象代数不能够离开实例。作为理解下文概念的例子，首先讨论正三角形的空间对称群 $D_6$。

如图所示，对于给定正三角形，共计有六种不同的操作可以使得它与自身重合。这里，使用 $r$ 表示顺时针旋转，使用 $s$ 表示沿顶点 $1$ 到三角形中心的连线翻转，操作自右向左复合，即 $sr$ 表示先旋转（$r$）再翻转（$s$）。两个操作不同，当且仅当某个三角形的顶点在两个操作之后所处位置不同。

|   记号   |          操作         |  阶  |  置换表示 |
| :----: | :-----------------: | :-: | :---: |
|   $e$  |     恒等变换，即什么也不做     |  1  | $(1)$ |
|   $r$  |  顺时针旋转 $120^\circ$  |  3  |       |
|  $r^2$ |  顺时针旋转 $240^\circ$  |  3  |       |
|   $s$  |    沿 $1$ 到中心连线翻转    |  2  |       |
|  $sr$  | 先旋转 $120^\circ$，再翻转 |  2  |       |
| $sr^2$ | 先旋转 $240^\circ$，再翻转 |  2  |       |

容易验证，这些操作确实构成了群。比如说，该群的单位元是 $e$，而 $sr$ 的逆元是它自身。而且，群 $D_6$ 并不是交换群，比如可以直接验证 $rs=sr^{-1}$。

## 子群

要理解给定群的结构，可以首先分析其子结构。群的子结构就是那些在同一运算下仍然成为一个群的该群的子集。由此，有如下定义。

-   子群：给定群 $(G,\cdot)$，则称 $H\subseteq G$ 是 $G$ 的一个 **子群**（subgroup），记作 $H\le G$，如果 $(H,\cdot)$ 也是一个群。

在 $D_6$ 中，容易验证它的子群有 $\{e\}$，$\{e,s\}$，$\{e,sr\}$，$\{e,sr^2\}$，$\{e,r,r^2\}$ 和 $D_6$ 本身，共计六个。除去平凡子群 $\{e\}$ 和 $D_6$，这些群都是更为简单的结构，而且提供了关于原来群的部分信息。

要判断给定子集 $H\subseteq G$ 是不是子群，并不需要逐一验证群的定义。结合律自然成立；子集成为子群，只要保证它对二元运算封闭、有单位元且对取逆封闭就好了。事实上，这些条件可以总结在一起。

-   群 $G$ 的子集 $H$ 是子群，当且仅当，对于所有元素 $g,h \in H$，成立 $g^{-1}h\in H$。

### 由子集生成的子群

$D_6$ 的非平凡子集都有共同的特点，就是它们都可以通过这样的方式构造：先选取一个操作，然后反复迭代该操作，直到得到恒等变换，这样形成的集合就是一个子群。这是下面这一概念的特例。

-   由子集生成的子群：给定群 $G$ 和它的非空子集 $S\subseteq G$，则子群 $H$ 称为 **由子集 $S$ 生成的子群**（subgroup generated by a subset），并记作 $\langle S\rangle$，如果 $H$ 是包含 $S$ 的 $G$ 的子群中最小的。

可以证明，任给定这样的子集 $S$，总能找到这样的子群：$\langle S\rangle$ 可以构造为所有包含 $S$ 的 $G$ 的子群的交。利用这一记号，可以将子群 $\{e,r,r^2\}$ 记作 $\langle r\rangle$，其它同理。这里，略去了列举元素的集合记号。

有些子集生成的子群是群本身。这样的子集尤为特殊，称为群的生成子集。

-   群的生成子集：给定群 $(G,\cdot)$ 和子集 $S\subseteq G$，则称 $S$ 是 $G$ 的 **生成子集**（generating set of a group），如果 $\langle S\rangle=G$。

群是自身平凡的生成子集。更为有趣的情形是，生成子集远小于群本身的规模。比如，$D_6=\langle s,r\rangle$，这就是说，任何正三角形的对称操作都可以通过旋转和翻转的复合得到。

### 循环群

仅由一个元素生成的群的结构非常简单。这样的群称为循环群。

-   循环群：给定群 $G$，称 $G$ 是一个 **循环群**（cyclic group），如果存在 $x\in G$，成立 $G=\langle x\rangle$。

所有 $D_6$ 的非平凡子群以及 $\langle e\rangle$ 都是循环群。

给定循环群 $G=\langle x\rangle$，它总可以写作 $G=\{x^n:n\in\mathbf Z\}$。如果群 $G$ 有限，那么必然存在自然数 $n<m$ 满足 $x^n=x^m$，依消去律，可以得到 $x^{m-n}=e$。此时，不妨取最小的正整数 $n\in\mathbf N_+$ 使得 $x^n=e$，那么列 $\{x^k\}$ 将会是长度为 $n$ 的循环，且循环节内元素各不相同（否则违反 $n$ 的最小性）。所以，此时群 $G$ 的大小就是 $n$，这样的循环群记作 $\mathbf Z_n$。如果群 $G$ 无限，则群内元素各不相同，这样的循环群记作 $\mathbf Z$。

可以证明，循环群的结构由其大小唯一确定。也就是说，所有循环群只有 $\mathbf Z_n\;(n\in\mathbf N_+)$ 和 $\mathbf Z$。这一结论的严格表示需要用到下文的群同构的概念，它严格描述了两个群结构相同这一事实。

-   定理：有限循环群 $G$ 同构于 $\mathbf Z_n$，这里，$n=|G|$。无限循环群 $G$ 同构于 $\mathbf Z$。

这里，循环群的记号和整数集 $\mathbf Z$ 的记号相似。这是因为，整数集的加法群 $(\mathbf Z,+)$ 就是由 $1$（或 $-1$）生成的循环群；而模 $n$ 的整数的加法群 $(\mathbf Z/n\mathbf Z,+)$ 则是由 $\bar 1$ 生成的 $n$ 阶循环群。

所有循环群都是 Abel 群。本文的例子 $D_6$ 说明，即使群的所有非平凡子群都是循环群，群本身也可能不是 Abel 群。

### 阶

群的阶就是群的元素的个数。群内给定元素的阶就是该元素生成的循环子群的阶。由此，有如下定义。

-   群的阶：给定群 $G$，群的 **阶**（order）是群的元素个数，记作 $|G|$。无限群的阶也是无限。
-   元素的阶：给定群 $G$，元素 $x\in G$ 的 **阶**（order）是最小的正整数 $n$ 使得 $x^n=e$ 成立，记作 $|x|$；如果这样的 $n$ 不存在，则称元素 $x$ 的阶是无限，记作 $|x|=\infty$。

元素的阶总是不大于群的阶，事实上，下文即证明，元素的阶总是整除群的阶。但是，群的阶并非总是元素的阶的最大值，比如 $D_6$ 是六阶群，但是元素的阶最大是 $3$。群的阶也并不是所有元素的阶的最小公倍数，比如 Klein 四元群[^klein] $V_4$ 的阶是 $4$，但是里面只有 $1$ 阶元和 $2$ 阶元。

### 陪集

子群以外的元素在群中的结构也并非杂乱无章。事实上，观察 $D_6$ 中的子群 $\langle r\rangle$，剩余的元素 $\{s,sr,sr^2\}$ 结构和 $\langle r\rangle$ 十分相似，它当中的每个操作都可以通过 $s$ 和 $\langle r\rangle$ 中的操作复合得到。同理，考虑子群 $\langle s\rangle$，则群中的剩余元素可以分为两类，$\{r,sr\}$ 和 $\{r^2,sr^2\}$，它们可以通过 $\langle s\rangle$ 中的元素分别与 $r$ 和 $r^2$ 复合得到。

这样的现象是普遍的。给定子群，可以定义它的陪集。

-   陪集：给定群 $G$ 和它的子群 $H\le G$，包含 $g$ 的 **左陪集**（left coset）和 **右陪集**（right coset）分别定义为集合
    $$
    \begin{aligned}
    gH &= \{gh:h\in H\},\\
    Hg &= \{hg:h\in H\}.
    \end{aligned}
    $$
    陪集中的元素称为陪集的代表元（representative element）。

子群本身也是其陪集。给定子群，全体陪集构成群的一个分划，即群是全体陪集的不交并。

按照陪集的语言，上面的例子中，$D_6$ 可以分别划分成 $\langle r\rangle\cup s\langle r\rangle$ 和 $\langle s\rangle\cup \langle s\rangle r \cup \langle s\rangle r^2$。这里，前者将群划分为若干左陪集，后者将群划分为若干右陪集。应该注意，代表元的选取并无特殊，比如可以验证 $s\langle r\rangle=sr\langle r\rangle$。陪集中的任何元素都是该陪集的代表元。

同一子群的不同陪集大小都相同，都等于对应子群的大小。这是因为，左乘以 $g$ 的映射 $h\mapsto gh$ 是双射，所以必然有 $|H|=|gH|$。由于给定子群的全体陪集构成群的一个分划，有限群的阶必然是子群的阶的整数倍。这叫做 Lagrange 定理。

-   Lagrange 定理：给定群 $G$ 和它的子群 $H\le G$，成立 $|G|=[G:H]|H|$，这里，$[G:H]$ 表示 $G$ 中子群 $H$ 的左（右）陪集数。

注意到，元素的阶就是元素生成的循环子群的阶，所以元素的阶也必然整除群的阶。

### 正规子群

一般情况下，给定子群的左右陪集并不相同。比如，$\langle s\rangle r=\{r,sr\}$，但是 $r\langle s\rangle=\{r,sr^2\}$。但是如果考虑子群 $\langle r\rangle$，那么左右陪集又总是相同的，因为此时群只有两个陪集，而子群作为一个陪集又必然重合。左右陪集是否相同，反映了相应的子群的性质。

-   正规子群：给定群 $G$ 和它的子群 $N\le G$，则称 $N$ 是 $G$ 的一个正规子群，记作 $N\trianglelefteq G$，如果对所有 $h\in N$ 和 $g\in G$，都成立 $ghg^{-1}\in N$，换言之，对所有 $g\in G$，都成立 $gNg^{-1}\subseteq N$。

这个定义中的条件正等价于 $gN=Ng$ 永远成立。群 $G$ 总有平凡的正规子群，即 $\langle e\rangle$ 和 $G$ 自身。

在群 $D_6$ 中，$\langle s\rangle$ 不是正规子群，而 $\langle r\rangle$ 是正规子群。

### 商群

正规子群是非常重要的一类子群，原因之一就是基于正规子群可以定义商群。

给定群 $G$ 和它的正规子群 $N\trianglelefteq G$，考虑全体陪集的集合

$$
G/N = \{gN:g\in G\}.
$$

此时，左右陪集相同，不必区分。可以从群 $G$ 的运算出发，定义 $G/N$ 上的二元运算 $\circ$，它满足

$$
g_1N\circ g_2N=(g_1g_2)N.
$$

可以证明，当且仅当在 $N$ 是正规子群的条件下，运算的结果与代表元的选取无关。此时，$(G/N,\circ)$ 确实具有群的结构，它称为 $G$ 模 $N$ 的 **商群**（quotient group）。商群 $G/N$ 并不是群 $G$ 的子群，它的每个元素都是群 $G$ 的一个子群。

在群 $D_6$ 中，商群 $G/\langle r\rangle$ 的意义非常显然。它相当于在所有这些对称操作中，忽视操作中将三角形旋转的角度，而只关注它是否将三角形翻转。两个将三角形翻转的操作的复合相当于没有翻转原三角形；但是，如果两个操作一个翻转了三角形而另一个没有，那么复合也必然翻转了三角形。翻转与否也具有群的结构。从群 $D_6$ 中忽视旋转的细节而只考虑翻转的有无，在代数上就是将复杂的群 $D_6$ 模掉 $\langle r\rangle$ 而得到商群 $D_6/\langle r\rangle$。这些论述对子群 $\langle s\rangle$ 是无效的，因为如果忽视翻转的有无，那么旋转的度数没有办法明确判断的，这也是为什么 $G/\langle s\rangle$ 不具有商群的结构。

从这个例子中可以看出，群的商群可以将复杂的群简化，允许观察群的部分结构来了解原来群的结构。这也是商群也称为 **因子群**（factor group）的原因。没有平凡正规子群的群称为 **单群**（simple group），这些群没有办法简化为更小的群。如同素数一样，它们是组成更复杂的群结构的基石。

## 群同态

理解给定群结构的第二种方法，是将两个群的结构相互比较。

给定两个群，要比较它们的结构，就是要构造两个群之间的映射。但是，这样的映射并不能是任意的，它们要保持群的结构，也就是要保持群的运算在映射前后一致。这样的映射称为群的同态。

-   群同态：给定群 $(G,\cdot_G)$ 和 $(H,\cdot_H)$，则称映射 $\pi:G\rightarrow H$ 是一个自群 $G$ 到群 $H$ 的 **同态**（homomorphism），如果 $\pi$ 保持群的运算，即对所有 $g_1,g_2\in G$ 都成立 $\pi(g_1\cdot_G g_2)=\pi(g_1)\cdot_H\pi(g_2)$。

群同态必然将幺元映射到幺元，也必然将逆元映射到逆元。

在下文中，如果不引起歧义，不会区分群 $G$ 和 $H$ 中的运算的记号，并且为表述简便，将省略这些记号。

### 群同构

给定自群 $G$ 到群 $H$ 的同态 $\pi:G\rightarrow H$，一个自然的问题是，这一同态在多大程度上反映了群 $G$ 和群 $H$ 的结构是一致的。为此，考察群 $G$ 在同态 $\pi$ 下的像 $\pi(G)$，它将群 $G$ 的结构映射到群 $H$ 中。一方面，$\pi(G)$ 是群 $H$ 的一个子群；但若同态 $\pi$ 不是满的，$\pi(G)$ 与群 $H$ 并不相同。另一方面，同态 $\pi$ 也未必是单的；如果 $\pi$ 不是单的，那么 $\pi(G)$ 只反映了群 $G$ 的部分结构。只有当同态 $\pi$ 既单又满时，群 $G$ 和群 $H$ 的结构才是完全一致的。这种特殊的群同态叫做群同构。

-   群同构：给定自群 $G$ 到群 $H$ 的同态 $\pi:G\rightarrow H$，则称 $\pi$ 是群 $G$ 和群 $H$ 之间的 **同构**（isomorphism），记作 $G\cong H$，如果 $\pi$ 是双射。

同构的两个群结构完全一致。如果只关心群的结构，两个同构的群没有必要区分。前文关于循环群的分类定理就是在同构的意义下给出的。

回到前文的例子，正三角形的每个对称操作都唯一对应了顶点集合上的置换操作。顶点集合上的全体置换也构成群，即 $S_3$。容易验证，这样得到的映射 $\pi:D_6\rightarrow S_3$ 是群同态；进一步地，它也是群同构。所以，$D_6\cong S_3$。事实上，六阶群要么同构于 $\mathbf Z_6$，要么同构于 $S_3$。将给定阶的有限群的结构进行分类，也是群论中的重要研究内容，但超出了本文的范畴。

### 同态的核

对于一般的同态，可以进一步讨论有多少关于群的结构的信息损失在了同态中。延续上文的记号。已知 $\pi(G)$ 是群 $H$ 的子群，所以，现在问题的关键在于 $\pi(G)$ 和群 $G$ 之间的关系。

考虑如下定义的映射 $\pi: D_6 \rightarrow \mathbf Z_2 = \langle x\rangle$：

$$
\pi(e)=\pi(r)=\pi(r^2)=e,\ \pi(s)=\pi(sr)=\pi(sr^2)=x.
$$

容易验证，$\pi$ 是群同态；它是满的，但不是单的。它的意义很明显，就是在群的每一个对称操作映射到其翻转的有无。这样的同态压缩的群 $D_6$ 中的信息，就是有关它旋转角度的信息。比如说，如果没有翻转，任何角度的旋转都映射到了群 $\mathbf Z_2$ 中的单位元。这启发使用 $\{e\}$ 的原像衡量同态中损失的结构信息。为此，有如下定义。

-   同态的核：给定自群 $G$ 到群 $H$ 的同态 $\pi:G\rightarrow H$，则同态 $\pi$ 的 **核**（kernel）是 $\ker\pi=\{g\in G:\pi(g)=e\}$，这里，$e$ 是 $H$ 的单位元。

### 同态基本定理

同态的核 $\ker\pi$ 的确刻画了群同态中损失的结构信息。

-   同态基本定理（亦称第一同构定理）（fundamental theorem of group homomorphism, a.k.a., first isomorphism theorem）：给定自群 $G$ 到群 $H$ 的同态 $\pi:G\rightarrow H$，则 $\ker\pi\trianglelefteq G$，且 $G/\ker\pi\cong\pi(G)\le H$。
-   推论：同态 $\pi:G\rightarrow H$ 是单的，当且仅当 $\ker\pi=\{e\}$，此时，$G$ 同构于 $H$ 的一个子群，即 $G\cong\pi(G)\le H$。

也就是说，同态 $\pi$ 的核是群 $G$ 的正规子群，而模 $\ker\pi$ 得到的商群 $G/\ker\pi$ 同构于同态的像 $\pi(G)$，而这一同态的像正是群 $H$ 的子群。

上文给出的群同态 $\pi: D_6 \rightarrow \mathbf Z_2$ 的核是 $\langle r\rangle$，前文讨论正规子群时也已经说明 $D_6/\langle r\rangle$ 的确同构于 $\mathbf Z_2$。

### 自然同态

得到这样的结论并不为奇。这是因为在构造同态 $\pi: D_6 \rightarrow \mathbf Z_2$ 时，利用的正是商群 $D_6/\langle r\rangle$ 的几何意义。这样的现象并不罕见。事实上，对每个商群，都可以构造出群同态，使得同态的像同构于给定的商群。

-   自然同态：给定群 $G$ 和其正规子群 $N\trianglelefteq G$，则由 $\pi(g)=gN$ 给出的映射 $\pi: G\rightarrow G/N$ 是自 $G$ 到 $G/N$ 的满同态，称为自群 $G$ 到商群 $G/N$ 的 **自然同态**（natural homomorphism）。

这一结论也说明，对于任何给定群的正规子群，都能够找到对应的群同态，使得这一同态的核就是给定的正规子群。前文同态基本定理则说明，任何同态的核都是正规子群。故而，正规子群和同态的核是一体两面。

### 群的同构定理

用于理解群的结构的有力工具，是群的同构定理。前文已经给出第一同构定理。为了内容完整，这里再给出其他常见的同构定理。

第二同构定理涉及到子群的乘积。

-   子集的乘积：给定群 $G$ 和它的子集 $A,B\subseteq G$，则子集 $A$ 和 $B$ 的 **乘积**（product）是子集 $AB=\{ab:a\in A,b\in B\}$。

子群的乘积并不总是子群。比如，群 $D_6$ 的子群 $A=\langle s\rangle$ 和子群 $B=\langle sr\rangle$ 的乘积等于 $AB=\{e,s,r,sr\}$，这并不是 $G$ 的子群，因为 $(sr)s=r^2\notin AB$。其实，这种 $a\in A$，$b\in B$，但 $ba\notin AB$ 形式的反例正是乘积不是子群的根本原因。对此，有如下定理。

-   定理：给定群 $G$ 和子群 $A,B\le G$，则它们的乘积 $AB$ 是子群，当且仅当 $AB=BA$。

第二同构定理则给出了子群乘积仍是子群的更为简单的充分条件，并且进一步确定了其结构。

-   第二同构定理（蝶形同构定理）（second isomorphism theorem, a.k.a., diamond isomorphism theorem）：给定群 $G$ 和子群 $A,B\le G$，且 $A\le N_G(B)$，则 $AB\le G$，且 $B\trianglelefteq AB$，$A\cap B\trianglelefteq A$，$AB/B\cong A/(A\cap B)$。这里，$N_G(B)$ 是 $B$ 的正规化子，且 $AB=\{ab:a\in A,b\in B\}$。特别地，$A\le N_G(B)$ 的一个充分条件是 $B\trianglelefteq G$。

第三同构定理则给出了商群的正规子群和商群与原来群的正规子群和商群之间的对应关系。

-   第三同构定理（third isomorphism theorem）：给定群 $G$ 和正规子群 $H,K\trianglelefteq G$，且 $H\le K$，则 $K/H\trianglelefteq G/H$，且 $(G/H)/(K/H)\cong G/K$。

这一结论可以推广到第四同构定理，或称对应定理（correspondence theorem），它进一步给出了群的子群格和商群的子群格之间的对应关系。

## 群作用

理解给定群结构的第三种方法，是考察群在集合上的作用。

比如说，本文考察的正三角形的空间对称群就是通过群的元素（即对称操作）在三角形上的作用来定义的。再比如说，对称群 $S_M$ 的定义可以通过它的元素在集合 $M$ 上的作用给出。这里所谓的作用，指的是每个群的元素都对应一个集合上的置换。

-   群在集合上的作用：给定群 $G$ 和集合 $X$，则称映射 $G\times X\rightarrow X$ 为群 $G$ 在集合 $X$ 上的 **群作用**（group action），记作 $g\cdot x$，若该映射对所有 $g_1,g_2\in G$ 和 $x\in X$ 都满足条件 $g_1\cdot(g_2\cdot x)=(g_1g_2)\cdot x$ 和 $e\cdot x=x$。

给定满足上述定义的群作用，自然有如下构造。这一映射，将每个群 $G$ 中的元素 $g$ 都对应到集合 $X$ 上的一个置换 $\varphi_g$，且置换 $\varphi_g$ 将元素 $x$ 映射到 $g\cdot x$。

$$
\begin{aligned}
\varphi:G\rightarrow S_X&\\
g\mapsto \varphi_g&: X\rightarrow X\\
&\quad x\mapsto g\cdot x
\end{aligned}
$$

根据定义，群中的幺元 $e$ 对应的双射 $\varphi_e$ 是 $X$ 上的恒等映射，而群中元素 $g$ 对应的映射 $\varphi_g$ 和其逆元 $g^{-1}$ 对应的映射 $\varphi_{g^{-1}}$ 互为逆映射（这也说明为什么 $\varphi_g$ 总是双射）。可以验证，$\varphi_{g_1g_2}=\varphi_{g_1}\varphi_{g_2}$，即 $\varphi$ 是群 $G$ 到群 $S_X$ 的群同态。

这一群同态 $\varphi$ 称为该群作用的 **置换表示**（permutation representation）。该群同态的核也称为该群作用的核。如果这一群同态的核是单的，则称该群作用是 **忠实的**（faithful），即该作用的置换表示忠实地反映了群结构的信息。

下文中，为表述方便，将省略群作用中的 $\cdot$ 记号。

### 轨道

群作用是二元映射。固定群中的元素 $g$，则可以得到集合上的置换 $\varphi_g$。而如果固定集合上的元素 $x$，则可以得到群对该元素作用的所有可能的结果。

-   轨道：给定群 $G$ 在集合 $X$ 上的作用和 $x\in X$，则称 $x$ 在群 $G$ 作用下的 **轨道**（orbit）是子集 $Gx=\{gx:g\in G\}$。

比如说，如果考虑群 $\langle s\rangle\le D_6$ 在正三角形顶点集合上的作用，则顶点 $1$ 的轨道是 $\{1\}$，而顶点 $2$ 和 $3$ 的轨道是 $\{2,3\}$。但是，群 $\langle r\rangle\le D_6$ 在顶点集合上的作用只有一个轨道，即全体顶点集。

容易证明，群 $G$ 的作用下，集合 $X$ 的全体轨道构成了该集合的一个分划，记作 $X/G$。但是和陪集不同，这些轨道并不一定是等长的。

### 稳定化子

群作用下，一个集合中的元素的轨道长度取决于有多少群里的元素对应的置换以它为不动点。比如说，之所以在群 $\langle s\rangle\le D_6$ 的作用下，顶点 $1$ 的轨道长是一，是因为所有群里的元素都将顶点 $1$ 映到其自身；而顶点 $2$ 的轨道长是二，是因为只有单位元 $e$ 将顶点 $2$ 映射到其自身。

这启发了如下的定义。

-   稳定化子：给定群 $G$ 在集合 $X$ 上的作用和 $x\in X$，则称群 $G$ 中 $x$ 的 **稳定化子**（stabilizer）是子群 $G_x=\{g\in G:gx=x\}$。

群作用的核就是集合中所有元素的稳定化子的交。

考虑群 $D_6$ 在顶点集合上的群作用，则顶点 $1$ 的稳定化子是 $\{e,s\}=\langle s\rangle$。这是 $D_6$ 的子群。因为 $D_6$ 可以划分成左陪集 $\langle s\rangle$，$r\langle s\rangle$ 和 $r^2\langle s\rangle$，容易发现，每个左陪集对顶点 $1$ 作用的结果是一样的。也就是说，轨道上的元素，都和稳定化子的左陪集一一对应。这说明如下结果。

-   定理：给定群 $G$ 在集合 $X$ 上的作用，则元素 $x\in X$ 的稳定化子 $G_x$ 是 $X$ 的子群，且子群 $G_x$ 的左陪集与轨道 $Gx$ 存在双射。

利用 Lagrange 定理，可以将轨道长和稳定化子的陪集数目联系起来。

-   推论：给定群 $G$ 在集合 $X$ 上的作用和 $x\in X$，若 $G$ 有限，则 $|Gx|=[G:G_x]=|G|/|G_x|$。

可以在上面的例子中验证这一结论。

### Burnside 引理

这一引理给出了群作用的轨道个数公式。

-   Burnside 引理：给定群 $G$ 在集合 $X$ 上的作用，则轨道的个数等于群中每个元素对应置换的不动点的平均个数，即
    $$
    |X/G| = \frac{1}{|G|}\sum_{g\in G}|X^g|.
    $$
    这里，$X^g=\{x\in X:gx=x\}$ 是元素 $g\in G$ 对应置换的不动点集合。

这一定理的证明十分简明。注意到，轨道个数可以写作

$$
|X/G|=\sum_{o\in X/G}1=\sum_{x\in X}\frac{1}{|Gx|}=\frac1{|G|}\sum_{x\in X}|G_x|.
$$

最后一个等号就是上面的推论；而右式和所要求证的只差一个 Fubini 定理，因为它们中的求和式都是对集合 $\{(g,x)\in G\times X:gx=x\}$ 的计数，只不过右式先对 $g$ 求和，而所求证的式子先对 $x$ 求和。

这一定理在组合数学中有很多用处，可以用于统计本质不同的对象的数目。更多例子和讨论可以参考 [Polya 计数](../combinatorics/polya.md)。

### Cayley 定理

利用群作用研究群的结构，还需要选取合适的集合。事实上，群自身就是这样一个集合。因此，接下来考虑群对自身的两种常见的群作用，并借此分析群的结构。

第一个这样的群作用是群对自身的 **左乘作用**（left multiplication）。它的置换表示如下。

$$
\begin{aligned}
\varphi:G\rightarrow S_G&\\
g\mapsto \varphi_g&: G\rightarrow G\\
&\quad x\mapsto gx
\end{aligned}
$$

群的左乘作用必然是忠实的，因为群满足消去律。所以，由同态基本定理，$G$ 可以嵌入对称群 $S_G$ 中。这意味着，每个群都同构于某个 **置换群**（permutation group）。置换群的定义正是对称群的子群。

-   Cayley 定理：群 $G$ 同构于对称群 $S_G$ 的子群。

这个群作用只有一个轨道，而且，每个元素的稳定化子都是 $\{e\}$。

### 共轭作用

第二个群到自身的作用叫做 **共轭作用**（conjugation）。它的置换表示如下。

$$
\begin{aligned}
\varphi:G\rightarrow S_G&\\
g\mapsto \varphi_g&: G\rightarrow G\\
&\quad x\mapsto gxg^{-1}
\end{aligned}
$$

在群的共轭作用下，轨道和稳定化子都有特别的名字。

-   共轭类：给定群 $G$ 和 $g\in G$，则 $g$ 在群 $G$ 中的 **共轭类**（conjugacy class）是共轭作用下 $g$ 的轨道。如果元素 $g$ 和 $h$ 处在同一共轭类中，则称 $g$ 和 $h$  **共轭**（conjugate）。
-   中心化子：给定群 $G$ 和 $a\in G$，则 $a$ 在群 $G$ 中的 **中心化子**（centralizer）是 $C_G(a)=\{g\in G:ga=ag\}$。
-   中心：给定群 $G$，则群 $a$ 的 **中心**（center）为 $Z(G)=\cap_{a\in G}C_G(a)=\{g\in G:\forall a\in G(ga=ag)\}$。

群的中心，是与群中所有元素都交换的元素的集合；因为它是群作用的核，它必然是正规子群。群的中心的大小，表明了它和交换群之间的差距。给定元素的中心化子，是与该元素交换的所有元素的集合；也是所有中心包括它的子群中最大的，这也就是它的名字来源；同时，因为它是共轭作用下某元素的稳定化子，所以它是子群。共轭类一般不是子群。

回到群 $D_6$，它的中心是 $\{e\}\neq G$，这说明它不是交换群。元素 $r$ 的中心化子 $C_G(r)$ 是 $\langle r\rangle$，元素 $s$ 的中心化子 $C_G(s)$ 为 $\langle s\rangle$。一般地，对所有 $g\in G$，总成立 $\langle g\rangle\le C_G(g)$。群 $D_6$ 的共轭类共三个，即 $\{e\},\{r,r^2\},\{s,sr,sr^2\}$。容易发现，共轭的元素都是同阶的。

群在共轭作用下划分成若干个共轭类。所以，可以写出 **类方程**（class equation）。

-   类方程：给定群 $G$，设 $\{\mathcal K_i\}_{i=1}^r$ 为全体长度大于一的共轭类，且 $g_i$ 是 $\mathcal K_i$ 的代表元，则成立

    $$
    |G|=|Z(G)|+\sum_{i=1}^r[G:C_G(g_i)].
    $$

它可以用于分析群的结构。

### 正规化子和中心化子

事实上，群的幂集也可以是群作用的对象。这里着重讨论群在它的全体子集 $X=\mathcal P(G)$ 上的共轭作用。它的置换表示如下。

$$
\begin{aligned}
\varphi:G\rightarrow S_X&\\
g\mapsto \varphi_g&: X\rightarrow X\\
&\quad S\mapsto gSg^{-1} = \{gsg^{-1}:s\in S\}
\end{aligned}
$$

在这一共轭作用下，同样可以定义群的子集的共轭类。它的核依然是群的中心。它的稳定化子则称为正规化子。

-   正规化子：给定群 $G$ 和它的子集 $S\subseteq G$，则 $S$ 在群 $G$ 中的 **正规化子**（normalizer）是 $N_G(S)=\{g\in G:gSg^{-1}=S\}$。

正规化子是共轭作用下 $S$ 的稳定化子，必然是 $G$ 的子群；$S$ 的正规化子是能够使得 $S$ 包含在其正规子群中的子群中最大的，这也是正规化子的名字来源。特别地，对于单元素集合 $\{a\}$，$N_G(\{a\})=C_G(a)$。

中心化子也可以类似地推广到子集的情形。

-   中心化子：给定群 $G$ 和它的子集 $S\subseteq G$，则 $S$ 在群 $G$ 中的 **中心化子**（centralizer）是 $C_G(S)=\{g\in G:\forall s\in S(gsg^{-1}=s)\}$。

中心化子实际上是群 $N_G(S)$ 在 $S$ 的共轭作用的核。所以，必然有 $C_G(S)\trianglelefteq N_G(S)\le G$，所以由子群的传递性，中心化子也是子群。特别地，群的中心 $Z(G)=C_G(G)\trianglelefteq N_G(G)=G$ 必然是正规子群。

### Sylow 定理

进一步地，对有限群的共轭作用进行分析，可以得到 Sylow 定理。它是处理有限群的结构的有力工具，可以迅速地得到大量小阶群的结构。

-   $p$‑群：给定群 $G$，则称它为 **$p$‑群**（$p$-group），如果 $|G|=p^\alpha$，这里，$\alpha$ 是正整数。
-   $p$‑子群：给定群 $G$ 和它的子群 $P\le G$，则称 $P$ 为 **$p$‑子群**（$p$-subgroup），如果 $P$ 本身是一个 $p$‑群。
-   Sylow $p$‑子群：给定群 $G$ 和它的子群 $P\le G$，则称 $P$ 为 **Sylow $p$‑子群**（Sylow $p$-subgroup），如果 $|G|=p^\alpha m$ 且 $p$ 不能整除 $m$，且 $|P|=p^\alpha$。

也就是说，Sylow $p$‑子群是极大的 $p$‑子群。Sylow 定理断言了 Sylow $p$- 子群的存在性，这提供了 Lagrange 定理的一定程度的逆命题。

-   Sylow 定理：给定有限群 $G$，且 $|G|=p^\alpha m$，这里，$p$ 是质数且 $p$ 不能整除 $m$，那么有如下结论：
    1.  存在 Sylow $p$‑子群；
    2.  给定 Sylow $p$‑子群 $P$ 和 $G$ 的 $p$‑子群 $Q$，那么存在 $g\in G$ 使得 $Q\le gPg^{-1}$ 成立，特别地，所有 Sylow $p$‑子群都共轭；
    3.  群 $G$ 中的 Sylow $p$‑子群的数目 $n_p$ 满足 $n_p\equiv 1\pmod p$，且 $n_p=[G:N_G(P)]$，这里 $P$ 是任意的 Sylow $p$‑子群，所以同时成立 $n_p\mid m$。

作为应用，下面证明前文的断言：同构意义下，六阶群只有 $\mathbf Z_6$ 和 $S_3$。

??? note "证明"
    设 $G$ 的阶是 $6$。那么，根据 Sylow 定理，它有 Sylow $2$‑子群，且它的数目满足 $n_2\equiv 1\pmod 2$ 和 $n_2\mid 3$，所以，只有两个情形：$n_2=1$ 或 $n_2=3$。同理，可以证明群 $G$ 有且只有一个 Sylow $3$‑子群，即 $n_3=1$。

    对于 $n_2=1$ 的情形，可以发现群 $G$ 中有一个 Sylow $2$‑子群，故而有一个 $2$ 阶元；又有一个 Sylow $3$‑子群，故而有两个 $3$ 阶元。群 $G$ 还有一个单位元，而剩下的元素，根据 Lagrange 定理，它的阶数必须整除 $6$。又不能是新的 $2$ 阶或 $3$ 阶元，否则会出现与前文不同的新的 Sylow $p$‑子群；所以，剩下的元素只能是 $6$ 阶元。存在和群的阶数相同的元素，这意味着群 $G$ 是循环群，所以 $G\cong\mathbf Z_6$。

    对于 $n_2=3$ 的情形，群 $G$ 有三个共轭的 Sylow $3$‑子群。考虑群 $G$ 在这三个 Sylow $3$‑子群上的共轭作用。对于任何一个 Sylow $3$‑子群 $P$，根据 Sylow 定理，有 $|N_G(P)|=2$；但又有 $P\le N_G(P)$，所以 $P=N_G(P)$。因此，这三个 Sylow $3$‑子群的正规化子的交集，即这个共轭作用的核，是平凡的。所以，这个作用是忠实的，它将 $G$ 嵌入到了这三个 Sylow $3$‑子群上的置换群 $S_3$。但是，因为 $|G|=|S_3|$，必然有 $G\cong S_6$。

## 有限生成 Abel 群

在掌握分析群结构的基本工具后，现在重点讨论一类群的结构。

在概述中提到，Abel 群因为元素可以交换，结构相较于其它群更为简单。其中尤为简单的是那些可以通过有限多个元素生成的 Abel 群。

-   有限生成：给定群 $G$，则称它是 **有限生成的**（finitely generated），如果它的一个生成子集是有限的。

本节的分类定理说明，有限生成的 Abel 群可以看作是有限多个的循环群的简单组合。算法竞赛中涉及的群多为有限群。有限 Abel 群必然是有限生成的，因此总是适用这一结论。

### 直积

前文对群的分析主要集中在如何将群分解为更小的群；相反地，自然可以讨论如何将两个群组合成更大的群。在所有可能的组合方式中，群的直积是最为简单的一种。

群的直积的基本想法是，给定两个群 $G$ 和 $H$，考虑其笛卡尔积 $G\times H$，二元对 $(g,h)$ 的运算定义为对两分量分别运算，分量之间互不影响。这样得到的结果显然是更大的群，且原来的两个群可以平凡地嵌入新的群中。

-   直积：给定群 $(G,\cdot_G)$ 和群 $(H,\cdot_H)$，则称群 $G$ 和群 $H$ 的 **直积**（direct product）是群 $(G\times H,\cdot)$，其中，二元运算 $\cdot:(G\times H)\times(G\times H)\rightarrow G\times H$ 定义为 $(g_1,h_1)\cdot(g_2,h_2)=(g_1\cdot_G g_2,h_1\cdot_H h_2)$。群 $G$ 和群 $H$ 的直积记为 $G\times H$。

对于直积 $G\times H$，平凡地有嵌入映射 $g\mapsto(g,e_H)$ 和 $h\mapsto(e_G,h)$。反过来，映射 $(g,h)\mapsto g$ 和映射 $(g,h)\mapsto h$ 是群同态，同态的核分别是 $\{e_G\}\times H$ 和 $G\times\{e_H\}$。这两个核恰好是上述嵌入映射的像，且它们的交集是平凡的，即 $\{(e_G,e_H)\}$。所以，群的直积 $G\times H$ 中有两个子群，都是正规子群，交集是平凡的，且它们的乘积就是直积 $G\times H$ 本身。

这样的分析其实给出了一个群能够写成它的两个子群的直积的充分必要条件。

-   定理：给定群 $G$ 和它的子群 $H_1,H_2\le G$，则 $G\cong H_1\times H_2$ 当且仅当 $H_1,H_2\trianglelefteq G$，$H_1\cap H_2=\{e\}$ 且 $G=H_1H_2$。

在直积中，两个直积因子的元素必然是可以交换的，这是因为 $hg=(e_G,h)(g,e_H)=(g,h)=gh$。所以，如果两个直积因子都是 Abel 群，那么直积也必然是 Abel 群。

并不是所有的群都可以写成两个非平凡子群的直积。例如，群 $D_6=\langle r,s\rangle$ 就不同构于 $\langle r\rangle\times\langle s\rangle$，因为作为两个循环群的直积，后者必然是 Abel 群。下面的分类定理则说明，有限生成的 Abel 群都可以写作有限多个循环群的直积。

### 分类定理

对于有限生成的 Abel 群，有如下分类定理。

-   **有限生成 Abel 群基本定理**（fundamental theorem of finitely generated Abelian groups）：给定有限生成的 Abel 群 $G$，则存在整数 $r\ge0$ 和 $n_1,\cdots,n_s\ge 2$，使得

    $$
    G\cong\mathbf Z^r\times\mathbf Z_{n_1}\times\cdots\times\mathbf Z_{n_s}.
    $$

    特别地，$r$ 是唯一确定的，称为群 $G$ 的 **阶**（rank），而且

    -   可以选取整数 $n_1,\cdots,n_s$ 使其满足 $n_1\ge2,\ n_1|n_2,\ \cdots,\ n_{s-1}|n_s$，此时，整数 $n_1,\cdots,n_s$ 唯一确定，因子 $\mathbf Z_{n_i}$ 称为群 $G$ 的 **不变因子**（invariant factor）；
    -   也可以选取整数 $n_1,\cdots,n_s$ 使其都是素数幂的形式，此时，这些素数幂也都唯一确定，因子 $\mathbf Z_{n_i}$ 称为群 $G$ 的 **初等因子**（elementary divisor）。

定理首先断言，有限生成的 Abel 群一定是有限多个循环群的直积。当然，循环群可能是无限阶的或是有限阶的，它们分别是上述分解的 $\mathbf Z$ 部分和 $\mathbf Z_{n_i}$ 部分。然后，定理给出了有限阶循环群 $\mathbf Z_n$ 的结构。定理的初等因子分解的部分其实依赖于如下观察。

-   引理：如果 $m$ 与 $n$ 互质，那么 $\mathbf Z_{mn}\cong \mathbf Z_m\times\mathbf  Z_n$。

要得到这个引理，只要注意到如果设 $x$ 和 $y$ 分别是 $\mathbf Z_m$ 和 $\mathbf Z_n$ 的生成元，那么因为 $(m,n)=1$，可以证明 $xy$ 的阶就是 $mn$，所以，它就是 $\mathbf Z_m\times \mathbf Z_n$ 的生成元。但是群 $\mathbf Z_m\times \mathbf Z_n$ 的阶正是 $mn$；因此，$\mathbf Z_m\times \mathbf Z_n=\langle xy\rangle$，这必然同构于 $\mathbf Z_{mn}$。

给定循环群 $\mathbf Z_{n}$，如果根据算术基本定理有 $n=p_1^{r_1}\cdots p_k^{r_k}$，那么重复利用引理，就可以证明 $\mathbf Z_n$ 可以写成 $\mathbf Z_{p_1^{r_1}},\cdots,\mathbf Z_{p_k^{r_k}}$ 这些素数幂阶循环群的直积。在这两步分解之后，实际上就已经得到了定理中的初等因子分解。再根据引理，重组这些素数幂阶循环群，就可以得到定理中的不变因子分解。

最后，作为分类定理的应用，可以证明所有的 24 阶 Abel 群共三种，列举如下。

|                      不变因子分解                     |                              初等因子分解                              |
| :---------------------------------------------: | :--------------------------------------------------------------: |
|                 $\mathbf Z_{24}$                |                $\mathbf Z_{3}\times\mathbf Z_{8}$                |
|       $\mathbf Z_{2}\times\mathbf Z_{12}$       |         $\mathbf Z_2\times\mathbf Z_{3}\times\mathbf Z_4$        |
| $\mathbf Z_2\times\mathbf Z_2\times\mathbf Z_6$ | $\mathbf Z_2\times\mathbf Z_2\times\mathbf Z_2\times\mathbf Z_3$ |

## 参考资料与注释

-   Dummitt, D.S. and Foote, R.M. (2004) Abstract Algebra. 3rd Edition, John Wiley & Sons, Inc.
-   [Group (mathematics) - Wikipedia](https://en.wikipedia.org/wiki/Group_%28mathematics%29)
-   [Group theory - Wikipedia](https://en.wikipedia.org/wiki/Group_theory)
-   [Group - Wolfram MathWorld](https://mathworld.wolfram.com/Group.html)
-   [Visual Group Theory](https://www.youtube.com/playlist?list=PLwV-9DG53NDxU337smpTwm6sef4x-SCLv)

[^klein]: 这个群可以表示为置换群 $\{(1),(12)(34),(13)(24),(14)(23)\}$，也可以写作 $\mathbf Z_2\times\mathbf Z_2$。
