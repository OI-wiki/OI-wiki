线性基是向量空间的一组基，通常可以解决有关异或的一些题目。

通俗一点的讲法就是由一个集合构造出来的另一个集合。

## 性质

它有以下几个性质：

- 线性基的元素能相互异或得到原集合的元素的所有相互异或得到的值。

- 线性基是满足性质 1 的最小的集合。

- 线性基没有异或和为 0 的子集。

- 线性基中每个元素的异或方案唯一，也就是说，线性基中不同的异或组合异或出的数都是不一样的。

- 线性基中每个元素的二进制最高位互不相同。

## 构造方法

### 贪心法

对原集合的每个数 p 转为二进制，从高位向低位扫，对于第 $x$ 位是 1 的，如果 $a_x$ 不存在，那么令 $a_x=p$ 并结束扫描，如果存在，令 $p=p~\text{xor}~a_x$。

代码：

```cpp
inline void insert(long long x) {
  for (int i = 55; i + 1; i--) {
    if (!(x >> i))  // x的第i位是0
      continue;
    if (!p[i]) {
      p[i] = x;
      break;
    }
    x ^= p[i];
  }
}
```

查询原集合内任意几个元素 xor 的最大值，就可以用线性基解决。

将线性基从高位向低位扫，若 xor 上当前扫到的 $a_x$ 答案变大，就把答案异或上 $a_x$。

为什么能行呢？因为从高往低位扫，若当前扫到第 $i$ 位，意味着可以保证答案的第 $i$ 位为 1，且后面没有机会改变第 $i$ 位。

查询原集合内任意几个元素 xor 的最小值，就是线性基集合所有元素中最小的那个。

查询某个数是否能被异或出来，类似于插入，如果最后插入的数 $p$ 被异或成了 0，则能被异或出来。

### 高斯消元法

高斯消元法是从线性基本身含义的角度去构造线性基，可以求 $0/1$ 向量（二进制数）的线性基，也可以求非 $0/1$ 向量的线性基。

如果只需要求 $0/1$ 的线性基，使用 [异或高斯消元](https://oiwiki.org/math/gauss/#_17) 即可。

#### 代码

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ull;
const int MAXn = 1e5;

inline ull deg(ull num, int deg) { return num & (1ull << deg); }

int n;
ull a[MAXn + 10];

int main() {
  scanf("%d", &n);
  for (int i = 1; i <= n; ++i) scanf("%llu", &a[i]);
  int row = 1;
  for (int col = 63; ~col && row <= n; --col) {
    for (int i = row; i <= n; ++i) {
      if (deg(a[i], col)) {
        swap(a[row], a[i]);
        break;
      }
    }
    if (!deg(a[row], col)) continue;
    for (int i = 1; i <= n; ++i) {
      if (i == row) continue;
      if (deg(a[i], col)) {
        a[i] ^= a[row];
      }
    }
    ++row;
  }
  ull ans = 0;
  for (int i = 1; i < row; ++i) {
    ans ^= a[i];
  }
  printf("%llu\n", ans);
  return 0;
}
```

#### 性质

高斯消元法构造出的线性基还额外满足一条性质：

- 高斯消元后的矩阵是一个阶梯矩阵。

如果对这条性质的正确性不理解，可以跳转 [高斯消元](https://oiwiki.org/math/gauss)。

提供一组样例：

    10
    681519689123291 153992348230057 352917520953222 379410980430607 333284887124912 596782649548897 1004880543767517 258503666829624 353486948696275 244563245470691

二进制表示：

    10011010111101011010101010111110100100010111011011
    00100011000000111000100011001101101110000110101001
    01010000001111101000000011011110001010111110000110
    01010110010001001010000000101101100110001100001111
    01001011110001111011101111010011100101101110110000
    10000111101100010101001001110101011010000001100001
    11100100011110111011111011110110100101101111011101
    00111010110001101110010011001111000000100100111000
    01010000010111111010011000000000101000000011010011
    00110111100110110111010001010111110001001111100011

高斯消元法生成的线性基：

    10000001000011001001000110110011001011000111101101
    01000000000011101000011101111011101100011100010000
    00100001000101101011000000110100000110101011111001
    00010000000110010110100001010011001111111101100001
    00001001000110111110011101100100011100101011110101
    00000100000011100011111011010100100110100010001100
    00000010000101010011100011111001101000101101010000
    00000000100011111010101000011101110110010110100111
    00000000010010000100100100101000001011100010100010
    00000000001010010110111111110110101001011111110111

贪心法生成的线性基：

    10011010111101011010101010111110100100010111011011
    01010000001111101000000011011110001010111110000110
    00100011000000111000100011001101101110000110101001
    00011011111110010011101100001101101111010000110110
    00001101101100110001110001011011100101000000101001
    00000110011110100010000011110011101100110010001001
    00000010001111000101011100001111000001110010100111
    00000000110001111110001100110101111101110100000101
    00000000011000010010011011011110100010111101010101
    00000000001010010110111111110110101001011111110111

这是一条非常好的性质，能帮我们更方便的解决很多问题。比如：给定一些数，选其中一些异或起来，求异或最大值，如果用贪心法构造线性基，需要再做一遍贪心，如果 $ans$ 的当前位是 0，那么异或一定会更优，否则当前位如果为 1，则一定会更不优；而使用高斯消元法构造线性基后直接将线性基中所有元素都异或起来输出即可。

对于其他比较经典的问题，比如查询一个数能否被异或得到，查询能被异或得到的第 k 大数……高斯消元法得到的线性基也能更加方便地解决问题。

#### 运行效率

设输入的二进制数中最大的为 $m$，复杂度为 $O(n\log^2m)$，因为将参与运算的数的二进制数位算进了复杂度内，所以常数非常小。但是运行效率相比贪心法还是略差一些。

## 线性基练习题

[Luogu P3812【模板】线性基](https://www.luogu.com.cn/problem/P3812)&[Acwing 3164. 线性基](https://www.acwing.com/problem/content/description/3167)

[SGU 275 to xor or not xor](https://vjudge.net/problem/SGU-275)

[HDU 3949 XOR](https://vjudge.net/problem/HDU-3949)

[Luogu P4151\[WC2011\]最大 XOR 和路径](https://www.luogu.com.cn/problem/P4151)
