## Basic Concepts

### 多项式和幂级数

对于求和式 $\sum a_nx^n$，如果是有限项相加，称为多项式，记作 $f(x)=\sum_{n=0}^m a_nx^n$。

可列项相加的求和式称为级数。在和式 $\sum_{n=0}^\infty a_nx^n$ 中，每项均为非负整数次幂函数乘常数系数，这种形式的级数称为幂级数。

研究多项式算术时先考虑较简单的多项式，幂级数概念仅用于方便理解。到了数学分析中会进一步研究幂级数的敛散性。

### 多项式的度

对于一个多项式 $f(x)$，称其最高次项的次数为该多项式的 **度（Degree）**，也称次数，记作 $\operatorname{deg}{f}$。

### 多项式的乘法

最核心的操作是两个多项式的乘法，即给定多项式 $f(x)$ 和 $g(x)$：

$$
f(x)=a_0+a_1x+\dots+a_nx^n\quad \quad (1)\\ 
g(x)=b_0+b_1x+\dots+b_mx^m\quad \quad (2)
$$

要计算多项式 $Q(x)=f(x)\cdot g(x)$：

$$
\boxed {Q(x) = \sum \limits_ {i = 0} ^ n \sum \limits_ {j = 0 } ^ m a_i b_j x ^ {i + j}} = c_0 + c_1 x + \dots + c_ {n + m} x ^ {n + m}
$$

上述过程可以通过快速傅里叶变换在 $O(n\log n)$ 下计算。

### 代数基本定理

任何复系数一元 $n$ 次多项式方程在复数域上至少有一根。由此推出，$n$ 次复系数多项式方程在复数域内，有且只有 $n$ 个根（重根按重数计算）。

有时这个定理表述为：任何一个非零的一元 $n$ 次复系数多项式，都正好有 $n$ 个复数根。

因此，每一个多项式都可以表示为：

$$
f(x)=a_n(x-x_1)(x-x_2)\ldots(x-x_n)
$$

其中 $x_1$ 到 $x_n$ 为多项式 $f(x)$ 的全体根（零点）。如果其中有重复的根，称重复的个数为这个根的重数。

### 多项式整除

对于多项式 $f(x)$ 和多项式 $g(x)$，如果存在一个多项式 $h(x)$，使得：

$$
f(x)=g(x)h(x)
$$

则多项式 $g(x)$ 整除多项式 $f(x)$。

显而易见，多项式 $g(x)$ 整除多项式 $f(x)$，当且仅当 $g(x)$ 的根全部为 $f(x)$ 的根，并且在 $g(x)$ 中的重数不超过在 $f(x)$ 中的相应重数。

### 多项式的余数和商

对于多项式 $f(x), g(x)$，存在 **唯一** 的 $Q(x), R(x)$ 满足：

$$
\begin{aligned}
    f(x) &= Q(x) g(x) + R(x) \\
    \operatorname{deg}{R} &< \operatorname{deg}{g}
\end{aligned}
$$

当 $\operatorname{deg}{f} \ge \operatorname{deg}{g}$ 时有 $\operatorname{deg}{Q} = \operatorname{deg}{f} - \operatorname{deg}{g}$，否则有 $Q(x) = 0$。
我们称 $Q(x)$ 为 $g(x)$ 除 $f(x)$ 的 **商（Quotient）**，$R(x)$ 为 $g(x)$ 除 $f(x)$ 的 **余数（Remainder）**。亦可记作

$$
f(x) \equiv R(x) \pmod{g(x)}
$$

这里的 $g(x)$ 是模多项式，这个式子表明多项式 $f(x)$ 和 $R(x)$ 在模多项式 $g(x)$ 的意义下同余。

这个同余式意味着，对于多项式 $g(x)$ 的任意一个根 $x_0$，代入 $f(x)$ 和 $R(x)$ 中，得到的点值相同。即：

$$
f(x_0)=R(x_0)
$$

并且，如果根 $x_0$ 在多项式 $g(x)$ 中的重数是 $k$，即 $(x-x_0)^k$ 整除 $g(x)$，则对任意大于等于 $0$ 小于 $k$ 的整数 $t$，有：

$$
f^{t}(x_0)=R^{t}(x_0)
$$

这里的记号表示 $t$ 阶导数。

模多项式同余可以应用于幂级数。一个无限项的幂级数，可以在模具体的多项式情形下，和一个有限项的多项式同余。例如：

$$
1+x+x^2+x^3+\ldots \equiv 1+x+\ldots+x^{n-1} \pmod{x^n}
$$

显然剩余的所有项都被 $x^n$ 整除，因此模 $x^n$ 的操作等价于“截断”，将无穷项的幂级数截断到前 $n$ 项，直接将更高位的信息丢失。

在一些特定的情况下，也可以模其他的多项式，下文将解释相应情况。

### 多项式的多点求值和插值

**多项式的多点求值（Multi-point evaluation）** 即给出一个多项式 $f(x)$ 和 $n$ 个点 $x_{1}, x_{2}, \dots, x_{n}$，求

$$
f(x_{1}), f(x_{2}), \dots, f(x_{n})
$$

**多项式的插值（Interpolation）** 即给出 $n+1$ 个点

$$
(x_{0}, y_{0}), (x_{1}, y_{1}), \dots, (x_{n}, y_{n})
$$

求一个 $n$ 次多项式 $f(x)$ 使得这 $n+1$ 个点都在 $f(x)$ 上。

这两种操作的实质就是将多项式在 **系数表示** 和 **点值表示** 间转化。多点求值将多项式的系数表示转为点值表示，插值将多项式的点值表示转为系数表示。

???+note "注"
    按照幂级数的观点看，多点求值相当于将无穷项的信息“压缩”到有限个点值表示，因此丢失了一些信息，而插值相当于还原到相应次数的系数表示。
    
    编程常见的求值与插值，例如离散傅里叶变换（及其逆变换）等等，选择的 $n+1$ 个点重数均为 $1$，即两两不同，免去求导的麻烦。
    
    这种“压缩”只保证了在 $n+1$ 个点上的一致。根据上文对模多项式同余的解释，如果幂级数 $f(x)$ 经过在 $x_0$ 到 $x_n$ 点处求值再插值，得到多项式 $R(x)$，则作多项式：
    
    $$
    g(x)=(x-x_0)\ldots(x-x_n)
    $$
    
    就有：
    
    $$
    f(x) \equiv R(x) \pmod{g(x)}
    $$
    
    由于 $R(x)$ 的次数严格小于 $g(x)$，所以利用求值与插值求出的 $R(x)$ 就是余式。因此在这种情况下，如果幂级数在根处可以求值，就可以模多项式。一个反例例如：
    
    $$
    \frac{1}{1-x}=1+x+x^2+x^3+\ldots
    $$
    
    在 $x=1$ 处不可求值，因此级数 $1+x+x^2+x^3+\ldots$ 不能模多项式 $x-1$。
    
    由于幂级数的任意阶导数，在 $0$ 处的值总是存在，因此模 $x^n$ 始终可以计算，与上文“截断”的意义一致。离散傅里叶变换（及其逆变换）相当于模多项式 $x^n-1$。

### 幂级数的倒数

对于幂级数 $f(x)$，若存在幂级数 $g(x)$ 满足：

$$
f(x)g(x)=1
$$

则两个幂级数互为倒数。幂级数存在倒数，当且仅当常数项不为 $0$，并且倒数也满足常数项不为 $0$。只要常数项不为 $0$，就可以借助：

$$
\frac{1}{a_0(1-t)}=\frac{1}{a_0}(1+t+t^2+t^3+\ldots)
$$

通过待定系数求得幂级数的倒数。

???+note "注"
    容易发现，$f(x)$ 的倒数就是 $\frac{1}{f(x)}$ 的无穷项麦克劳林展开（在 $x=0$ 处的无穷项泰勒展开）。

### 模多项式的逆元

在模多项式 $h(x)$ 意义下，幂级数 $f(x)$ 有时存在逆元。逆元就是幂级数 $f(x)$ 的倒数模多项式 $h(x)$ 得到的余式。

这个定义也等价于，对于多项式 $f(x)$，若存在 $g(x)$ 满足：

$$
\begin{aligned}
	f(x) g(x) & \equiv 1 \pmod{h(x)}
\end{aligned}
$$

则称 $g(x)$ 为 $f(x)$ 在模 $h(x)$ 意义下的 **逆元（Inverse Element）**。

模多项式 $h(x)$ 意义下逆元总是唯一的。如果多项式 $f(x)$ 的次数也小于 $h(x)$，则得到的 $g(x)$ 与 $f(x)$ 互为逆元。

考虑“截断”的概念，一般把模 $x^n$ 意义下的逆元记作 $f^{-1}(x)$，也是后文默认使用的逆元概念。如果不加说明，逆元的模就是指 $x^n$。

???+note "注"
    一个问题是，可不可以用各种插值变换，直接求解“逆元”，比如计算：
    
    $$
    IDFT\left(\frac{DFT(1)}{DFT(f(x))}\right)
    $$
    
    答案是否定的，不可以这样做。根据上文的解释，这里利用离散傅里叶变换（及其逆变换）直接求出的逆元是模多项式 $x^n-1$ 的逆元，不是通常的模多项式 $x^n$ 的逆元。并且，由于原多项式在各点值处可能为 $0$，这个求解未必可以进行。

### <span id="ln-exp">多项式的对数函数与指数函数</span>

对于一个多项式 $f(x)$，可以将其对数函数看作其与麦克劳林级数的复合：

$$
\ln{(1 - f(x))} = -\sum_{i = 1}^{+\infty} \frac{f^{i}(x)}{i}\\
\ln{(1 + f(x))} = \sum_{i = 1}^{+\infty} \frac{(-1)^{i - 1}f^{i}(x)}{i}
$$

其指数函数同样可以这样定义：

$$
\exp{f(x)} = e^{f(x)} = \sum_{i = 0}^{+\infty} \frac{f^{i}(x)}{i!}
$$

我们一般也只求它们模 $x^n$ 得到的结果，即截断到某一位得到的有限长结果。

## References

- [**Picks's Blog**](https://picks.logdown.com)
- [**Miskcoo's Space**](https://blog.miskcoo.com)
